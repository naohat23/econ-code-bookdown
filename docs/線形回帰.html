<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 線形回帰 | エコノミストのためのR</title>
  <meta name="description" content="6 線形回帰 | エコノミストのためのR" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="6 線形回帰 | エコノミストのためのR" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="naohat23/econ-code-bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 線形回帰 | エコノミストのためのR" />
  
  
  

<meta name="author" content="服部直樹" />


<meta name="date" content="2023-04-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="探索的データ分析.html"/>
<link rel="next" href="時系列データ操作.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://naohat23.github.io/econ-code-bookdown">エコノミストのためのR</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>はじめに</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#なぜrを使うのか"><i class="fa fa-check"></i>なぜRを使うのか？</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#本書で出来ること"><i class="fa fa-check"></i>本書で出来ること　</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#本書で出来ないこと"><i class="fa fa-check"></i>本書で出来ないこと</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#目次"><i class="fa fa-check"></i>目次</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#参考文献ウェブサイト"><i class="fa fa-check"></i>参考文献・ウェブサイト</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#rプログラミング"><i class="fa fa-check"></i>Rプログラミング</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#統計学計量経済学"><i class="fa fa-check"></i>統計学・計量経済学</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#時系列データ分析"><i class="fa fa-check"></i>時系列データ分析</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#変更履歴"><i class="fa fa-check"></i>変更履歴</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#年4月6日-マイナーアップデート"><i class="fa fa-check"></i>2023年4月6日 マイナーアップデート</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#年3月18日-マイナーアップデート"><i class="fa fa-check"></i>2023年3月18日 マイナーアップデート</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#年2月6日-マイナーアップデート"><i class="fa fa-check"></i>2023年2月6日 マイナーアップデート</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#年10月22日-マイナーアップデート"><i class="fa fa-check"></i>2022年10月22日 マイナーアップデート</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#年9月7日-マイナーアップデート"><i class="fa fa-check"></i>2022年9月7日 マイナーアップデート</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#年7月17日-マイナーアップデート"><i class="fa fa-check"></i>2022年7月17日 マイナーアップデート</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#年7月9日-マイナーアップデート"><i class="fa fa-check"></i>2022年7月9日 マイナーアップデート</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#年6月26日-ローンチ"><i class="fa fa-check"></i>2022年6月26日 ローンチ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rの設定.html"><a href="rの設定.html"><i class="fa fa-check"></i><b>1</b> Rの設定</a>
<ul>
<li class="chapter" data-level="1.1" data-path="rの設定.html"><a href="rの設定.html#設定全般"><i class="fa fa-check"></i><b>1.1</b> 設定全般</a>
<ul>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#rのインストール"><i class="fa fa-check"></i>Rのインストール</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#rのバージョン確認"><i class="fa fa-check"></i>Rのバージョン確認</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#セッション情報の確認"><i class="fa fa-check"></i>セッション情報の確認</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#オブジェクトを全削除"><i class="fa fa-check"></i>オブジェクトを全削除</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#警告の非表示"><i class="fa fa-check"></i>警告の非表示</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#関数が出力する警告やメッセージの非表示"><i class="fa fa-check"></i>関数が出力する警告やメッセージの非表示</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="rの設定.html"><a href="rの設定.html#プロキシサーバーの設定"><i class="fa fa-check"></i><b>1.2</b> プロキシサーバーの設定</a></li>
<li class="chapter" data-level="1.3" data-path="rの設定.html"><a href="rの設定.html#パッケージ"><i class="fa fa-check"></i><b>1.3</b> パッケージ</a>
<ul>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#使用するパッケージ一覧"><i class="fa fa-check"></i>使用するパッケージ一覧</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#パッケージのインストールとインポート"><i class="fa fa-check"></i>パッケージのインストールとインポート</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="rの設定.html"><a href="rの設定.html#グラフの設定"><i class="fa fa-check"></i><b>1.4</b> グラフの設定</a>
<ul>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#グラフのテーマ設定"><i class="fa fa-check"></i>グラフのテーマ設定</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#グラフのフォント設定"><i class="fa fa-check"></i>グラフのフォント設定</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="rの設定.html"><a href="rの設定.html#サンプルデータセット"><i class="fa fa-check"></i><b>1.5</b> サンプルデータセット</a>
<ul>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#rのサンプルデータセット"><i class="fa fa-check"></i>Rのサンプルデータセット</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#外部データセット"><i class="fa fa-check"></i>外部データセット</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="rの設定.html"><a href="rの設定.html#r起動時に実行する設定"><i class="fa fa-check"></i><b>1.6</b> R起動時に実行する設定</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html"><i class="fa fa-check"></i><b>2</b> Rの基本的な使用方法</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#第2章の準備"><i class="fa fa-check"></i><b>2.1</b> 第2章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#パッケージのインポート"><i class="fa fa-check"></i>パッケージのインポート</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#主要ショートカットキー"><i class="fa fa-check"></i><b>2.2</b> 主要ショートカットキー</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#編集"><i class="fa fa-check"></i>編集</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#実行"><i class="fa fa-check"></i>実行</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#その他"><i class="fa fa-check"></i>その他</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#基本操作"><i class="fa fa-check"></i><b>2.3</b> 基本操作</a></li>
<li class="chapter" data-level="2.4" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#演算"><i class="fa fa-check"></i><b>2.4</b> 演算</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#四則計算"><i class="fa fa-check"></i>四則計算</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#数値計算"><i class="fa fa-check"></i>数値計算</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#一致大小関係"><i class="fa fa-check"></i>一致・大小関係</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#包含集合関係"><i class="fa fa-check"></i>包含・集合関係</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ベクトル"><i class="fa fa-check"></i><b>2.5</b> ベクトル</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ベクトルの作成"><i class="fa fa-check"></i>ベクトルの作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ベクトル要素へのアクセス"><i class="fa fa-check"></i>ベクトル要素へのアクセス</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#規則性があるベクトルの作成"><i class="fa fa-check"></i>規則性があるベクトルの作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ベクトルの演算"><i class="fa fa-check"></i>ベクトルの演算</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#行列"><i class="fa fa-check"></i><b>2.6</b> 行列</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#行列の作成"><i class="fa fa-check"></i>行列の作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#行列の要素へのアクセス"><i class="fa fa-check"></i>行列の要素へのアクセス</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#行列の演算"><i class="fa fa-check"></i>行列の演算</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データフレーム"><i class="fa fa-check"></i><b>2.7</b> データフレーム</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データフレームの作成"><i class="fa fa-check"></i>データフレームの作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データフレームの要素へのアクセス"><i class="fa fa-check"></i>データフレームの要素へのアクセス</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#その他のデータフレームの機能"><i class="fa fa-check"></i>その他のデータフレームの機能</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#リスト"><i class="fa fa-check"></i><b>2.8</b> リスト</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#リストの作成"><i class="fa fa-check"></i>リストの作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#リストの要素へのアクセス"><i class="fa fa-check"></i>リストの要素へのアクセス</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#リストに要素を追加"><i class="fa fa-check"></i>リストに要素を追加</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#文字列操作"><i class="fa fa-check"></i><b>2.9</b> 文字列操作</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#文字列の連結"><i class="fa fa-check"></i>文字列の連結</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#文字列の切り出し"><i class="fa fa-check"></i>文字列の切り出し</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#文字列の検出置換"><i class="fa fa-check"></i>文字列の検出・置換</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#文字列の変換"><i class="fa fa-check"></i>文字列の変換</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#文字列のパディング"><i class="fa fa-check"></i>文字列のパディング</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#文字列によるプログラム実行"><i class="fa fa-check"></i>文字列によるプログラム実行</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#制御構文"><i class="fa fa-check"></i><b>2.10</b> 制御構文</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ifelse文"><i class="fa fa-check"></i>if/else文</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#forループ"><i class="fa fa-check"></i>forループ</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#whileループ"><i class="fa fa-check"></i>whileループ</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#breakによる繰り返しの終了"><i class="fa fa-check"></i>breakによる繰り返しの終了</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#nextによる処理のスキップ"><i class="fa fa-check"></i>nextによる処理のスキップ</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#tryによるエラー処理"><i class="fa fa-check"></i>tryによるエラー処理</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ファイル操作"><i class="fa fa-check"></i><b>2.11</b> ファイル操作</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ディレクトリ関連"><i class="fa fa-check"></i>ディレクトリ関連</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ファイル関連"><i class="fa fa-check"></i>ファイル関連</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ファイルのダウンロード"><i class="fa fa-check"></i>ファイルのダウンロード</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データの読み込み"><i class="fa fa-check"></i><b>2.12</b> データの読み込み</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#csvデータ"><i class="fa fa-check"></i>CSVデータ</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#xlsxlsx形式データ"><i class="fa fa-check"></i>xls・xlsx形式データ</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#xlsx形式データ"><i class="fa fa-check"></i>xlsx形式データ</a></li>
<li class="chapter" data-level="2.12.1" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#複数データの読み込み"><i class="fa fa-check"></i><b>2.12.1</b> 複数データの読み込み</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#excelの日付値の修正"><i class="fa fa-check"></i>Excelの日付値の修正</a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データの書き出し"><i class="fa fa-check"></i><b>2.13</b> データの書き出し</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#csvデータの書き出し"><i class="fa fa-check"></i>CSVデータの書き出し</a></li>
</ul></li>
<li class="chapter" data-level="2.14" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#オブジェクトのセーブロード"><i class="fa fa-check"></i><b>2.14</b> オブジェクトのセーブ・ロード</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#セーブ"><i class="fa fa-check"></i>セーブ</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ロード"><i class="fa fa-check"></i>ロード</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html"><i class="fa fa-check"></i><b>3</b> tidyverseによるデータ操作</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#第3章の準備"><i class="fa fa-check"></i><b>3.1</b> 第3章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#パッケージのインポート-1"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#外部データセットの取得"><i class="fa fa-check"></i>外部データセットの取得</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#tidyverseとは"><i class="fa fa-check"></i><b>3.2</b> tidyverseとは</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#tidy-data縦型横型データ"><i class="fa fa-check"></i>tidy data（縦型・横型データ）</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#tidyverseの特徴"><i class="fa fa-check"></i>tidyverseの特徴</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列の選択"><i class="fa fa-check"></i><b>3.3</b> 列の選択</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名で選択"><i class="fa fa-check"></i>列名で選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名を格納したベクトルで選択"><i class="fa fa-check"></i>列名を格納したベクトルで選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列を非選択削除"><i class="fa fa-check"></i>列を非選択（削除）</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名に特定の文字列を含む列を選択"><i class="fa fa-check"></i>列名に特定の文字列を含む列を選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名が特定の文字列から始まる列を選択"><i class="fa fa-check"></i>列名が特定の文字列から始まる列を選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名が特定の文字列で終わる列を選択"><i class="fa fa-check"></i>列名が特定の文字列で終わる列を選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#特定の型の列を選択"><i class="fa fa-check"></i>特定の型の列を選択</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名の変更"><i class="fa fa-check"></i><b>3.4</b> 列名の変更</a></li>
<li class="chapter" data-level="3.5" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#行のスライスとサンプリング"><i class="fa fa-check"></i><b>3.5</b> 行のスライスとサンプリング</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#行のスライス"><i class="fa fa-check"></i>行のスライス</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#サンプリング"><i class="fa fa-check"></i>サンプリング</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#行のフィルタ"><i class="fa fa-check"></i><b>3.6</b> 行のフィルタ</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#条件に一致する行"><i class="fa fa-check"></i>条件に一致する行</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#条件に一致しない行not条件"><i class="fa fa-check"></i>条件に一致しない行（NOT条件）</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数条件"><i class="fa fa-check"></i>複数条件</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#andor条件を明示的に指定した複数条件"><i class="fa fa-check"></i>AND・OR条件を明示的に指定した複数条件</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#in演算子によるor条件"><i class="fa fa-check"></i><code>%in%</code>演算子によるOR条件</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#or条件の否定"><i class="fa fa-check"></i>OR条件の否定</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#関数による条件指定"><i class="fa fa-check"></i>関数による条件指定</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#論理値を返す関数による条件指定"><i class="fa fa-check"></i>論理値を返す関数による条件指定</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数列の一括条件指定"><i class="fa fa-check"></i>複数列の一括条件指定</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#行の並べ替え"><i class="fa fa-check"></i><b>3.7</b> 行の並べ替え</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#昇順ソート"><i class="fa fa-check"></i>昇順ソート</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#降順ソート"><i class="fa fa-check"></i>降順ソート</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#降順ソート日付型"><i class="fa fa-check"></i>降順ソート（日付型）</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数条件によるソート"><i class="fa fa-check"></i>複数条件によるソート</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列の作成修正"><i class="fa fa-check"></i><b>3.8</b> 列の作成・修正</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#新たな列の作成"><i class="fa fa-check"></i>新たな列の作成</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#既存の列の修正"><i class="fa fa-check"></i>既存の列の修正</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#条件付き系列の作成"><i class="fa fa-check"></i>条件付き系列の作成</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数列の一括処理"><i class="fa fa-check"></i>複数列の一括処理</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#グループ化"><i class="fa fa-check"></i><b>3.9</b> グループ化</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#単一の列でグループ化"><i class="fa fa-check"></i>単一の列でグループ化</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数の列でグループ化"><i class="fa fa-check"></i>複数の列でグループ化</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#グループ化フィルタ"><i class="fa fa-check"></i>グループ化＆フィルタ</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#グループ化の解除"><i class="fa fa-check"></i>グループ化の解除</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#集計"><i class="fa fa-check"></i><b>3.10</b> 集計</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#グループ別の集計"><i class="fa fa-check"></i>グループ別の集計</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#クロス集計"><i class="fa fa-check"></i>クロス集計</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数列の一括処理-1"><i class="fa fa-check"></i>複数列の一括処理</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#カウント"><i class="fa fa-check"></i><b>3.11</b> カウント</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#変数のカウント"><i class="fa fa-check"></i>1変数のカウント</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#多変数のカウント"><i class="fa fa-check"></i>多変数のカウント</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#条件付きカウント"><i class="fa fa-check"></i>条件付きカウント</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#要素の種類をカウント"><i class="fa fa-check"></i>要素の種類をカウント</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#縦型横型の変換"><i class="fa fa-check"></i><b>3.12</b> 縦型・横型の変換</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#縦型データを横型データに変換"><i class="fa fa-check"></i>縦型データを横型データに変換</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#横型データを縦型データに変換"><i class="fa fa-check"></i>横型データを縦型データに変換</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#データの結合"><i class="fa fa-check"></i><b>3.13</b> データの結合</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#内部結合"><i class="fa fa-check"></i>内部結合</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#左外部結合"><i class="fa fa-check"></i>左外部結合</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#右外部結合"><i class="fa fa-check"></i>右外部結合</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#完全外部結合"><i class="fa fa-check"></i>完全外部結合</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#重複処理"><i class="fa fa-check"></i><b>3.14</b> 重複処理</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#重複行の削除"><i class="fa fa-check"></i>重複行の削除</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#重複行の抽出"><i class="fa fa-check"></i>重複行の抽出</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#欠損値処理"><i class="fa fa-check"></i><b>3.15</b> 欠損値処理</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#naの削除"><i class="fa fa-check"></i>NAの削除</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#naの置換"><i class="fa fa-check"></i>NAの置換</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#naのフィル"><i class="fa fa-check"></i>NAのフィル</a></li>
</ul></li>
<li class="chapter" data-level="3.16" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#補完処理"><i class="fa fa-check"></i><b>3.16</b> 補完処理</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#組み合わせ候補の補完"><i class="fa fa-check"></i>組み合わせ候補の補完</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#時系列データの補完"><i class="fa fa-check"></i>時系列データの補完</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html"><i class="fa fa-check"></i><b>4</b> ggplot2によるグラフ作成</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#第4章の準備"><i class="fa fa-check"></i><b>4.1</b> 第4章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#パッケージのインポート-2"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#外部データセットの取得-1"><i class="fa fa-check"></i>外部データセットの取得</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ggplot2とは"><i class="fa fa-check"></i><b>4.2</b> ggplot2とは</a></li>
<li class="chapter" data-level="4.3" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ggplot2の設定"><i class="fa fa-check"></i><b>4.3</b> ggplot2の設定</a></li>
<li class="chapter" data-level="4.4" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#gui形式の直感的なグラフ作成"><i class="fa fa-check"></i><b>4.4</b> GUI形式の直感的なグラフ作成</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#esquisseパッケージ"><i class="fa fa-check"></i>esquisseパッケージ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ggplotguiパッケージ"><i class="fa fa-check"></i>ggplotguiパッケージ</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の度数分布離散型"><i class="fa fa-check"></i><b>4.5</b> 1次元の度数分布（離散型）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#度数棒グラフの基本形"><i class="fa fa-check"></i>度数棒グラフの基本形</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の度数分布連続型"><i class="fa fa-check"></i><b>4.6</b> 1次元の度数分布（連続型）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ヒストグラムの基本形"><i class="fa fa-check"></i>ヒストグラムの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#横並びヒストグラム"><i class="fa fa-check"></i>横並びヒストグラム</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げヒストグラム"><i class="fa fa-check"></i>積み上げヒストグラム</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の密度グラフ"><i class="fa fa-check"></i><b>4.7</b> 1次元の密度グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#密度グラフの基本形"><i class="fa fa-check"></i>密度グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#横並び密度グラフ"><i class="fa fa-check"></i>横並び密度グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ密度グラフ"><i class="fa fa-check"></i>積み上げ密度グラフ</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の度数分布離散型-1"><i class="fa fa-check"></i><b>4.8</b> 2次元の度数分布（離散型）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#度数バブルチャートの基本形"><i class="fa fa-check"></i>度数バブルチャートの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#度数ヒートマップの基本形"><i class="fa fa-check"></i>度数ヒートマップの基本形</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の度数分布連続型-1"><i class="fa fa-check"></i><b>4.9</b> 2次元の度数分布（連続型）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#度数ヒートマップの基本形-1"><i class="fa fa-check"></i>度数ヒートマップの基本形</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の密度グラフ-1"><i class="fa fa-check"></i><b>4.10</b> 2次元の密度グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元密度グラフの基本形"><i class="fa fa-check"></i>2次元密度グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元密度グラフの塗りつぶし版"><i class="fa fa-check"></i>2次元密度グラフの塗りつぶし版</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#qqプロット"><i class="fa fa-check"></i><b>4.11</b> QQプロット</a></li>
<li class="chapter" data-level="4.12" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図バブルチャート"><i class="fa fa-check"></i><b>4.12</b> 散布図・バブルチャート</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図の基本形"><i class="fa fa-check"></i>散布図の基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#バブルチャートの基本形"><i class="fa fa-check"></i>バブルチャートの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図にコネクタ線を追加"><i class="fa fa-check"></i>散布図にコネクタ線を追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図に近似曲線を追加"><i class="fa fa-check"></i>散布図に近似曲線を追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図にラベルを追加"><i class="fa fa-check"></i>散布図にラベルを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#バブルチャートにラベルを追加"><i class="fa fa-check"></i>バブルチャートにラベルを追加</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#棒グラフ"><i class="fa fa-check"></i><b>4.13</b> 棒グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#縦棒グラフの基本形"><i class="fa fa-check"></i>縦棒グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#横棒グラフ"><i class="fa fa-check"></i>横棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#縦棒グラフの順序並べ替え"><i class="fa fa-check"></i>縦棒グラフの順序並べ替え</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#縦棒グラフにラベルを追加"><i class="fa fa-check"></i>縦棒グラフにラベルを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#集合縦棒グラフ"><i class="fa fa-check"></i>集合縦棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフ"><i class="fa fa-check"></i>積み上げ縦棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフにラベルを追加"><i class="fa fa-check"></i>積み上げ縦棒グラフにラベルを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフ-1"><i class="fa fa-check"></i>100％積み上げ縦棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフにラベルを追加-1"><i class="fa fa-check"></i>100％積み上げ縦棒グラフにラベルを追加</a></li>
</ul></li>
<li class="chapter" data-level="4.14" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#円グラフ"><i class="fa fa-check"></i><b>4.14</b> 円グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#円グラフの基本形"><i class="fa fa-check"></i>円グラフの基本形</a></li>
</ul></li>
<li class="chapter" data-level="4.15" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#折れ線グラフ"><i class="fa fa-check"></i><b>4.15</b> 折れ線グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#折れ線グラフの基本形"><i class="fa fa-check"></i>折れ線グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#折れ線グラフにマーカーを追加"><i class="fa fa-check"></i>折れ線グラフにマーカーを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#折れ線グラフに系列ラベルを追加"><i class="fa fa-check"></i>折れ線グラフに系列ラベルを追加</a></li>
</ul></li>
<li class="chapter" data-level="4.16" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ステップグラフ"><i class="fa fa-check"></i><b>4.16</b> ステップグラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ステップグラフの基本形"><i class="fa fa-check"></i>ステップグラフの基本形</a></li>
</ul></li>
<li class="chapter" data-level="4.17" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#面グラフ"><i class="fa fa-check"></i><b>4.17</b> 面グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#面グラフの基本形"><i class="fa fa-check"></i>面グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ面グラフ"><i class="fa fa-check"></i>積み上げ面グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#リボングラフの基本形"><i class="fa fa-check"></i>リボングラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#リボングラフに折れ線グラフを追加"><i class="fa fa-check"></i>リボングラフに折れ線グラフを追加</a></li>
</ul></li>
<li class="chapter" data-level="4.18" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#箱ひげ図ヴァイオリングラフ"><i class="fa fa-check"></i><b>4.18</b> 箱ひげ図・ヴァイオリングラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#箱ひげ図の基本形"><i class="fa fa-check"></i>箱ひげ図の基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#箱ひげ図に個別サンプルを追加"><i class="fa fa-check"></i>箱ひげ図に個別サンプルを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ヴァイオリングラフの基本形"><i class="fa fa-check"></i>ヴァイオリングラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ヴァイオリングラフに個別サンプルを追加"><i class="fa fa-check"></i>ヴァイオリングラフに個別サンプルを追加</a></li>
</ul></li>
<li class="chapter" data-level="4.19" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ドットプロット"><i class="fa fa-check"></i><b>4.19</b> ドットプロット</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ドットプロットの基本形"><i class="fa fa-check"></i>ドットプロットの基本形</a></li>
</ul></li>
<li class="chapter" data-level="4.20" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#複合グラフファセット"><i class="fa fa-check"></i><b>4.20</b> 複合グラフ（ファセット）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#行方向の複合グラフ"><i class="fa fa-check"></i>行方向の複合グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#列方向の複合グラフ"><i class="fa fa-check"></i>列方向の複合グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#行列方向の複合グラフ"><i class="fa fa-check"></i>行・列方向の複合グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#行数列数を指定した複合グラフ"><i class="fa fa-check"></i>行数・列数を指定した複合グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#複合グラフの設定"><i class="fa fa-check"></i>複合グラフの設定</a></li>
</ul></li>
<li class="chapter" data-level="4.21" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#地図ファセット"><i class="fa fa-check"></i><b>4.21</b> 地図ファセット</a></li>
<li class="chapter" data-level="4.22" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#補助線"><i class="fa fa-check"></i><b>4.22</b> 補助線</a></li>
<li class="chapter" data-level="4.23" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#設定色"><i class="fa fa-check"></i><b>4.23</b> 設定：色</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#色の手動指定離散型変数"><i class="fa fa-check"></i>色の手動指定（離散型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#brewerカラーパレット離散型変数"><i class="fa fa-check"></i>Brewerカラーパレット（離散型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#viridisカラーパレット離散型変数"><i class="fa fa-check"></i>Viridisカラーパレット（離散型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ggsciカラーパレット離散型変数"><i class="fa fa-check"></i>ggsciカラーパレット（離散型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#distillerカラーパレット連続型変数"><i class="fa fa-check"></i>distillerカラーパレット（連続型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#viridisカラーパレット連続型変数"><i class="fa fa-check"></i>Viridisカラーパレット（連続型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#gradientカラーパレット連続型変数"><i class="fa fa-check"></i>gradientカラーパレット（連続型変数）</a></li>
</ul></li>
<li class="chapter" data-level="4.24" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#設定軸"><i class="fa fa-check"></i><b>4.24</b> 設定：軸</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#x軸連続型y軸連続型"><i class="fa fa-check"></i>X軸：連続型、Y軸：連続型</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#対数目盛"><i class="fa fa-check"></i>対数目盛</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#x軸日付型y軸連続型"><i class="fa fa-check"></i>X軸：日付型、Y軸：連続型</a></li>
</ul></li>
<li class="chapter" data-level="4.25" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#設定パネル目盛線"><i class="fa fa-check"></i><b>4.25</b> 設定：パネル目盛線</a></li>
<li class="chapter" data-level="4.26" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#設定凡例"><i class="fa fa-check"></i><b>4.26</b> 設定：凡例</a></li>
<li class="chapter" data-level="4.27" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#設定タイトルキャプション"><i class="fa fa-check"></i><b>4.27</b> 設定：タイトル・キャプション</a></li>
<li class="chapter" data-level="4.28" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#設定フォントマージン"><i class="fa fa-check"></i><b>4.28</b> 設定：フォント・マージン</a></li>
<li class="chapter" data-level="4.29" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#グラフの保存"><i class="fa fa-check"></i><b>4.29</b> グラフの保存</a></li>
<li class="chapter" data-level="4.30" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#実例"><i class="fa fa-check"></i><b>4.30</b> 実例</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#実例1折れ線グラフ"><i class="fa fa-check"></i>実例1：折れ線グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#実例2積み上げ棒グラフ"><i class="fa fa-check"></i>実例2：積み上げ棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#実例3箱ひげ図"><i class="fa fa-check"></i>実例3：箱ひげ図</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="探索的データ分析.html"><a href="探索的データ分析.html"><i class="fa fa-check"></i><b>5</b> 探索的データ分析</a>
<ul>
<li class="chapter" data-level="5.1" data-path="探索的データ分析.html"><a href="探索的データ分析.html#第5章の準備"><i class="fa fa-check"></i><b>5.1</b> 第5章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#パッケージのインポート-3"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#ggplot2の設定-1"><i class="fa fa-check"></i>ggplot2の設定</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="探索的データ分析.html"><a href="探索的データ分析.html#データの中身記述統計量"><i class="fa fa-check"></i><b>5.2</b> データの中身（記述統計量）</a></li>
<li class="chapter" data-level="5.3" data-path="探索的データ分析.html"><a href="探索的データ分析.html#データの分布"><i class="fa fa-check"></i><b>5.3</b> データの分布</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#離散型変数の度数分布"><i class="fa fa-check"></i>離散型変数の度数分布</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#連続型変数の度数分布"><i class="fa fa-check"></i>連続型変数の度数分布</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#外れ値"><i class="fa fa-check"></i>外れ値</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="探索的データ分析.html"><a href="探索的データ分析.html#データの関係性"><i class="fa fa-check"></i><b>5.4</b> データの関係性</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#離散型変数の関係性"><i class="fa fa-check"></i>離散型変数の関係性</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#連続型変数の関係性"><i class="fa fa-check"></i>連続型変数の関係性</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="探索的データ分析.html"><a href="探索的データ分析.html#相関関係ペアプロット"><i class="fa fa-check"></i><b>5.5</b> 相関関係・ペアプロット</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#相関係数行列"><i class="fa fa-check"></i>相関係数行列</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#corrplotパッケージ"><i class="fa fa-check"></i>corrplotパッケージ</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#corrrパッケージ"><i class="fa fa-check"></i>corrrパッケージ</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#ggallyパッケージ"><i class="fa fa-check"></i>GGallyパッケージ</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="探索的データ分析.html"><a href="探索的データ分析.html#探索的データ分析の一括実行"><i class="fa fa-check"></i><b>5.6</b> 探索的データ分析の一括実行</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#dataexplorerパッケージ"><i class="fa fa-check"></i>DataExplorerパッケージ</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#smartedaパッケージ"><i class="fa fa-check"></i>SmartEDAパッケージ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="線形回帰.html"><a href="線形回帰.html"><i class="fa fa-check"></i><b>6</b> 線形回帰</a>
<ul>
<li class="chapter" data-level="6.1" data-path="線形回帰.html"><a href="線形回帰.html#第6章の準備"><i class="fa fa-check"></i><b>6.1</b> 第6章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#パッケージのインポート-4"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#外部データセットの取得-2"><i class="fa fa-check"></i>外部データセットの取得</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="線形回帰.html"><a href="線形回帰.html#用語の説明"><i class="fa fa-check"></i><b>6.2</b> 用語の説明</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#標本と推定"><i class="fa fa-check"></i>標本と推定</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#推定量の望ましい性質"><i class="fa fa-check"></i>推定量の望ましい性質</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="線形回帰.html"><a href="線形回帰.html#最小2乗法ols"><i class="fa fa-check"></i><b>6.3</b> 最小2乗法（OLS）</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#最小2乗法の仮定"><i class="fa fa-check"></i>最小2乗法の仮定</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#検定と信頼区間"><i class="fa fa-check"></i>検定と信頼区間</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="線形回帰.html"><a href="線形回帰.html#モデルの種類と係数の解釈"><i class="fa fa-check"></i><b>6.4</b> モデルの種類と係数の解釈</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#水準モデル"><i class="fa fa-check"></i>水準モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#対数モデル"><i class="fa fa-check"></i>対数モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#変化率モデル"><i class="fa fa-check"></i>変化率モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#多項式モデル"><i class="fa fa-check"></i>多項式モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#交互作用モデル"><i class="fa fa-check"></i>交互作用モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#ダミー変数"><i class="fa fa-check"></i>ダミー変数</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="線形回帰.html"><a href="線形回帰.html#重回帰モデルの役割と注意点"><i class="fa fa-check"></i><b>6.5</b> 重回帰モデルの役割と注意点</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#欠落変数バイアス"><i class="fa fa-check"></i>欠落変数バイアス</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#多重共線性"><i class="fa fa-check"></i>多重共線性</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#変数選択の指針"><i class="fa fa-check"></i>変数選択の指針</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="線形回帰.html"><a href="線形回帰.html#rの単回帰モデル推定"><i class="fa fa-check"></i><b>6.6</b> Rの単回帰モデル推定</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例-西山-4.1-線形単回帰"><i class="fa fa-check"></i>実証例 西山 4.1 線形単回帰</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例-西山-4.1-回帰診断プロット"><i class="fa fa-check"></i>実証例 西山 4.1 回帰診断プロット</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#対数変化率モデルの推定"><i class="fa fa-check"></i>対数・変化率モデルの推定</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="線形回帰.html"><a href="線形回帰.html#rの重回帰モデル推定"><i class="fa fa-check"></i><b>6.7</b> Rの重回帰モデル推定</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例-西山-5.15.4-線形重回帰"><i class="fa fa-check"></i>実証例 西山 5.1・5.4 線形重回帰</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例-西山-5.5-多項式モデル"><i class="fa fa-check"></i>実証例 西山 5.5 多項式モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例-西山-5.6-ダミー交互作用モデル"><i class="fa fa-check"></i>実証例 西山 5.6 ダミー・交互作用モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例-西山-5.7-ダミー変数同士の交互作用モデル"><i class="fa fa-check"></i>実証例 西山 5.7 ダミー変数同士の交互作用モデル</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="時系列データ操作.html"><a href="時系列データ操作.html"><i class="fa fa-check"></i><b>7</b> 時系列データ操作</a>
<ul>
<li class="chapter" data-level="7.1" data-path="時系列データ操作.html"><a href="時系列データ操作.html#第7章の準備"><i class="fa fa-check"></i><b>7.1</b> 第7章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#パッケージのインポート-5"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#外部データセットの取得-3"><i class="fa fa-check"></i>外部データセットの取得</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="時系列データ操作.html"><a href="時系列データ操作.html#時系列データとは"><i class="fa fa-check"></i><b>7.2</b> 時系列データとは</a></li>
<li class="chapter" data-level="7.3" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ts形式データ"><i class="fa fa-check"></i><b>7.3</b> ts形式データ</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ts形式データの表示"><i class="fa fa-check"></i>ts形式データの表示</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ts形式データ情報の取得"><i class="fa fa-check"></i>ts形式データ情報の取得</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ts形式データのフィルタ"><i class="fa fa-check"></i>ts形式データのフィルタ</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ts形式データのプロット"><i class="fa fa-check"></i>ts形式データのプロット</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ts形式データの変換"><i class="fa fa-check"></i><b>7.4</b> ts形式データの変換</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ts形式に変換ts"><i class="fa fa-check"></i>ts形式に変換：ts()</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ts形式に変換as_tsibble"><i class="fa fa-check"></i>ts形式に変換：as_tsibble()</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日付型データ関数"><i class="fa fa-check"></i><b>7.5</b> 日付型データ関数</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日付型データの生成"><i class="fa fa-check"></i>日付型データの生成</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日付型と文字列型の変換"><i class="fa fa-check"></i>日付型と文字列型の変換</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日付情報の抽出"><i class="fa fa-check"></i>日付情報の抽出</a></li>
<li class="chapter" data-level="7.5.1" data-path="時系列データ操作.html"><a href="時系列データ操作.html#四半期ベースの時系列インデックス"><i class="fa fa-check"></i><b>7.5.1</b> 四半期ベースの時系列インデックス</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="時系列データ操作.html"><a href="時系列データ操作.html#時系列データ作成"><i class="fa fa-check"></i><b>7.6</b> 時系列データ作成</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ラグリード系列の作成"><i class="fa fa-check"></i>ラグ・リード系列の作成</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#変化率系列の作成"><i class="fa fa-check"></i>変化率系列の作成</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#移動平均系列の作成"><i class="fa fa-check"></i>移動平均系列の作成</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="時系列データ操作.html"><a href="時系列データ操作.html#時系列データの頻度変換"><i class="fa fa-check"></i><b>7.7</b> 時系列データの頻度変換</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データを週次データに変換"><i class="fa fa-check"></i>日次データを週次データに変換</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データを月次データに変換"><i class="fa fa-check"></i>日次データを月次データに変換</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データを四半期データに変換"><i class="fa fa-check"></i>日次データを四半期データに変換</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="時系列データ操作.html"><a href="時系列データ操作.html#季節調整x-13"><i class="fa fa-check"></i><b>7.8</b> 季節調整（X-13）</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ts形式データの可視化"><i class="fa fa-check"></i>ts形式データの可視化</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#x-13arima-seatsの実施方法"><i class="fa fa-check"></i>X-13ARIMA-SEATSの実施方法</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#実例月次データの季節調整"><i class="fa fa-check"></i>実例：月次データの季節調整</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="時系列データ操作.html"><a href="時系列データ操作.html#季節調整stl分解"><i class="fa fa-check"></i><b>7.9</b> 季節調整（STL分解）</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#stl分解の実施方法"><i class="fa fa-check"></i>STL分解の実施方法</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#週次データのstl分解"><i class="fa fa-check"></i>週次データのSTL分解</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データのstl分解単一周期"><i class="fa fa-check"></i>日次データのSTL分解（単一周期）</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データのstl分解複数周期"><i class="fa fa-check"></i>日次データのSTL分解（複数周期）</a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="時系列データ操作.html"><a href="時系列データ操作.html#トレンド"><i class="fa fa-check"></i><b>7.10</b> トレンド</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#線形トレンド"><i class="fa fa-check"></i>線形トレンド</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#区分線形トレンド"><i class="fa fa-check"></i>区分線形トレンド</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#hpフィルタ"><i class="fa fa-check"></i>HPフィルタ</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#一般化加法モデルgam"><i class="fa fa-check"></i>一般化加法モデル（GAM）</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="時系列データ操作.html"><a href="時系列データ操作.html#構造変化"><i class="fa fa-check"></i><b>7.11</b> 構造変化</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#構造変化点が既知の場合"><i class="fa fa-check"></i>構造変化点が既知の場合</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#構造変化点が未知の場合"><i class="fa fa-check"></i>構造変化点が未知の場合</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">エコノミストのためのR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="線形回帰" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> 線形回帰<a href="線形回帰.html#線形回帰" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>第6章「線形回帰」では、計量経済学の基本である線形回帰モデルについて解説します。この章の説明は、山本（2015）、西山 他（2019）、末石（2015）をもとにしています。詳細は各参考文献を参照してください。</p>
<p>実証例は、西山 他（2019）のデータセットを使用し、北川（2020）のウェブサイトに掲載されているRコードを参考にしています。</p>
<div id="第6章の準備" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> 第6章の準備<a href="線形回帰.html#第6章の準備" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="パッケージのインポート-4" class="section level3 unnumbered hasAnchor">
<h3>パッケージのインポート<a href="線形回帰.html#パッケージのインポート-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="線形回帰.html#cb601-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb601-2"><a href="線形回帰.html#cb601-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb601-3"><a href="線形回帰.html#cb601-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb601-4"><a href="線形回帰.html#cb601-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb601-5"><a href="線形回帰.html#cb601-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb601-6"><a href="線形回帰.html#cb601-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyquant)</span>
<span id="cb601-7"><a href="線形回帰.html#cb601-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="外部データセットの取得-2" class="section level3 unnumbered hasAnchor">
<h3>外部データセットの取得<a href="線形回帰.html#外部データセットの取得-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>この章では、西山 他（2019）の実証例のデータセットを使用します。<a href="http://www.yuhikaku.co.jp/books/detail/9784641053854">西山 他（2019）のサポートウェブサイト</a>からデータファイルを取得し、各自の実行環境のワーキングディレクトリ直下に<code>data_nishiyama</code>フォルダを作成して、その中に格納してください。</p>
</div>
</div>
<div id="用語の説明" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> 用語の説明<a href="線形回帰.html#用語の説明" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>まず、統計学・計量経済学で使用される基本的な用語を説明します。</p>
<div id="標本と推定" class="section level3 unnumbered hasAnchor">
<h3>標本と推定<a href="線形回帰.html#標本と推定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>母集団</strong>：　調べる対象全体（population）</p>
<p><strong>標本</strong>：　母集団から取り出した対象の一部（sample）</p>
<p><strong>推定</strong>：　標本を使って母集団の分布に関する未知の値を言い当てること（estimation）</p>
<p><strong>未知パラメータ</strong>：　推定すべき未知の値。一般的に<span class="math inline">\(\theta\)</span>で表す（unknown parameter）</p>
<p><strong>統計量</strong>：　未知の値に依存せず、標本があれば値が計算できるデータの関数（statistic）</p>
<p><strong>推定量</strong>：　推定に用いる統計量（estimator）</p>
<p><strong>推定値</strong>：　未知の値について、実際にデータから計算して得た値（estimate）</p>
<p><strong>点推定</strong>：　未知パラメータの値を1点で言い当てること（point estimation）</p>
<p><strong>区間推定</strong>：　統計誤差を考慮して未知パラメータの値を区間で言い当てること（interval estimation）</p>
<p><strong>統計誤差</strong>：　母集団全体でなく標本を用いることで推定結果に生じる誤差（statistical error）</p>
</div>
<div id="推定量の望ましい性質" class="section level3 unnumbered hasAnchor">
<h3>推定量の望ましい性質<a href="線形回帰.html#推定量の望ましい性質" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>不偏性</strong>：　推定量の期待値が推定対象の未知パラメータの真の値に等しいこと（unbiasedness）</p>
<p><strong>一致制</strong>：　サンプルサイズが大きくなると、推定量が未知パラメータの真の値となる確率が1に近づくこと（consistency）</p>
<p><strong>漸近正規性</strong>：　サンプルサイズが大きいとき、そのサンプルから構成される確率変数が近似的に正規分布に従うこと（asymptomatic normality）</p>
<p><strong>効率性</strong>：　推定量の分散が小さく、未知パラメータの真の値に近い値をとりやすいこと（efficiency）</p>
<p><strong>頑健性</strong>：　異常値があっても推定量が影響を受けにくいこと（robustness）</p>
</div>
</div>
<div id="最小2乗法ols" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> 最小2乗法（OLS）<a href="線形回帰.html#最小2乗法ols" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>次に、線形回帰の推定方法である最小2乗法と、統計的仮説検定について解説します。</p>
<p>変数<span class="math inline">\(X\)</span>を用いて変数<span class="math inline">\(Y\)</span>を推定する、次のようなモデルを考えます。</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1X_i + u_i \quad (i = 1,\, \ldots,\, n)
\]</span></p>
<p>ここで、<span class="math inline">\(Y_i\)</span>は被説明変数（dependent variable）、<span class="math inline">\(X_i\)</span>は説明変数（independent variable）、<span class="math inline">\(u_i\)</span>は誤差項（error term）と呼ばれます。誤差項は<span class="math inline">\(X_i\)</span>以外で<span class="math inline">\(Y_i\)</span>に影響を与える要因をひとまとめにしたものと解釈できます。</p>
<div id="最小2乗法の仮定" class="section level3 unnumbered hasAnchor">
<h3>最小2乗法の仮定<a href="線形回帰.html#最小2乗法の仮定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>次の3つの仮定が成立するとき、OLS推定量は推定の望ましい性質である「不偏性」、「一致性」、「漸近正規性」を満たします。</p>
<div id="仮定1データが無作為抽出" class="section level4 unnumbered hasAnchor">
<h4>仮定1：データが無作為抽出<a href="線形回帰.html#仮定1データが無作為抽出" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>標本が同一の母集団から無作為抽出（ランダムサンプリング）されているという仮定であり、数学的には、<span class="math inline">\(Y_i\)</span>と<span class="math inline">\(X_i\)</span>が独立かつ同一の分布に従う（independently and identically distributed、i.i.d）と定義されます。</p>
<p>多くのクロスセクションデータでは仮定1が成立しますが、時系列データや、時系列の要素を含むパネルデータでは仮定1が成立しないと考えるのが自然です。家計の消費支出の慣性効果など、経済主体の行動は過去からの影響を受けやすく、過去と現在のデータに相関があることが多いためです。</p>
<p><u>仮定1が成立しない場合、誤差項が<strong>自己相関（autocorrelation）・系列相関（serial correlation）</strong>をもち、推定量のばらつきが大きくなる問題が発生します</u>。そのような場合に、仮定1のもとで計算した標準誤差（推定量の標準偏差を推定した値）を用いると分散の大きさを過小評価してしまうため、<u>自己相関の可能性を考慮した<strong>HAC標準誤差（ニューウィー＝ウェストの標準誤差）</strong>を用いる必要があります</u>。</p>
<p>なお、HAC標準誤差のHACはHeteroskedasticity and Autocorrelation Consistentの略であり、自己相関（autocorrelation）の問題だけでなく、この後で紹介する不均一分散（heteroskedasticity）の問題が存在しても対応可能であることを意味しています。サンプルサイズが十分大きければ、誤差項に自己相関がない場合にHAC標準誤差を使用しても、大きな問題は生じません。したがって、誤って「自己相関がない」と判断するリスクを考慮すれば、常にHAC標準誤差を用いるのが無難です（西山 他（2019）P.493）。</p>
</div>
<div id="仮定2説明変数と誤差項が無相関" class="section level4 unnumbered hasAnchor">
<h4>仮定2：説明変数と誤差項が無相関<a href="線形回帰.html#仮定2説明変数と誤差項が無相関" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>外生性</strong>と呼ばれる仮定であり、<span class="math inline">\(Y_i\)</span>の変動要因のうち<span class="math inline">\(X_i\)</span>以外の部分（すなわち誤差項<span class="math inline">\(u_i\)</span>）が平均的には<span class="math inline">\(X_i\)</span>と無関係であることを意味します。数学的には、誤差項の条件付き期待値が説明変数に依存しない（<span class="math inline">\(E(u_i|X_i) = 0\)</span>）と定義されます。</p>
<p>仮定2が成立していれば、モデルが因果関係を表していると解釈できます（ただし、仮定3が成立しているかどうかを回帰分析の結果から判断することはできません）。</p>
<p>仮定2が成立しないケースは多く、例えば、説明変数に本来含まれるべき変数が欠落している<strong>欠落変数バイアス</strong>、被説明変数が説明変数の変動要因になっている<strong>内生性バイアス（逆の因果性）</strong>などがあります。</p>
<p><u>仮定2が成立しない場合、OLS推定量は不偏性と一致性を満たさず、未知パラメータの値をきちんと推定することができない深刻な問題が発生します</u>。対処方法として、他の説明変数の追加（重回帰モデル）による欠落変数バイアスの解消、パネルデータを用いた固定効果モデルの推定、2段階最小2乗法や操作変数法による内生性バイアスの解消を検討する必要があります。</p>
</div>
<div id="仮定3異常値が少ない" class="section level4 unnumbered hasAnchor">
<h4>仮定3：異常値が少ない<a href="線形回帰.html#仮定3異常値が少ない" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>標本に含まれる異常値（データの絶対値が平均から大幅に離れている値）が少ないという仮定であり、数学的には変数の4次のモーメントが有限（<span class="math inline">\(0 &lt; E(X_i^4) &lt; \infty, \quad 0 &lt; E(Y_i^4) &lt; \infty\)</span>）と定義されます。すなわち、データの分布の裾が厚くない（ファット・テールでない）ということです。</p>
<p>一部の金融データなどでは異常値を取ることが多く（分布の裾が厚く）、仮定3が満たされない可能性があります。</p>
<p><u>仮定3が成立しない場合、OLS推定量が漸近正規性を満たさなくなります</u>。漸近正規性は、直接的に推定量の良し悪しに関わる性質ではありませんが、係数に関する仮説検定や区間推定を行う基礎になる重要な性質です。</p>
</div>
<div id="追加の仮定誤差項の均一分散" class="section level4 unnumbered hasAnchor">
<h4>追加の仮定：誤差項の均一分散<a href="線形回帰.html#追加の仮定誤差項の均一分散" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>被説明変数<span class="math inline">\(Y_i\)</span>のデータの散らばり具合が説明変数<span class="math inline">\(X_i\)</span>の値によらず一定であるとき、誤差項<span class="math inline">\(u_i\)</span>の分散が一定、すなわち<strong>均一分散（homoskedasticity）</strong>であるといいます（<span class="math inline">\(Var(u|X) = E(u^2|X) = \sigma^2\)</span>）。</p>
<p>仮定1～3に加えて「誤差項の均一分散」の仮定が成立している場合、OLS推定量は線形な不偏推定量の中で「効率性」が最も高くなります（ガウス＝マルコフの定理）。これは、推定量の分散が最も小さく、推定量が真の値に近い値を取りやすいことを意味します。この時の推定量を、最良線形不偏推定量（best linear unbiased estimator, BLUE）と呼びます。</p>
<p>しかし、経済データ（特にクロスセクションデータ）で「誤差項の均一分散」の仮定が成立することは少なく、誤差項<span class="math inline">\(u_i\)</span>の分散が説明変数<span class="math inline">\(X_i\)</span>に依存する<strong>不均一分散（heteroskedasticity）</strong>の方がむしろ一般的と考えられます。例えば、複数の家計の所得・消費データから消費関数を推定する際、所得水準が高いほど消費スタイルの違いによる消費額のばらつきが大きいことが想定されますが、その場合は均一分散の仮定が成立しません。</p>
<p><u>均一分散の仮定が成立しない（不均一分散が生じている）場合は、推定量の効率性が悪化し、ばらつきが大きくなってしまう問題があります</u>。そのようなケースで均一分散を仮定して標準誤差（推定量の標準偏差を推定した値）を計算すると分散の大きさを過小評価してしまうため、<u>不均一分散の可能性を考慮した<strong>不均一分散に頑健な標準誤差（ホワイトの標準誤差）</strong>を用いる必要があります</u>。ただし、時系列データのように自己相関の可能性が考えられる場合は、上記のように不均一分散と自己相関に頑健なHAC標準誤差（ニューウィー＝ウェストの標準誤差）を用いる方が良いでしょう。</p>
</div>
</div>
<div id="検定と信頼区間" class="section level3 unnumbered hasAnchor">
<h3>検定と信頼区間<a href="線形回帰.html#検定と信頼区間" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="帰無仮説と対立仮説" class="section level4 unnumbered hasAnchor">
<h4>帰無仮説と対立仮説<a href="線形回帰.html#帰無仮説と対立仮説" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>モデル<span class="math inline">\(Y_i = \beta_0 + \beta_1 X_i + u_i\)</span>について、次のような帰無仮説<span class="math inline">\(H_0\)</span>（null hypothesis）と対立仮説<span class="math inline">\(H_1\)</span>（alternative hypothesis）を考えます。</p>
<p><span class="math display">\[
H_0 : \beta_1 = 0 \\
H_1 : \beta_1 \neq 0
\]</span></p>
<p>推定にあたり、我々が本当に興味があるのは未知パラメータ<span class="math inline">\(\beta_1\)</span>の真の値であり、またそれを言い当てるための推定値と標準誤差であるわけですが、ここでは「少なくとも未知パラメータの真の値がゼロではない（有意である）」ことを統計的に確認するために、こうした検定を行います。</p>
</div>
<div id="t値" class="section level4 unnumbered hasAnchor">
<h4>t値<a href="線形回帰.html#t値" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>検定には<strong>t統計量（t値）</strong>を用います。t統計量は、未知パラメータの推定量と帰無仮説の設定値の差を、標準誤差（推定量の標準偏差を推定した値）で割ったものです。</p>
<p><span class="math display">\[
t = \frac{推定量 - 帰無仮説の設定値（ここではゼロ）}{標準誤差}
\]</span></p>
<p>t値が大きいほど、推定値に対して相対的に標準誤差が小さいことを意味します。目安として、t値が1.9や1.6など絶対値で2に近い値より大きければ、推定値の標準誤差は未知パラメータの符号条件を変えるほど大きくなく、未知パラメータの真の値がゼロである可能性は低い（推定値が統計的に有意である）と判断できます。</p>
</div>
<div id="p値" class="section level4 unnumbered hasAnchor">
<h4>p値<a href="線形回帰.html#p値" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>このt値を確率に置き換えたものが<strong>p値</strong>です。p値は「帰無仮説が正しいとしたときの確率分布のもとで、t値が観測したデータ（標本）から計算した値より極端な値をとる確率」を示したもので、t値が大きくなるほどp値は小さくなります。</p>
<p>p値は「帰無仮説が正しいとしたときの確率分布のもとで、観測したデータによる統計量の値、もしくはそれより極端な統計量をとる確率」と定義されます（McAlinn（2022）P.50）。p値がある一定の水準より小さければ、観測したデータは帰無仮説下では起こりにくいと判断し、帰無仮説<span class="math inline">\(H_0\)</span>を棄却して対立仮説<span class="math inline">\(H_1\)</span>を採択します。その際の「一定の水準」を<strong>有意水準</strong>と言い、一般的に5％や1％といった水準が用いられます。</p>
<p>p値の解釈については、いくつか注意点があります。</p>
<ul>
<li><p><u>p値が有意水準より大きく、帰無仮説を棄却できなかった場合、帰無仮説が正しい（未知パラメータの真の値がゼロ）と結論付けることはできません</u>。この場合は「未知パラメータの推定値が統計的に有意であることが確認できず、判断を留保する」ことになります。</p></li>
<li><p><u>p値は、帰無仮説を反証（棄却）するエビデンスの強さではありません</u>。帰無仮説は正しいか正しくないかの二択でしかないため、p値そのものに意味はなく、あくまで事前に決めた有意水準に達したか達していないかの二分法になります。有意水準5％で棄却すると設定したのであれば、p値が4.99％でも0.01％でも関係ないということです。</p></li>
<li><p><u>p値は効果の大きさや結果の重要性を示すものではありません</u>。ある説明変数が被説明変数にとって重要であるかを判断するためには、未知パラメータの推定値が有意かどうかに加えて、未知パラメータの推定値の大きさや、説明変数の変動量を考慮する必要があります。</p></li>
</ul>
</div>
<div id="信頼区間" class="section level4 unnumbered hasAnchor">
<h4>信頼区間<a href="線形回帰.html#信頼区間" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>信頼区間（confidence interval、CI）</strong>は、推定結果の精度を幅で示すものです。具体的には、未知パラメータの推定値と標準誤差を用い、ある一定の確率の下で未知パラメータの真の値を含む区間を計算します。その際の「一定の確率」を<strong>信頼係数</strong>といい、要求される推定の精度に応じ、一般的に95％や99％といった水準が用いられます。</p>
<p>信頼区間の解釈には注意が必要です。例えば、<u>標本から未知パラメータの95％信頼区間が10～20と計算されたとき、これは「パラメータの真の値が95％の確率で10～20の間にある」ことを意味するものではありません</u>。パラメータの真の値は定数であり、動かないのに対し、信頼区間は標本から計算した実現値のうちの一つであり、標本の選び方によりランダムに変わるためです。<u>95％信頼区間の意味は、「同一の母集団から独立な標本が100回得られて、信頼区間を100回計算することができれば、そのうち95回はパラメータの真の値を含む」ということ</u>です（末石（2015）P.11）。</p>
</div>
</div>
</div>
<div id="モデルの種類と係数の解釈" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> モデルの種類と係数の解釈<a href="線形回帰.html#モデルの種類と係数の解釈" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>ここでは線形回帰モデルの具体的な推定式として、実務で頻繁に用いる水準モデル、対数モデル、変化率モデル、多項式モデル、交互作用モデル、ダミー変数モデルを取り上げ、それぞれの内容と係数の解釈方法を説明します。</p>
<div id="水準モデル" class="section level3 unnumbered hasAnchor">
<h3>水準モデル<a href="線形回帰.html#水準モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X + u
\]</span></p>
<p>被説明変数<span class="math inline">\(Y\)</span>、説明変数<span class="math inline">\(X\)</span>ともにレベルの場合、係数<span class="math inline">\(\beta_1\)</span>は、説明変数<span class="math inline">\(X\)</span>が1単位変化すると被説明変数<span class="math inline">\(Y\)</span>が<span class="math inline">\(\beta_1\)</span>単位変化することを示します。</p>
<p>例えば、<span class="math inline">\(Y\)</span>が実質賃金（円）、<span class="math inline">\(X\)</span>が労働生産性（円）のとき、労働生産性が1円上昇すると実質賃金は<span class="math inline">\(\beta_1\)</span>円上昇します。</p>
</div>
<div id="対数モデル" class="section level3 unnumbered hasAnchor">
<h3>対数モデル<a href="線形回帰.html#対数モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="両辺が自然対数の場合" class="section level4 unnumbered hasAnchor">
<h4>両辺が自然対数の場合<a href="線形回帰.html#両辺が自然対数の場合" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
\ln Y = \beta_0 + \beta_1 \ln X + u
\]</span></p>
<p>被説明変数<span class="math inline">\(\ln Y\)</span>、説明変数<span class="math inline">\(\ln X\)</span>ともに自然対数の場合、係数<span class="math inline">\(\beta_1\)</span>は、説明変数<span class="math inline">\(X\)</span>が1％変化したときに被説明変数<span class="math inline">\(Y\)</span>が<span class="math inline">\(\beta_1\)</span>％変化することを示します。このとき、<span class="math inline">\(\beta_1\)</span>を<strong>弾性値（弾力性）</strong>と呼びます。</p>
<p>このように解釈できる理由は、次の通りです。変数<span class="math inline">\(X\)</span>がある小さい量<span class="math inline">\(\Delta x\)</span>だけ変化したときの<span class="math inline">\(\ln X\)</span>の変化量を<span class="math inline">\(\Delta \ln X\)</span>とすると、対数関数の性質を用いて、</p>
<p><span class="math display">\[
\Delta \ln X = \ln (X + \Delta x) - \ln X = \ln (1 + \frac{\Delta x}{X}) \approx \frac{\Delta x}{X}
\]</span></p>
<p>となります。<span class="math inline">\(\Delta x / X\)</span>は<span class="math inline">\(X\)</span>の変化率なので、この式から、<span class="math inline">\(X\)</span>が1％変化することと<span class="math inline">\(\ln X\)</span>が0.01変化することはほぼ同じであることがわかります。すると、「<span class="math inline">\(X\)</span>が1％変化する」＝「<span class="math inline">\(\ln X\)</span>が<span class="math inline">\(0.01\)</span>変化する」＝「<span class="math inline">\(\ln Y\)</span>が<span class="math inline">\(0.01 \times \beta_1\)</span>変化する」＝「<span class="math inline">\(Y\)</span>が<span class="math inline">\(\beta_1\)</span>％変化する」となります（西山 他（2019）P.107）。</p>
</div>
<div id="どちらか一方の辺が自然対数の場合" class="section level4 unnumbered hasAnchor">
<h4>どちらか一方の辺が自然対数の場合<a href="線形回帰.html#どちらか一方の辺が自然対数の場合" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
\begin{aligned}
\ln Y &amp;= \beta_0 + \beta_1 X + u \\
Y &amp;= \beta_0 + \beta_1 \ln X + u
\end{aligned}
\]</span></p>
<p>被説明変数<span class="math inline">\(\ln Y\)</span>が自然対数、説明変数<span class="math inline">\(X\)</span>がレベルのとき、係数<span class="math inline">\(\beta_1\)</span>は、説明変数<span class="math inline">\(X\)</span>が1単位変化したときに被説明変数<span class="math inline">\(Y\)</span>が<span class="math inline">\(\beta_1\)</span>％変化することを示します。このとき、<span class="math inline">\(\beta_1\)</span>を<strong>偏弾性値</strong>と呼びます。</p>
<p>逆に、被説明変数<span class="math inline">\(Y\)</span>がレベル、説明変数<span class="math inline">\(\ln X\)</span>が自然対数の場合、係数<span class="math inline">\(\beta_1\)</span>は、説明変数<span class="math inline">\(X\)</span>が1％変化したときに被説明変数<span class="math inline">\(Y\)</span>が<span class="math inline">\(\beta_1/100\)</span>単位変化することを示します。</p>
</div>
</div>
<div id="変化率モデル" class="section level3 unnumbered hasAnchor">
<h3>変化率モデル<a href="線形回帰.html#変化率モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
\begin{aligned}
100 \times \frac{\Delta Y_t}{Y_{t-1}} &amp;= \beta_0 + \beta_1 \times 100 \times \frac{\Delta X_t}{X_{t-1}} + u \\
100 \times \Delta \ln Y_t &amp;= \beta_0 + \beta_1 \times 100 \times \Delta \ln X_t + u
\end{aligned}
\]</span></p>
<p>時系列データについて、ある変数<span class="math inline">\(X_t\)</span>と、その1期ラグ付き変数<span class="math inline">\(X_{t-1}\)</span>の差<span class="math inline">\(X_t - X_{t-1}\)</span>を<strong>階差</strong>と呼び、<span class="math inline">\(\Delta X_t = X_t - X_{t-1}\)</span>と表します。階差<span class="math inline">\(\Delta X_t\)</span>を1期ラグ付き変数<span class="math inline">\(X_{t-1}\)</span>で割り、100を掛けてパーセント表示にした系列<span class="math inline">\(100 \times \Delta X_t / X_{t-1}\)</span>を<strong>変化率</strong>と呼びます。</p>
<p>また、上記の対数モデルで見た<span class="math inline">\(\Delta \ln X \approx \Delta X / X\)</span>を用いると、時系列データの変数<span class="math inline">\(X_t\)</span>について自然対数の階差をとった<span class="math inline">\(\Delta \ln X_t = \ln X_t - \ln X_{t-1}\)</span>に100を掛けた系列は、変化率<span class="math inline">\(100 \times \Delta X_t / X_{t-1}\)</span>に近似できます。すなわち、<span class="math inline">\(100 \times \Delta \ln X_t \approx 100 \times \Delta X_t / X_{t-1}\)</span>です。この<span class="math inline">\(100 \times \Delta \ln X_t\)</span>を<strong>対数階差変化率</strong>と呼びます。</p>
<p>被説明変数と説明変数がともに変化率もしくは対数階差変化率のとき、係数<span class="math inline">\(\beta_1\)</span>は、説明変数（変化率）が1％ポイント変化したときに、被説明変数（変化率）が<span class="math inline">\(\beta_1\)</span>％ポイント変化することを示します。なお、このときの係数<span class="math inline">\(\beta_1\)</span>は、対数モデルの係数の解釈である弾力性とは全く異なるものである点に注意してください。</p>
</div>
<div id="多項式モデル" class="section level3 unnumbered hasAnchor">
<h3>多項式モデル<a href="線形回帰.html#多項式モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X + \beta_2 X^2 + u
\]</span></p>
<p>多項式の推定式では、説明変数<span class="math inline">\(X\)</span>が入る項が複数あるため、<span class="math inline">\(\beta_1\)</span>、<span class="math inline">\(\beta_2\)</span>単独では<span class="math inline">\(X\)</span>の変化による<span class="math inline">\(Y\)</span>への影響を測ることができません。<span class="math inline">\(X\)</span>の変化による<span class="math inline">\(Y\)</span>への影響は、右辺を<span class="math inline">\(X\)</span>で微分した結果である</p>
<p><span class="math display">\[
\frac{\partial(\beta_0 + \beta_1 X + \beta_2 X^2)}{\partial X} = \beta_1 + 2 \beta_2 X
\]</span></p>
<p>で表されます。これを<strong>限界効果</strong>と呼びます。ただし、限界効果の大きさは<span class="math inline">\(X\)</span>の値に依存するので、一定ではありません。そこで、限界効果の<span class="math inline">\(X\)</span>を<span class="math inline">\(X\)</span>の平均値<span class="math inline">\(\overline{X}\)</span>で置き換えた<strong>平均限界効果</strong><span class="math inline">\(\beta_1 + 2 \beta_2 \overline{X}\)</span>も、<span class="math inline">\(X\)</span>の変化による<span class="math inline">\(Y\)</span>への影響を測る値をして使用されます。</p>
<p>なお、上記の例では、限界効果がゼロ、すなわち<span class="math inline">\(\beta_1 + 2 \beta_2 X = 0\)</span>とおいて、<span class="math inline">\(X\)</span>について解くと、<span class="math inline">\(X = -\beta_1 / 2 \beta_2\)</span>が<span class="math inline">\(Y\)</span>を最大もしくは最小にする<span class="math inline">\(X\)</span>の値であることが計算できます。</p>
</div>
<div id="交互作用モデル" class="section level3 unnumbered hasAnchor">
<h3>交互作用モデル<a href="線形回帰.html#交互作用モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_1 X_2 + u
\]</span></p>
<p>交互作用モデルには、複数の変数の掛け算である<strong>交差項</strong>（ここでは<span class="math inline">\(X_1 X_2\)</span>）が入っています。これは、説明変数<span class="math inline">\(X_1\)</span>と<span class="math inline">\(X_2\)</span>が互いに影響しながら相乗効果として被説明変数<span class="math inline">\(Y\)</span>に影響するメカニズムを捉えています。</p>
<p>例えば、被説明変数<span class="math inline">\(Y\)</span>が給与額、説明変数<span class="math inline">\(X_1\)</span>と<span class="math inline">\(X_2\)</span>がそれぞれ教育年数と勤続年数の交互作用モデルを推定すると、給与額は教育年数、勤続年数それぞれ単独の影響だけでなく、教育年数と勤続年数の相乗効果の影響も受けることを想定していることになります（山本（2015）P.40）。</p>
<p>上記の交互作用モデルにおける説明変数<span class="math inline">\(X_1\)</span>の限界効果は<span class="math inline">\(\beta_1 + \beta_3 X_2\)</span>、平均限界効果は<span class="math inline">\(\beta_1 + \beta_3 \overline{X_2}\)</span>となります。</p>
</div>
<div id="ダミー変数" class="section level3 unnumbered hasAnchor">
<h3>ダミー変数<a href="線形回帰.html#ダミー変数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="切片ダミーの場合" class="section level4 unnumbered hasAnchor">
<h4>切片ダミーの場合<a href="線形回帰.html#切片ダミーの場合" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 D + \beta_2 X + u
\]</span></p>
<p>切片ダミーは、データの属性を区別するダミー変数<span class="math inline">\(D\)</span>が単独の項として推定式に入っているモデルであり、被説明変数<span class="math inline">\(Y\)</span>の平均的な水準がデータの属性により異なるメカニズムを捉えます。</p>
<p>例えば、被説明変数<span class="math inline">\(Y\)</span>が給与額、説明変数<span class="math inline">\(X\)</span>が勤続年数のモデルで、男性なら1、女性なら0をとる「男性ダミー変数」<span class="math inline">\(D\)</span>を考えます。このとき、男性の給与額は<span class="math inline">\(Y = (\beta_0 + \beta_1) + \beta_2 X\)</span>、女性の給与額は<span class="math inline">\(Y = \beta_0 + \beta_2 X\)</span>で表されるため、男性ダミー<span class="math inline">\(D\)</span>の係数<span class="math inline">\(\beta_1\)</span>は給与額の男性プレミアム（またはディスカウント）を捉えたものと解釈できます。</p>
<p>なお、「男性ダミー変数」<span class="math inline">\(D\)</span>の係数<span class="math inline">\(\beta_1\)</span>が捉えているのは、比較の基準である女性の給与額との差であり、男性の給与額の絶対的な水準を示すものではありません。また、<span class="math inline">\(\beta_1\)</span>は比較の基準である女性の給与額に関する情報は一切もっていません。</p>
</div>
<div id="傾きダミーの場合" class="section level4 unnumbered hasAnchor">
<h4>傾きダミーの場合<a href="線形回帰.html#傾きダミーの場合" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X + \beta_2 D X+ u
\]</span></p>
<p>傾きダミーは、ダミー変数<span class="math inline">\(D\)</span>が説明変数<span class="math inline">\(X\)</span>との交差項として推定式に入っているモデルであり、説明変数<span class="math inline">\(X\)</span>の影響が属性により異なるメカニズムを捉えます。</p>
<p>例えば、被説明変数<span class="math inline">\(Y\)</span>が給与額、説明変数<span class="math inline">\(X\)</span>が勤続年数のモデルで、男性なら1、女性なら0をとる「男性ダミー変数」<span class="math inline">\(D\)</span>を考えます。このとき、男性の給与額は<span class="math inline">\(Y = \beta_0 + (\beta_1 + \beta_2) X\)</span>、女性の給与額は<span class="math inline">\(Y = \beta_0 + \beta_1 X\)</span>で表されるため、男性ダミー<span class="math inline">\(D\)</span>の係数<span class="math inline">\(\beta_2\)</span>は給与額に対する勤続年数の効果を増幅（または縮小）させる影響を捉えたものと解釈できます。</p>
<p>なお、「男性ダミー変数」<span class="math inline">\(D\)</span>の係数<span class="math inline">\(\beta_2\)</span>が捉えているのは、比較の基準である女性の勤続年数効果との差であり、男性の勤続年数効果を示すものではありません。また、<span class="math inline">\(\beta_2\)</span>は比較の基準である女性の勤続年数効果に関する情報は一切もっていません。</p>
</div>
</div>
</div>
<div id="重回帰モデルの役割と注意点" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> 重回帰モデルの役割と注意点<a href="線形回帰.html#重回帰モデルの役割と注意点" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>線形重回帰モデルは、次のように説明変数を2つ以上もつ線形回帰モデルのことです。</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1X_{1i} + \beta_2X_{2i} + \dots + \beta_kX_{ki} + u_i \quad (i = 1,\, \ldots,\, n)
\]</span></p>
<div id="欠落変数バイアス" class="section level3 unnumbered hasAnchor">
<h3>欠落変数バイアス<a href="線形回帰.html#欠落変数バイアス" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>重回帰モデルを使用する主な目的は、最小2乗法の仮定3「説明変数と誤差項が無相関」が成立しない原因の一つである<strong>欠落変数バイアス（omitted variable bias）</strong>に対処するためです。</p>
<p>欠落変数バイアスは、被説明変数<span class="math inline">\(Y_i\)</span>に影響を及ぼす変数を説明変数に含んでいないことによって起こります。こうした変数を<strong>交絡因子（confounding factor）</strong>と呼びます。</p>
<p>重回帰分析では、交絡因子の可能性がある変数を説明変数に追加し、欠落変数バイアスの問題を回避します。この作業を<strong>コントロール</strong>と呼び、追加される変数を<strong>コントロール変数</strong>と言います。コントロール変数は欠落変数バイアスを回避するためにモデルに追加されるため、コントロール変数が被説明変数に与える影響を推定することは主たる目的ではありません。</p>
</div>
<div id="多重共線性" class="section level3 unnumbered hasAnchor">
<h3>多重共線性<a href="線形回帰.html#多重共線性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>多重共線性には2つのケースがあります。</p>
<p>一つは<strong>完全な多重共線性（perfect multicollinearity）</strong>で、ある説明変数が他の説明変数の線形和によって表される場合が該当します。このとき、最小2乗推定量が一意に定まらないため、推定不能になります。</p>
<p>もう一つは<strong>不完全な多重共線性</strong>で、説明変数間に強い相関がある場合が該当します。一般的に多重共線性というときはこちらを差すことが多いでしょう。多重共線性が発生すると、推定量の分散が大きくなり、係数の正確な推定が困難になります。</p>
<p>多重共線性には有効な解決策はありません。重回帰モデルでは欠落変数バイアスを回避するためにコントロール変数を追加していることが多く、多重共線性に対処するためにコントロール変数を除外すれば、欠落変数バイアスを回避することができなくなるためです。</p>
<p>末石（2015）P.18では、「明らかに不要な説明変数が入っているときは別として、多重共線性をなくそうとあれこれと工夫をするよりも、多くの場合は放置しておくのが無難」、「多重共線性はないに越したことはないが、完全な多重共線性とは異なり、論理的な欠陥ではない」、「推定量の分散は大きくなるが、それは標準誤差に反映されるので、検定をしたり信頼区間を求める際には、特に問題にならない」としています。</p>
</div>
<div id="変数選択の指針" class="section level3 unnumbered hasAnchor">
<h3>変数選択の指針<a href="線形回帰.html#変数選択の指針" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ここでは、重回帰分析にとって重要な「どの変数を推定式に含めるべきか」について解説します。詳細は西山 他（2019）P.185を参照してください。</p>
<div id="欠落変数バイアスを避けられるか" class="section level4 unnumbered hasAnchor">
<h4>1. 欠落変数バイアスを避けられるか<a href="線形回帰.html#欠落変数バイアスを避けられるか" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>興味がある説明変数が被説明変数に与える影響を正しく推定するためには、<u>その説明変数と相関し、かつ被説明変数に影響を与える変数</u>をコントロール変数として回帰モデルに含める必要があります。コントロール変数について注意すべき点は次の通りです。</p>
<ul>
<li>コントロール変数は分析対象として興味がなくても良い。</li>
<li>興味のある説明変数と無関係なコントロール変数を入れる必要はない。</li>
<li>コントロール変数に関する欠落変数バイアスを考慮する必要はない。</li>
<li>コントロール変数の係数は一致推定できず、係数の解釈は困難である（符号条件などが直感に反する結果でも気にする必要はない）。</li>
</ul>
</div>
<div id="興味のある説明変数の影響の解釈が変わりうるか" class="section level4 unnumbered hasAnchor">
<h4>2. 興味のある説明変数の影響の解釈が変わりうるか<a href="線形回帰.html#興味のある説明変数の影響の解釈が変わりうるか" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>重回帰分析では、モデルにどの変数を入れるかによって、係数の解釈が変わりえます。特に、<u>興味ある説明変数が被説明変数に影響を与える経路の中間にある変数（<strong>中間経路の変数</strong>）をモデルに含めると、係数が本来の研究対象とは異なる解釈を持つ可能性があります</u>。これを<strong>過剰制御</strong>と呼びます。</p>
<p>例えば、被説明変数を賃金、興味がある説明変数を教育として、教育が賃金に与える影響を分析する場合を考えます。ここで、変数として職業を入れると、職業は教育が賃金に影響を与える経路の中間に位置します。この時、教育の係数は、職業を固定した場合に教育の変化が賃金に与える影響を表すと解釈できますが、教育の変化は職業の変化を通じて賃金にも影響すると想定されるため、教育の係数は教育が賃金に与える影響すべてを捉えることができなくなります。</p>
</div>
<div id="推定量の分散を小さくできるか" class="section level4 unnumbered hasAnchor">
<h4>3. 推定量の分散を小さくできるか<a href="線形回帰.html#推定量の分散を小さくできるか" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>重回帰モデルに変数を追加する場合、<u>興味がある説明変数と相関している変数を追加すると、興味がある説明変数の係数の推定精度が悪化</u>します。一方で、<u>被説明変数に影響を与える変数を追加すると、モデルの推定誤差が改善</u>します。このように、変数の追加にはトレードオフがあります。</p>
</div>
<div id="のどの基準を優先すべきか" class="section level4 unnumbered hasAnchor">
<h4>1～3のどの基準を優先すべきか<a href="線形回帰.html#のどの基準を優先すべきか" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><u>重回帰分析をどのような目的で用いるかによって、変数選択の際に優先すべき基準が変化</u>します。</p>
<p><strong>興味がある説明変数の係数を推定する場合</strong>：　欠落変数バイアスの回避（1）と、説明変数の影響の解釈（2）を優先すべきで、推定量の分散（3）は副次的な問題になります。</p>
<p><strong>被説明変数の予測を行う場合</strong>：　モデルの推定誤差を減少させること（3）を優先すべきで、欠落変数バイアスの回避（1）や、説明変数の影響の解釈（2）は副次的な問題になります。</p>
</div>
</div>
</div>
<div id="rの単回帰モデル推定" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Rの単回帰モデル推定<a href="線形回帰.html#rの単回帰モデル推定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>線形単回帰モデル<span class="math inline">\(Y = \beta_0 + \beta_1 X + u\)</span>を最小2乗法で推定するには、<code>stats</code>パッケージの<code>lm()</code>関数で<code>formula</code>引数を<code>Y ~ X</code>と設定します。</p>
<p><code>lm()</code>関数が返すオブジェクトを<code>summary()</code>関数で出力すると、係数の推定値、標準誤差、t値、p値、信頼区間の下限・上限値、決定係数、F検定の結果が表示されます。なお、<code>lm()</code>関数が計算する標準誤差は均一分散を仮定した標準誤差であり、不均一分散に頑健な標準誤差（HC・ホワイトの標準誤差）や、不均一分散と自己相関に頑健な標準誤差（HAC・ニューウィー＝ウェストの標準誤差）ではないことに注意してください。</p>
<p>ホワイトの標準誤差やニューウィー＝ウェストの標準誤差で係数の仮説検定を行うには、<code>lmtest</code>パッケージの<code>coeftest()</code>関数と、<code>sandwich</code>パッケージの<code>vcovHC()</code>関数、<code>NeweyWest()</code>関数を使用します。</p>
<p><code>vcovHC()</code>関数では<code>type</code>引数に<code>const</code>を指定すると通常の均一分散を仮定した標準偏差が、<code>HC0</code>を指定するとホワイトの標準誤差が出力されます。また、<code>HC1</code>を指定するとSTATAの<code>vce(robust)</code>と同じ結果が出力され、西山 他（2019）実証例4.1でもこの標準誤差が記載されています。先行研究では線形回帰のシミュレーションに基づき<code>HC3</code>（<code>vcovHC()</code>関数のデフォルト値）、<code>HC4</code>、<code>HC5</code>の使用が推奨されています。</p>
<p>その他に、<code>estimatr</code>パッケージの<code>lm_robust()</code>関数でもホワイトの標準誤差を用いた仮説検定を行うことができます。<code>lm_robust()</code>関数の<code>se_type</code>引数に<code>HC1</code>を指定するとホワイトの標準誤差が計算されます。<code>stats::lm()</code>関数と<code>estimatr::lm_robust()</code>関数の違いについては<a href="https://speakerdeck.com/dropout009/tokyor100">TokyoRの森下光之助氏のスライド</a>を、<code>estimatr::lm_robust()</code>関数の数学的な説明は<a href="https://declaredesign.org/r/estimatr/articles/mathematical-notes.html#lm_robust-notes">公式ウェブサイト</a>を参照してください。</p>
<div id="実証例-西山-4.1-線形単回帰" class="section level3 unnumbered hasAnchor">
<h3>実証例 西山 4.1 線形単回帰<a href="線形回帰.html#実証例-西山-4.1-線形単回帰" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>西山 他（2019）P.128～129の実証例4.1のデータを用い、実質賃金（wage）を被説明変数、労働生産性（productivity）を説明変数として、線形単回帰モデルを推定します。標準誤差は不均一分散に対して頑健な標準誤差（ホワイトの標準誤差）を使用します。</p>
<p>推定結果は、<span class="math inline">\(実質賃金の推定量 = 276.13 + 0.55\,労働生産性\)</span> を意味しており、定数項と労働生産性の係数はどちらもp値が0.05より小さく、有意水準5％で帰無仮説が棄却されます。この結果から、統計的には労働生産性が100円上昇すると賃金が55円上がる傾向があると解釈できます。</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="線形回帰.html#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CSVデータを読み込み</span></span>
<span id="cb602-2"><a href="線形回帰.html#cb602-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">&quot;data_nishiyama/ch04/ch04_wage.csv&quot;</span>,</span>
<span id="cb602-3"><a href="線形回帰.html#cb602-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb602-4"><a href="線形回帰.html#cb602-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col_types =</span> <span class="st">&quot;ddd&quot;</span>,</span>
<span id="cb602-5"><a href="線形回帰.html#cb602-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip =</span> <span class="dv">0</span></span>
<span id="cb602-6"><a href="線形回帰.html#cb602-6" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb602-7"><a href="線形回帰.html#cb602-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb602-8"><a href="線形回帰.html#cb602-8" aria-hidden="true" tabindex="-1"></a><span class="co"># GGally::ggpairs()関数でペアプロットを出力</span></span>
<span id="cb602-9"><a href="線形回帰.html#cb602-9" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb602-10"><a href="線形回帰.html#cb602-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(productivity, wage) <span class="sc">%&gt;%</span> </span>
<span id="cb602-11"><a href="線形回帰.html#cb602-11" aria-hidden="true" tabindex="-1"></a>  GGally<span class="sc">::</span><span class="fu">ggpairs</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-284-1.png" width="672" /></p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb603-1"><a href="線形回帰.html#cb603-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stats::lm()関数でwageをproductivityに回帰</span></span>
<span id="cb603-2"><a href="線形回帰.html#cb603-2" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(<span class="at">formula =</span> wage <span class="sc">~</span> productivity, </span>
<span id="cb603-3"><a href="線形回帰.html#cb603-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data</span>
<span id="cb603-4"><a href="線形回帰.html#cb603-4" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb603-5"><a href="線形回帰.html#cb603-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb603-6"><a href="線形回帰.html#cb603-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 回帰した結果を出力</span></span>
<span id="cb603-7"><a href="線形回帰.html#cb603-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = wage ~ productivity, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -47.618 -17.612   4.186  21.946  37.052 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  276.12961   87.61057   3.152  0.00525 ** 
## productivity   0.54682    0.02442  22.395 4.04e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 25.77 on 19 degrees of freedom
## Multiple R-squared:  0.9635, Adjusted R-squared:  0.9616 
## F-statistic: 501.5 on 1 and 19 DF,  p-value: 4.037e-15</code></pre>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="線形回帰.html#cb605-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ホワイトの標準誤差で係数の仮説検定を実施</span></span>
<span id="cb605-2"><a href="線形回帰.html#cb605-2" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(lm_model,</span>
<span id="cb605-3"><a href="線形回帰.html#cb605-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(lm_model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##                Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)  276.129607  71.255590  3.8752  0.001019 ** 
## productivity   0.546820   0.020463 26.7223 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="線形回帰.html#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 回帰した結果をデータフレーム形式で出力する場合</span></span>
<span id="cb607-2"><a href="線形回帰.html#cb607-2" aria-hidden="true" tabindex="-1"></a>estimatr<span class="sc">::</span><span class="fu">tidy</span>(lm_model)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   term         estimate std.error statistic  p.value
##   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)   276.      87.6         3.15 5.25e- 3
## 2 productivity    0.547    0.0244     22.4  4.04e-15</code></pre>
</div>
<div id="実証例-西山-4.1-回帰診断プロット" class="section level3 unnumbered hasAnchor">
<h3>実証例 西山 4.1 回帰診断プロット<a href="線形回帰.html#実証例-西山-4.1-回帰診断プロット" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>実証例4.1で推定した線形単回帰モデルの結果を視覚的に検証するには、<code>lm()</code>関数で出力したモデルオブジェクトに対し<code>plot()</code>関数を適用し、回帰診断プロットを表示します。</p>
<p>回帰診断プロットでは推定した残差の動きを確認し、外れ値の有無やモデルの妥当性を判断します。</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="線形回帰.html#cb609-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 作図環境設定関数で2行2列の図表配置を指定</span></span>
<span id="cb609-2"><a href="線形回帰.html#cb609-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb609-3"><a href="線形回帰.html#cb609-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb609-4"><a href="線形回帰.html#cb609-4" aria-hidden="true" tabindex="-1"></a><span class="co"># lm()関数で推定した結果をplot()関数で可視化</span></span>
<span id="cb609-5"><a href="線形回帰.html#cb609-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> wage <span class="sc">~</span> productivity,</span>
<span id="cb609-6"><a href="線形回帰.html#cb609-6" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data</span>
<span id="cb609-7"><a href="線形回帰.html#cb609-7" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">%&gt;%</span> </span>
<span id="cb609-8"><a href="線形回帰.html#cb609-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-286-1.png" width="672" /></p>
<p><strong>Residual vs Fitted</strong>：横軸に予測値、縦軸に残差をとった散布図です。赤色の実線は回帰曲線を示しています。図中の数字はデータの行番号であり、数字が表示されている点は残差の絶対値が大きいことを意味します。この図は、残差の全体像を把握し、残差の独立性や系列相関の有無を検証するために用います。特に、予測値に対する点の分布が一様でなく、曲線的な傾向になっている場合は、説明変数と被説明変数の関係が線形ではない可能性が疑われます。</p>
<p><strong>Normal Q-Q</strong>：横軸に標準正規分布の累積分布関数の分位点、縦軸に標準化した残差を大きさの順に並べたものの分位点をとったQQ（Quantile-Quantile）プロットです。残差が正規分布に従っているかどうかを検証します。データが直線上にある場合は、残差が正規分布に従っていることを意味します。</p>
<p><strong>Scale-Location</strong>：横軸に予測値、縦軸に残差の絶対値の平方根をとった散布図です。予測値に対する点の分布が一様でなく、増加または減少する傾向がある場合は、誤差項の均一分散の仮定が成立していないと考えられます。</p>
<p><strong>Residuals vs Leverage</strong>：横軸に梃子（てこ）値、縦軸に標準化した残差をとった散布図です。個々のデータが回帰係数の推定値へ与える影響度を判断します。赤色の点線は<strong>クック距離（Cook’s distance）</strong>と呼ばれ、特定のデータをモデルに含む場合と含まない場合で予測値がどれだけ変化するかを示します。クック距離が大きいと（一般的には0.5を超える場合）、そのデータが外れ値である可能性が高いと考えられます。</p>
</div>
<div id="対数変化率モデルの推定" class="section level3 unnumbered hasAnchor">
<h3>対数・変化率モデルの推定<a href="線形回帰.html#対数変化率モデルの推定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>実証例4.1のデータセットを利用して、両辺が自然対数のモデル、両辺が対数階差変化率のモデル、両辺が変化率のモデルを推定します。</p>
<p>自然対数は<code>log()</code>関数で計算します。対数階差変化率は対数変換した値に<code>tidyquant::CHANGE()</code>関数を適用して対数階差を計算します。変化率は<code>tidyquant::PCT_CHANGE()</code>関数で求めることができます。</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="線形回帰.html#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 自然対数、対数階差変化率、変化率を計算</span></span>
<span id="cb610-2"><a href="線形回帰.html#cb610-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb610-3"><a href="線形回帰.html#cb610-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ln_wage =</span> <span class="fu">log</span>(wage),</span>
<span id="cb610-4"><a href="線形回帰.html#cb610-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">ln_productivity =</span> <span class="fu">log</span>(productivity),</span>
<span id="cb610-5"><a href="線形回帰.html#cb610-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">dlog_wage =</span> <span class="dv">100</span> <span class="sc">*</span> tidyquant<span class="sc">::</span><span class="fu">CHANGE</span>(ln_wage),</span>
<span id="cb610-6"><a href="線形回帰.html#cb610-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">dlog_productivity =</span> <span class="dv">100</span> <span class="sc">*</span> tidyquant<span class="sc">::</span><span class="fu">CHANGE</span>(ln_productivity),</span>
<span id="cb610-7"><a href="線形回帰.html#cb610-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">pch_wage =</span> <span class="dv">100</span> <span class="sc">*</span> tidyquant<span class="sc">::</span><span class="fu">PCT_CHANGE</span>(wage),</span>
<span id="cb610-8"><a href="線形回帰.html#cb610-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">pch_productivity =</span> <span class="dv">100</span> <span class="sc">*</span> tidyquant<span class="sc">::</span><span class="fu">PCT_CHANGE</span>(productivity)</span>
<span id="cb610-9"><a href="線形回帰.html#cb610-9" aria-hidden="true" tabindex="-1"></a>                )</span></code></pre></div>
<p>対数モデルにおける労働生産性の係数0.874は、労働生産性が1％変化すると実質賃金が0.874％変化することを示しています（弾性値）。また、同係数のp値は0.05を下回っており、統計的に有意であるといえます。</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="線形回帰.html#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 対数モデル</span></span>
<span id="cb611-2"><a href="線形回帰.html#cb611-2" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(<span class="at">formula =</span> ln_wage <span class="sc">~</span> ln_productivity,</span>
<span id="cb611-3"><a href="線形回帰.html#cb611-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data</span>
<span id="cb611-4"><a href="線形回帰.html#cb611-4" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb611-5"><a href="線形回帰.html#cb611-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-6"><a href="線形回帰.html#cb611-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = ln_wage ~ ln_productivity, data = data)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.021358 -0.007777  0.001910  0.009589  0.016859 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      0.55758    0.31276   1.783   0.0906 .  
## ln_productivity  0.87424    0.03823  22.869 2.75e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.01138 on 19 degrees of freedom
## Multiple R-squared:  0.9649, Adjusted R-squared:  0.9631 
## F-statistic:   523 on 1 and 19 DF,  p-value: 2.748e-15</code></pre>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="線形回帰.html#cb613-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(lm_model,</span>
<span id="cb613-2"><a href="線形回帰.html#cb613-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(lm_model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      0.55758    0.26022  2.1427   0.0453 *  
## ln_productivity  0.87424    0.03191 27.3970   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>対数階差変化率は変化率の近似値なので、対数階差変化率モデルと変化率モデルはほぼ同じ推定結果になります。労働生産性の係数のp値はどちらも0.05を上回っており、有意ではありません。</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="線形回帰.html#cb615-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 対数階差変化率モデル</span></span>
<span id="cb615-2"><a href="線形回帰.html#cb615-2" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(<span class="at">formula =</span> dlog_wage <span class="sc">~</span> dlog_productivity,</span>
<span id="cb615-3"><a href="線形回帰.html#cb615-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data,</span>
<span id="cb615-4"><a href="線形回帰.html#cb615-4" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb615-5"><a href="線形回帰.html#cb615-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb615-6"><a href="線形回帰.html#cb615-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = dlog_wage ~ dlog_productivity, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4550 -0.6120 -0.1980  0.7568  1.7000 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)         0.7637     0.2642   2.890  0.00975 **
## dlog_productivity   0.2251     0.1469   1.532  0.14286   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9659 on 18 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.1154, Adjusted R-squared:  0.06623 
## F-statistic: 2.348 on 1 and 18 DF,  p-value: 0.1429</code></pre>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="線形回帰.html#cb617-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(lm_model,</span>
<span id="cb617-2"><a href="線形回帰.html#cb617-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(lm_model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##                   Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)        0.76371    0.29002  2.6333  0.01687 *
## dlog_productivity  0.22506    0.17911  1.2566  0.22497  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="線形回帰.html#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 変化率モデル</span></span>
<span id="cb619-2"><a href="線形回帰.html#cb619-2" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(<span class="at">formula =</span> pch_wage <span class="sc">~</span> pch_productivity,</span>
<span id="cb619-3"><a href="線形回帰.html#cb619-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data,</span>
<span id="cb619-4"><a href="線形回帰.html#cb619-4" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb619-5"><a href="線形回帰.html#cb619-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-6"><a href="線形回帰.html#cb619-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = pch_wage ~ pch_productivity, data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.4699 -0.6224 -0.2023  0.7606  1.7141 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)        0.7725     0.2682   2.881  0.00995 **
## pch_productivity   0.2225     0.1476   1.507  0.14906   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9774 on 18 degrees of freedom
##   (1 observation deleted due to missingness)
## Multiple R-squared:  0.1121, Adjusted R-squared:  0.06276 
## F-statistic: 2.272 on 1 and 18 DF,  p-value: 0.1491</code></pre>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb621-1"><a href="線形回帰.html#cb621-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(lm_model,</span>
<span id="cb621-2"><a href="線形回帰.html#cb621-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(lm_model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##                  Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)       0.77250    0.29402  2.6274  0.01708 *
## pch_productivity  0.22252    0.18008  1.2357  0.23247  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</div>
<div id="rの重回帰モデル推定" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Rの重回帰モデル推定<a href="線形回帰.html#rの重回帰モデル推定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>重回帰モデルも、単回帰モデルと同様に<code>stats</code>パッケージの<code>lm()</code>関数で推定します。重回帰モデルの場合は、<code>formula</code>引数に<code>Y ~ X1 + X2</code>といった形で複数の説明変数を設定します。</p>
<div id="実証例-西山-5.15.4-線形重回帰" class="section level3 unnumbered hasAnchor">
<h3>実証例 西山 5.1・5.4 線形重回帰<a href="線形回帰.html#実証例-西山-5.15.4-線形重回帰" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>西山 他（2019）P.151～152の都道府県別データを用い、信頼関係の強さと規範意識が経済成長に与える影響を、教育水準と初期時点での豊かさをコントロールして推定します。使用する変数は次の通りです。詳細は、西山 他（2019）第5章の9節（P.191）と補論A（P.203）を参照してください。</p>
<ul>
<li>y80：　1980年時点の人口1人当たりGDP（100万円）</li>
<li>y99：　1999年時点の人口1人当たりGDP（100万円）</li>
<li>trust80：　1980年時点の信頼関係の強さ（標準化した値）</li>
<li>norm80：　1980年時点の規範意識の強さ（標準化した値）</li>
<li>education80：　1980年時点の教育水準（標準化した値）</li>
<li>did：　人口集中地区に居住する人口の割合</li>
</ul>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="線形回帰.html#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CSVデータを読み込み</span></span>
<span id="cb623-2"><a href="線形回帰.html#cb623-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">&quot;data_nishiyama/ch05/youdou.csv&quot;</span>,</span>
<span id="cb623-3"><a href="線形回帰.html#cb623-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb623-4"><a href="線形回帰.html#cb623-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col_types =</span> <span class="cn">NULL</span>,</span>
<span id="cb623-5"><a href="線形回帰.html#cb623-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip =</span> <span class="dv">0</span></span>
<span id="cb623-6"><a href="線形回帰.html#cb623-6" aria-hidden="true" tabindex="-1"></a>                        )</span></code></pre></div>
<pre><code>## Rows: 47 Columns: 23
## ── Column specification ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (22): id, y80, y90, y99, education80, trust80, trust96, norm80, norm96, ...
## lgl  (1): X
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="線形回帰.html#cb625-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 西山 他（2019）P.143～144に従い、各都道府県の人口1人当たりGDPの年平均経済成長率を計算</span></span>
<span id="cb625-2"><a href="線形回帰.html#cb625-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb625-3"><a href="線形回帰.html#cb625-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ln_y80 =</span> <span class="fu">log</span>(y80),</span>
<span id="cb625-4"><a href="線形回帰.html#cb625-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">ln_y99 =</span> <span class="fu">log</span>(y99),</span>
<span id="cb625-5"><a href="線形回帰.html#cb625-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">gr_80_99 =</span> <span class="dv">100</span> <span class="sc">*</span> (ln_y99 <span class="sc">-</span> ln_y80) <span class="sc">/</span> <span class="dv">19</span></span>
<span id="cb625-6"><a href="線形回帰.html#cb625-6" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb625-7"><a href="線形回帰.html#cb625-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-8"><a href="線形回帰.html#cb625-8" aria-hidden="true" tabindex="-1"></a><span class="co"># GGally::ggpairs()関数でペアプロットを出力</span></span>
<span id="cb625-9"><a href="線形回帰.html#cb625-9" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb625-10"><a href="線形回帰.html#cb625-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(gr_80_99, trust80, norm80, education80, ln_y80, ln_y99, did) <span class="sc">%&gt;%</span> </span>
<span id="cb625-11"><a href="線形回帰.html#cb625-11" aria-hidden="true" tabindex="-1"></a>  GGally<span class="sc">::</span><span class="fu">ggpairs</span>(<span class="at">progress =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-291-1.png" width="672" /></p>
<p>まず、1980～1999年の年平均経済成長率を、信頼関係の強さと規範意識それぞれで説明する単回帰モデルを推定します。</p>
<p>これらモデルは、信頼関係の強さと規範意識の係数のp値がともに0.05より小さく、係数が有意であることを示しています。</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="線形回帰.html#cb626-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> trust80,</span>
<span id="cb626-2"><a href="線形回帰.html#cb626-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data,</span>
<span id="cb626-3"><a href="線形回帰.html#cb626-3" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb626-4"><a href="線形回帰.html#cb626-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb626-5"><a href="線形回帰.html#cb626-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = gr_80_99 ~ trust80, data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.68018 -0.29900 -0.00955  0.34100  0.80625 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.13936    0.06002  52.305  &lt; 2e-16 ***
## trust80      0.22468    0.07172   3.133  0.00304 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4112 on 45 degrees of freedom
## Multiple R-squared:  0.179,  Adjusted R-squared:  0.1608 
## F-statistic: 9.813 on 1 and 45 DF,  p-value: 0.003045</code></pre>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="線形回帰.html#cb628-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(lm_model,</span>
<span id="cb628-2"><a href="線形回帰.html#cb628-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(lm_model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##             Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept) 3.139355   0.060438 51.9434 &lt; 2.2e-16 ***
## trust80     0.224683   0.066402  3.3837  0.001491 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="線形回帰.html#cb630-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> norm80,</span>
<span id="cb630-2"><a href="線形回帰.html#cb630-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data,</span>
<span id="cb630-3"><a href="線形回帰.html#cb630-3" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb630-4"><a href="線形回帰.html#cb630-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb630-5"><a href="線形回帰.html#cb630-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = gr_80_99 ~ norm80, data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.96828 -0.15563 -0.03077  0.23198  0.61507 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.09054    0.04966  62.236  &lt; 2e-16 ***
## norm80       0.55973    0.09109   6.145  1.9e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3346 on 45 degrees of freedom
## Multiple R-squared:  0.4563, Adjusted R-squared:  0.4442 
## F-statistic: 37.76 on 1 and 45 DF,  p-value: 1.902e-07</code></pre>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="線形回帰.html#cb632-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(lm_model,</span>
<span id="cb632-2"><a href="線形回帰.html#cb632-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(lm_model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##             Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept) 3.090543   0.048265 64.0330 &lt; 2.2e-16 ***
## norm80      0.559733   0.070578  7.9307 4.348e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>次に、説明変数に、教育水準と、豊かさの代理変数として1980年時点の対数GDP水準を追加した重回帰モデルを推定します。</p>
<p>信頼関係の強さの係数の推定値は、単回帰モデルの0.22から0.02へと大幅に低下していることが確認できます。単回帰モデルでは、教育水準や豊かさが経済成長率に与える影響が、誤って信頼関係の強さの影響として推定されていた可能性が示唆されます。また、信頼関係の強さの係数のp値は0.79と大きく、係数は有意ではありません。</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="線形回帰.html#cb634-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> trust80 <span class="sc">+</span> education80 <span class="sc">+</span> ln_y80,</span>
<span id="cb634-2"><a href="線形回帰.html#cb634-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data,</span>
<span id="cb634-3"><a href="線形回帰.html#cb634-3" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb634-4"><a href="線形回帰.html#cb634-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb634-5"><a href="線形回帰.html#cb634-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = gr_80_99 ~ trust80 + education80 + ln_y80, 
##     data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.45839 -0.21925 -0.00947  0.13042  1.03231 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  6.04885    0.48340  12.513 6.31e-16 ***
## trust80      0.02058    0.07066   0.291    0.772    
## education80  2.61208    2.25858   1.157    0.254    
## ln_y80      -2.38309    0.46001  -5.180 5.59e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3073 on 43 degrees of freedom
## Multiple R-squared:  0.5619, Adjusted R-squared:  0.5313 
## F-statistic: 18.38 on 3 and 43 DF,  p-value: 7.983e-08</code></pre>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="線形回帰.html#cb636-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(lm_model,</span>
<span id="cb636-2"><a href="線形回帰.html#cb636-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(lm_model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##              Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)  6.048849   0.426429 14.1849 &lt; 2.2e-16 ***
## trust80      0.020585   0.075639  0.2721    0.7868    
## education80  2.612075   2.708569  0.9644    0.3403    
## ln_y80      -2.383094   0.491469 -4.8489 1.658e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>一方、規範意識の係数の推定値は重回帰モデルでも0.34と小さくなく、経済学的に意味のある結果（規範意識は経済成長率にとって重要な要素）であると考えられます。また係数のp値は0.018と、有意水準5％で統計的に有意であるといえます。</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="線形回帰.html#cb638-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> norm80 <span class="sc">+</span> education80 <span class="sc">+</span> ln_y80,</span>
<span id="cb638-2"><a href="線形回帰.html#cb638-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data,</span>
<span id="cb638-3"><a href="線形回帰.html#cb638-3" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb638-4"><a href="線形回帰.html#cb638-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb638-5"><a href="線形回帰.html#cb638-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = gr_80_99 ~ norm80 + education80 + ln_y80, 
##     data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.49006 -0.20688 -0.00209  0.14005  0.69585 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.2909     0.4838  10.935 5.34e-14 ***
## norm80        0.3383     0.1109   3.051   0.0039 ** 
## education80   4.3872     2.0275   2.164   0.0361 *  
## ln_y80       -1.9911     0.4340  -4.588 3.85e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2789 on 43 degrees of freedom
## Multiple R-squared:  0.6391, Adjusted R-squared:  0.614 
## F-statistic: 25.39 on 3 and 43 DF,  p-value: 1.31e-09</code></pre>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="線形回帰.html#cb640-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(lm_model,</span>
<span id="cb640-2"><a href="線形回帰.html#cb640-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(lm_model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##             Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)  5.29087    0.66824  7.9176 6.204e-10 ***
## norm80       0.33827    0.13698  2.4695  0.017578 *  
## education80  4.38724    1.96109  2.2371  0.030513 *  
## ln_y80      -1.99114    0.57457 -3.4654  0.001213 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="実証例-西山-5.5-多項式モデル" class="section level3 unnumbered hasAnchor">
<h3>実証例 西山 5.5 多項式モデル<a href="線形回帰.html#実証例-西山-5.5-多項式モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1980～1999年の年平均経済成長率を、1980年時点のGDP水準（対数をとらない値）の2次多項式で説明するモデルを推定します（西山 他（2019）P.170）。</p>
<p>2乗の項は、あらかじめ<code>dplyr::mutate()</code>関数などを使用して計算しておくか、もしくは<code>I(変数 ^ 2)</code>として<code>lm()</code>関数の回帰式に含めます。</p>
<p>推定結果は、1980年時点GDPの項、その2乗項ともに係数のp値が0.05より大きく、有意ではありません。ただし、それだけでは1980年時点GDPが経済成長率に影響を与えるかどうかは判断できません。判断するためには、1980年時点GDPの項と2乗項の係数がどちらも同時にゼロであるという<strong>結合仮説</strong>をF検定する必要があります。</p>
<p>推定結果においてF検定のp値をみると0.05より小さく、「1980年時点GDPの項と2乗項の係数がどちらも同時にゼロ（＝1980年時点GDPの影響はない）」という帰無仮説が5％有意水準で棄却されます。</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="線形回帰.html#cb642-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> y80 <span class="sc">+</span> <span class="fu">I</span>(y80 <span class="sc">^</span> <span class="dv">2</span>),</span>
<span id="cb642-2"><a href="線形回帰.html#cb642-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data,</span>
<span id="cb642-3"><a href="線形回帰.html#cb642-3" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb642-4"><a href="線形回帰.html#cb642-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb642-5"><a href="線形回帰.html#cb642-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = gr_80_99 ~ y80 + I(y80^2), data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.46772 -0.24882 -0.02486  0.15161  0.96513 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  6.51866    1.46508   4.449  5.8e-05 ***
## y80         -1.22615    0.73163  -1.676    0.101    
## I(y80^2)     0.08935    0.08953   0.998    0.324    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3077 on 44 degrees of freedom
## Multiple R-squared:  0.5503, Adjusted R-squared:  0.5299 
## F-statistic: 26.93 on 2 and 44 DF,  p-value: 2.308e-08</code></pre>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="線形回帰.html#cb644-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(lm_model,</span>
<span id="cb644-2"><a href="線形回帰.html#cb644-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(lm_model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##              Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)  6.518664   1.385378  4.7053 2.535e-05 ***
## y80         -1.226154   0.707909 -1.7321   0.09027 .  
## I(y80^2)     0.089351   0.088612  1.0083   0.31880    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>なお、推定結果から、限界効果は<span class="math inline">\(-1.226 + 2 \times0.089 \times 1980年時点GDP\)</span>と計算できます。平均限界効果は、1980年時点GDPの平均値が3.876なので、<span class="math inline">\(-1.226 + 2 \times0.089 \times 3.876 \approx -0.536\)</span>となります。</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="線形回帰.html#cb646-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 平均限界効果の計算</span></span>
<span id="cb646-2"><a href="線形回帰.html#cb646-2" aria-hidden="true" tabindex="-1"></a>lm_model<span class="sc">$</span>coefficients[<span class="st">&quot;y80&quot;</span>] <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> lm_model<span class="sc">$</span>coefficients[<span class="st">&quot;I(y80^2)&quot;</span>] <span class="sc">*</span> <span class="fu">mean</span>(data<span class="sc">$</span>y80)</span></code></pre></div>
<pre><code>##        y80 
## -0.5335568</code></pre>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="線形回帰.html#cb648-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 多項式モデルを推定した回帰曲線をプロット</span></span>
<span id="cb648-2"><a href="線形回帰.html#cb648-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb648-3"><a href="線形回帰.html#cb648-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fitted =</span> lm_model<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span> </span>
<span id="cb648-4"><a href="線形回帰.html#cb648-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb648-5"><a href="線形回帰.html#cb648-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> y80, <span class="at">y =</span> gr_80_99)) <span class="sc">+</span></span>
<span id="cb648-6"><a href="線形回帰.html#cb648-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> y80, <span class="at">y =</span> fitted))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-298-1.png" width="672" /></p>
</div>
<div id="実証例-西山-5.6-ダミー交互作用モデル" class="section level3 unnumbered hasAnchor">
<h3>実証例 西山 5.6 ダミー・交互作用モデル<a href="線形回帰.html#実証例-西山-5.6-ダミー交互作用モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1980～1999年の年平均経済成長率を、1980年時点の対数GDP水準で説明するモデルに、切片ダミー変数と傾きダミー変数を追加します（西山 他（2019）P.173）。</p>
<p>追加するダミー変数は、人口集中地区に居住する割合を示す変数（<code>did</code>）が0.4より大きいときに1をとる都市化ダミー<code>dummy_1</code>です。</p>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="線形回帰.html#cb649-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 都市化ダミー変数を追加</span></span>
<span id="cb649-2"><a href="線形回帰.html#cb649-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb649-3"><a href="線形回帰.html#cb649-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dummy_1 =</span> <span class="dv">1</span> <span class="sc">*</span> (did <span class="sc">&gt;</span> <span class="fl">0.4</span>))</span></code></pre></div>
<p>傾きダミー変数と1980年時点の対数GDP水準の交差項は、<code>dummy * ln_y80</code>として<code>lm()</code>関数の回帰式に含めます。</p>
<p>推定結果をみると、切片ダミーの係数は-0.176、傾きダミーの係数は0.064となっていますが、p値はどちらも0.05より大きく有意ではありません。</p>
<p>なお、1980年時点の対数GDP水準の係数-1.911は、1980年時点のGDPが1％増加すると、1980～1999年の年平均経済成長率が1.911％ポイント低下することを意味しています。</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="線形回帰.html#cb650-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> dummy_1 <span class="sc">+</span> ln_y80 <span class="sc">+</span> dummy_1 <span class="sc">*</span> ln_y80,</span>
<span id="cb650-2"><a href="線形回帰.html#cb650-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data,</span>
<span id="cb650-3"><a href="線形回帰.html#cb650-3" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb650-4"><a href="線形回帰.html#cb650-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb650-5"><a href="線形回帰.html#cb650-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = gr_80_99 ~ dummy_1 + ln_y80 + dummy_1 * ln_y80, 
##     data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.51040 -0.21003 -0.02406  0.16516  0.90189 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     5.74905    0.57763   9.953 9.96e-13 ***
## dummy_1        -0.17551    0.82444  -0.213 0.832421    
## ln_y80         -1.91120    0.45104  -4.237 0.000117 ***
## dummy_1:ln_y80  0.06441    0.61108   0.105 0.916546    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3092 on 43 degrees of freedom
## Multiple R-squared:  0.5564, Adjusted R-squared:  0.5254 
## F-statistic: 17.98 on 3 and 43 DF,  p-value: 1.041e-07</code></pre>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="線形回帰.html#cb652-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(lm_model,</span>
<span id="cb652-2"><a href="線形回帰.html#cb652-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(lm_model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##                Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)     5.74906    0.80190  7.1692 7.325e-09 ***
## dummy_1        -0.17551    0.94977 -0.1848  0.854258    
## ln_y80         -1.91120    0.65454 -2.9199  0.005554 ** 
## dummy_1:ln_y80  0.06441    0.74806  0.0861  0.931785    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="実証例-西山-5.7-ダミー変数同士の交互作用モデル" class="section level3 unnumbered hasAnchor">
<h3>実証例 西山 5.7 ダミー変数同士の交互作用モデル<a href="線形回帰.html#実証例-西山-5.7-ダミー変数同士の交互作用モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1980～1999年の年平均経済成長率を、実証例5.6で作成した都市化ダミー変数<code>dummy_1</code>と、1980年時点の対数GDP水準が1.4より大きい場合に1をとる豊かさダミー変数<code>dummy_2</code>で説明するモデルを推定します（西山 他（2019）P.175）。</p>
<p>2つのダミー変数同士の交差項を含む交互作用モデルは、この2つのダミー変数で標本を4つに分け、それぞれの標本平均を計算する場合と同じ結果になります。ここで、</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1D1_i + \beta_2D2_i + \beta_3D1_iD2_i + u_i
\]</span></p>
<p>とし、<span class="math inline">\(D1_i = 0\)</span>かつ<span class="math inline">\(D2_i = 0\)</span>である観測値の標本平均を<span class="math inline">\(\overline{Y}_{00}\)</span>、同様に<span class="math inline">\(\overline{Y}_{01}\)</span>、<span class="math inline">\(\overline{Y}_{10}\)</span>、<span class="math inline">\(\overline{Y}_{11}\)</span>とすると、推計結果を用い、</p>
<p><span class="math display">\[
\begin{aligned}
\overline{Y}_{00} &amp;= \hat{\beta}_0 = 3.455 \\
\overline{Y}_{10} &amp;= \hat{\beta}_0 + \hat{\beta}_1 = 3.222 \\
\overline{Y}_{01} &amp;= \hat{\beta}_0 + \hat{\beta}_2 = 2.875 \\
\overline{Y}_{11} &amp;= \hat{\beta}_0 + \hat{\beta}_1 + \hat{\beta}_2 + \hat{\beta}_3 = 2.689
\end{aligned}
\]</span></p>
<p>と計算できます。この結果は、都市化率が低く（<span class="math inline">\(dummy_1 = 0\)</span>）、1980年時点のGDPが小さい（<span class="math inline">\(dummy_2 = 0\)</span>）場合に、平均経済成長率が高い傾向があることを示唆しています。</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="線形回帰.html#cb654-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 豊かさダミー変数を追加</span></span>
<span id="cb654-2"><a href="線形回帰.html#cb654-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb654-3"><a href="線形回帰.html#cb654-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dummy_2 =</span> <span class="dv">1</span> <span class="sc">*</span> (ln_y80 <span class="sc">&gt;</span> <span class="fl">1.4</span>))</span></code></pre></div>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="線形回帰.html#cb655-1" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">lm</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> dummy_1 <span class="sc">+</span> dummy_2 <span class="sc">+</span> dummy_1 <span class="sc">*</span> dummy_2,</span>
<span id="cb655-2"><a href="線形回帰.html#cb655-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> data,</span>
<span id="cb655-3"><a href="線形回帰.html#cb655-3" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb655-4"><a href="線形回帰.html#cb655-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb655-5"><a href="線形回帰.html#cb655-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = gr_80_99 ~ dummy_1 + dummy_2 + dummy_1 * 
##     dummy_2, data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.50919 -0.25376 -0.01148  0.24475  0.85353 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      3.45474    0.07544  45.793  &lt; 2e-16 ***
## dummy_1         -0.23329    0.12459  -1.872 0.067953 .  
## dummy_2         -0.58003    0.15400  -3.767 0.000498 ***
## dummy_1:dummy_2  0.04725    0.20827   0.227 0.821596    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3288 on 43 degrees of freedom
## Multiple R-squared:  0.4982, Adjusted R-squared:  0.4631 
## F-statistic: 14.23 on 3 and 43 DF,  p-value: 1.401e-06</code></pre>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="線形回帰.html#cb657-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(lm_model,</span>
<span id="cb657-2"><a href="線形回帰.html#cb657-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vcov. =</span> sandwich<span class="sc">::</span><span class="fu">vcovHC</span>(lm_model, <span class="at">type =</span> <span class="st">&quot;HC1&quot;</span>))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##                  Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)      3.454739   0.074531 46.3533 &lt; 2.2e-16 ***
## dummy_1         -0.233289   0.112116 -2.0808  0.043445 *  
## dummy_2         -0.580030   0.200571 -2.8919  0.005985 ** 
## dummy_1:dummy_2  0.047252   0.235254  0.2009  0.841761    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="探索的データ分析.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="時系列データ操作.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlights": true
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
