<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 線形回帰 | エコノミストのためのR</title>
  <meta name="description" content="7 線形回帰 | エコノミストのためのR" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="7 線形回帰 | エコノミストのためのR" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="naohat23/econ-code-bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 線形回帰 | エコノミストのためのR" />
  
  
  

<meta name="author" content="服部直樹" />


<meta name="date" content="2022-06-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="探索的データ分析.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://naohat23.github.io/econ-code-bookdown">エコノミストのためのR</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>はじめに</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#なぜrを使うのか"><i class="fa fa-check"></i>なぜRを使うのか？</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#本書で出来ること"><i class="fa fa-check"></i>本書で出来ること　</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#本書で出来ないこと"><i class="fa fa-check"></i>本書で出来ないこと</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#目次"><i class="fa fa-check"></i>目次</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#参考文献ウェブサイト"><i class="fa fa-check"></i>参考文献・ウェブサイト</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#rプログラミングデータ分析"><i class="fa fa-check"></i>Rプログラミング・データ分析</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#計量経済学"><i class="fa fa-check"></i>計量経済学</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rの設定.html"><a href="rの設定.html"><i class="fa fa-check"></i><b>1</b> Rの設定</a>
<ul>
<li class="chapter" data-level="1.1" data-path="rの設定.html"><a href="rの設定.html#設定全般"><i class="fa fa-check"></i><b>1.1</b> 設定全般</a>
<ul>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#rのインストール"><i class="fa fa-check"></i>Rのインストール</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#rのバージョン確認"><i class="fa fa-check"></i>Rのバージョン確認</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#セッション情報の確認"><i class="fa fa-check"></i>セッション情報の確認</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#オブジェクトを全削除"><i class="fa fa-check"></i>オブジェクトを全削除</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#警告の非表示"><i class="fa fa-check"></i>警告の非表示</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#関数が出力する警告やメッセージの非表示"><i class="fa fa-check"></i>関数が出力する警告やメッセージの非表示</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="rの設定.html"><a href="rの設定.html#プロキシサーバーの設定"><i class="fa fa-check"></i><b>1.2</b> プロキシサーバーの設定</a></li>
<li class="chapter" data-level="1.3" data-path="rの設定.html"><a href="rの設定.html#パッケージ"><i class="fa fa-check"></i><b>1.3</b> パッケージ</a>
<ul>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#使用するパッケージ一覧"><i class="fa fa-check"></i>使用するパッケージ一覧</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#パッケージのインストールとインポート"><i class="fa fa-check"></i>パッケージのインストールとインポート</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="rの設定.html"><a href="rの設定.html#グラフの設定"><i class="fa fa-check"></i><b>1.4</b> グラフの設定</a>
<ul>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#グラフのテーマ設定"><i class="fa fa-check"></i>グラフのテーマ設定</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#グラフのフォント設定"><i class="fa fa-check"></i>グラフのフォント設定</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="rの設定.html"><a href="rの設定.html#サンプルデータセット"><i class="fa fa-check"></i><b>1.5</b> サンプルデータセット</a>
<ul>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#rのサンプルデータセット"><i class="fa fa-check"></i>Rのサンプルデータセット</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#外部データセット"><i class="fa fa-check"></i>外部データセット</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="rの設定.html"><a href="rの設定.html#r起動時に実行する設定"><i class="fa fa-check"></i><b>1.6</b> R起動時に実行する設定</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html"><i class="fa fa-check"></i><b>2</b> Rの基本的な使用方法</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#主要ショートカットキー"><i class="fa fa-check"></i><b>2.1</b> 主要ショートカットキー</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#編集"><i class="fa fa-check"></i>編集</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#実行"><i class="fa fa-check"></i>実行</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#その他"><i class="fa fa-check"></i>その他</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#基本操作"><i class="fa fa-check"></i><b>2.2</b> 基本操作</a></li>
<li class="chapter" data-level="2.3" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#演算"><i class="fa fa-check"></i><b>2.3</b> 演算</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#四則計算"><i class="fa fa-check"></i>四則計算</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#数値計算"><i class="fa fa-check"></i>数値計算</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#一致大小関係"><i class="fa fa-check"></i>一致・大小関係</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#包含集合関係"><i class="fa fa-check"></i>包含・集合関係</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ベクトル"><i class="fa fa-check"></i><b>2.4</b> ベクトル</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ベクトルの作成"><i class="fa fa-check"></i>ベクトルの作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ベクトル要素へのアクセス"><i class="fa fa-check"></i>ベクトル要素へのアクセス</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#規則性があるベクトルの作成"><i class="fa fa-check"></i>規則性があるベクトルの作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ベクトルの演算"><i class="fa fa-check"></i>ベクトルの演算</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#行列"><i class="fa fa-check"></i><b>2.5</b> 行列</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#行列の作成"><i class="fa fa-check"></i>行列の作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#行列の要素へのアクセス"><i class="fa fa-check"></i>行列の要素へのアクセス</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#行列の演算"><i class="fa fa-check"></i>行列の演算</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データフレーム"><i class="fa fa-check"></i><b>2.6</b> データフレーム</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データフレームの作成"><i class="fa fa-check"></i>データフレームの作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データフレームの要素へのアクセス"><i class="fa fa-check"></i>データフレームの要素へのアクセス</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#その他のデータフレームの機能"><i class="fa fa-check"></i>その他のデータフレームの機能</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#リスト"><i class="fa fa-check"></i><b>2.7</b> リスト</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#リストの作成"><i class="fa fa-check"></i>リストの作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#リストの要素へのアクセス"><i class="fa fa-check"></i>リストの要素へのアクセス</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#制御構文"><i class="fa fa-check"></i><b>2.8</b> 制御構文</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ifelse文"><i class="fa fa-check"></i>if/else文</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#forループ"><i class="fa fa-check"></i>forループ</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#whileループ"><i class="fa fa-check"></i>whileループ</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#breakによる繰り返しの終了"><i class="fa fa-check"></i>breakによる繰り返しの終了</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#tryによるエラー処理"><i class="fa fa-check"></i>tryによるエラー処理</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データの読み込み書き出し"><i class="fa fa-check"></i><b>2.9</b> データの読み込み・書き出し</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#csvデータの読み込み"><i class="fa fa-check"></i>CSVデータの読み込み</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#excelデータの読み込みxls形式"><i class="fa fa-check"></i>Excelデータの読み込み（xls形式）</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#excelデータの読み込みxlsx形式"><i class="fa fa-check"></i>Excelデータの読み込み（xlsx形式）</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#csvデータの書き出し"><i class="fa fa-check"></i>CSVデータの書き出し</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#オブジェクトのセーブロード"><i class="fa fa-check"></i><b>2.10</b> オブジェクトのセーブ・ロード</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#セーブ"><i class="fa fa-check"></i>セーブ</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ロード"><i class="fa fa-check"></i>ロード</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html"><i class="fa fa-check"></i><b>3</b> tidyverseによるデータ操作</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#第3章の準備"><i class="fa fa-check"></i><b>3.1</b> 第3章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#パッケージのインポート"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#外部データセットの取得"><i class="fa fa-check"></i>外部データセットの取得</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#tidyverseとは"><i class="fa fa-check"></i><b>3.2</b> tidyverseとは</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#tidy-data縦型横型データ"><i class="fa fa-check"></i>tidy data（縦型・横型データ）</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#tidyverseの特徴"><i class="fa fa-check"></i>tidyverseの特徴</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列の選択"><i class="fa fa-check"></i><b>3.3</b> 列の選択</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名で選択"><i class="fa fa-check"></i>列名で選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名を格納したベクトルで選択"><i class="fa fa-check"></i>列名を格納したベクトルで選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列を非選択削除"><i class="fa fa-check"></i>列を非選択（削除）</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名に特定の文字列を含む列を選択"><i class="fa fa-check"></i>列名に特定の文字列を含む列を選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名が特定の文字列から始まる列を選択"><i class="fa fa-check"></i>列名が特定の文字列から始まる列を選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名が特定の文字列で終わる列を選択"><i class="fa fa-check"></i>列名が特定の文字列で終わる列を選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#特定の型の列を選択"><i class="fa fa-check"></i>特定の型の列を選択</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名の変更"><i class="fa fa-check"></i><b>3.4</b> 列名の変更</a></li>
<li class="chapter" data-level="3.5" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#行のフィルタ"><i class="fa fa-check"></i><b>3.5</b> 行のフィルタ</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#条件に一致する行"><i class="fa fa-check"></i>条件に一致する行</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#条件に一致しない行not条件"><i class="fa fa-check"></i>条件に一致しない行（NOT条件）</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数条件"><i class="fa fa-check"></i>複数条件</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#andor条件を明示的に指定した複数条件"><i class="fa fa-check"></i>AND・OR条件を明示的に指定した複数条件</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#in演算子によるor条件"><i class="fa fa-check"></i><code>%in%</code>演算子によるOR条件</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#or条件の否定"><i class="fa fa-check"></i>OR条件の否定</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#関数による条件指定"><i class="fa fa-check"></i>関数による条件指定</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#論理値を返す関数による条件指定"><i class="fa fa-check"></i>論理値を返す関数による条件指定</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#行の並べ替え"><i class="fa fa-check"></i><b>3.6</b> 行の並べ替え</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#昇順ソート"><i class="fa fa-check"></i>昇順ソート</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#降順ソート"><i class="fa fa-check"></i>降順ソート</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#降順ソート日付型"><i class="fa fa-check"></i>降順ソート（日付型）</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数条件によるソート"><i class="fa fa-check"></i>複数条件によるソート</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列の作成修正"><i class="fa fa-check"></i><b>3.7</b> 列の作成・修正</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#新たな列の作成"><i class="fa fa-check"></i>新たな列の作成</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#既存の列の修正"><i class="fa fa-check"></i>既存の列の修正</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#条件付き系列の作成"><i class="fa fa-check"></i>条件付き系列の作成</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数列の一括処理"><i class="fa fa-check"></i>複数列の一括処理</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#グループ化"><i class="fa fa-check"></i><b>3.8</b> グループ化</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#単一の列でグループ化"><i class="fa fa-check"></i>単一の列でグループ化</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数の列でグループ化"><i class="fa fa-check"></i>複数の列でグループ化</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#グループ化フィルタ"><i class="fa fa-check"></i>グループ化＆フィルタ</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#グループ化の解除"><i class="fa fa-check"></i>グループ化の解除</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#集計"><i class="fa fa-check"></i><b>3.9</b> 集計</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#グループ別の集計"><i class="fa fa-check"></i>グループ別の集計</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#クロス集計"><i class="fa fa-check"></i>クロス集計</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数列の一括処理-1"><i class="fa fa-check"></i>複数列の一括処理</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#縦型横型の変換"><i class="fa fa-check"></i><b>3.10</b> 縦型・横型の変換</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#縦型データを横型データに変換"><i class="fa fa-check"></i>縦型データを横型データに変換</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#横型データを縦型データに変換"><i class="fa fa-check"></i>横型データを縦型データに変換</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#データの結合"><i class="fa fa-check"></i><b>3.11</b> データの結合</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#内部結合"><i class="fa fa-check"></i>内部結合</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#左外部結合"><i class="fa fa-check"></i>左外部結合</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#右外部結合"><i class="fa fa-check"></i>右外部結合</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#完全外部結合"><i class="fa fa-check"></i>完全外部結合</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#重複処理"><i class="fa fa-check"></i><b>3.12</b> 重複処理</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#重複行の抽出"><i class="fa fa-check"></i>重複行の抽出</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#重複行の削除"><i class="fa fa-check"></i>重複行の削除</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#欠損値処理"><i class="fa fa-check"></i><b>3.13</b> 欠損値処理</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#naの削除"><i class="fa fa-check"></i>NAの削除</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#naの置換"><i class="fa fa-check"></i>NAの置換</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#naのフィル"><i class="fa fa-check"></i>NAのフィル</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#補完処理"><i class="fa fa-check"></i><b>3.14</b> 補完処理</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#組み合わせ候補の補完"><i class="fa fa-check"></i>組み合わせ候補の補完</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#時系列データの補完"><i class="fa fa-check"></i>時系列データの補完</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#サンプリング"><i class="fa fa-check"></i><b>3.15</b> サンプリング</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="時系列データ操作.html"><a href="時系列データ操作.html"><i class="fa fa-check"></i><b>4</b> 時系列データ操作</a>
<ul>
<li class="chapter" data-level="4.1" data-path="時系列データ操作.html"><a href="時系列データ操作.html#第4章の準備"><i class="fa fa-check"></i><b>4.1</b> 第4章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#パッケージのインポート-1"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#外部データセットの取得-1"><i class="fa fa-check"></i>外部データセットの取得</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="時系列データ操作.html"><a href="時系列データ操作.html#データ変換"><i class="fa fa-check"></i><b>4.2</b> データ変換</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ラグリード系列の作成"><i class="fa fa-check"></i>ラグ・リード系列の作成</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#変化率系列の作成"><i class="fa fa-check"></i>変化率系列の作成</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#移動平均系列の作成"><i class="fa fa-check"></i>移動平均系列の作成</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="時系列データ操作.html"><a href="時系列データ操作.html#時系列データの頻度変換"><i class="fa fa-check"></i><b>4.3</b> 時系列データの頻度変換</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データを週次データに変換"><i class="fa fa-check"></i>日次データを週次データに変換</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データを月次データに変換"><i class="fa fa-check"></i>日次データを月次データに変換</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データを四半期データに変換"><i class="fa fa-check"></i>日次データを四半期データに変換</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="時系列データ操作.html"><a href="時系列データ操作.html#季節調整x-13"><i class="fa fa-check"></i><b>4.4</b> 季節調整（X-13）</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ts型データの可視化"><i class="fa fa-check"></i>ts型データの可視化</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#x-13arima-seatsの実施方法"><i class="fa fa-check"></i>X-13ARIMA-SEATSの実施方法</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#実例月次データの季節調整"><i class="fa fa-check"></i>実例：月次データの季節調整</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="時系列データ操作.html"><a href="時系列データ操作.html#季節調整stl分解"><i class="fa fa-check"></i><b>4.5</b> 季節調整（STL分解）</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#stl分解の実施方法"><i class="fa fa-check"></i>STL分解の実施方法</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#週次データのstl分解"><i class="fa fa-check"></i>週次データのSTL分解</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データのstl分解単一周期"><i class="fa fa-check"></i>日次データのSTL分解（単一周期）</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データのstl分解複数周期"><i class="fa fa-check"></i>日次データのSTL分解（複数周期）</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="時系列データ操作.html"><a href="時系列データ操作.html#トレンド推定"><i class="fa fa-check"></i><b>4.6</b> トレンド推定</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#hpフィルタ"><i class="fa fa-check"></i>HPフィルタ</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#一般化加法モデルgam"><i class="fa fa-check"></i>一般化加法モデル（GAM）</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html"><i class="fa fa-check"></i><b>5</b> ggplot2によるグラフ作成</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#第5章の準備"><i class="fa fa-check"></i><b>5.1</b> 第5章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#パッケージのインポート-2"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#外部データセットの取得-2"><i class="fa fa-check"></i>外部データセットの取得</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ggplot2とは"><i class="fa fa-check"></i><b>5.2</b> ggplot2とは</a></li>
<li class="chapter" data-level="5.3" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ggplot2の設定"><i class="fa fa-check"></i><b>5.3</b> ggplot2の設定</a></li>
<li class="chapter" data-level="5.4" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#gui形式の直感的なグラフ作成"><i class="fa fa-check"></i><b>5.4</b> GUI形式の直感的なグラフ作成</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#esquisseパッケージ"><i class="fa fa-check"></i>esquisseパッケージ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ggplotguiパッケージ"><i class="fa fa-check"></i>ggplotguiパッケージ</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の度数分布離散型"><i class="fa fa-check"></i><b>5.5</b> 1次元の度数分布（離散型）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#度数棒グラフの基本形"><i class="fa fa-check"></i>度数棒グラフの基本形</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の度数分布連続型"><i class="fa fa-check"></i><b>5.6</b> 1次元の度数分布（連続型）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ヒストグラムの基本形"><i class="fa fa-check"></i>ヒストグラムの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#横並びヒストグラム"><i class="fa fa-check"></i>横並びヒストグラム</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げヒストグラム"><i class="fa fa-check"></i>積み上げヒストグラム</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の密度グラフ"><i class="fa fa-check"></i><b>5.7</b> 1次元の密度グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#密度グラフの基本形"><i class="fa fa-check"></i>密度グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#横並び密度グラフ"><i class="fa fa-check"></i>横並び密度グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ密度グラフ"><i class="fa fa-check"></i>積み上げ密度グラフ</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の度数分布離散型-1"><i class="fa fa-check"></i><b>5.8</b> 2次元の度数分布（離散型）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#度数バブルチャートの基本形"><i class="fa fa-check"></i>度数バブルチャートの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#度数ヒートマップの基本形"><i class="fa fa-check"></i>度数ヒートマップの基本形</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の度数分布連続型-1"><i class="fa fa-check"></i><b>5.9</b> 2次元の度数分布（連続型）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#度数ヒートマップの基本形-1"><i class="fa fa-check"></i>度数ヒートマップの基本形</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の密度グラフ-1"><i class="fa fa-check"></i><b>5.10</b> 2次元の密度グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元密度グラフの基本形"><i class="fa fa-check"></i>2次元密度グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元密度グラフの塗りつぶし版"><i class="fa fa-check"></i>2次元密度グラフの塗りつぶし版</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#qqプロット"><i class="fa fa-check"></i><b>5.11</b> QQプロット</a></li>
<li class="chapter" data-level="5.12" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図バブルチャート"><i class="fa fa-check"></i><b>5.12</b> 散布図・バブルチャート</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図の基本形"><i class="fa fa-check"></i>散布図の基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#バブルチャートの基本形"><i class="fa fa-check"></i>バブルチャートの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図に補助線を追加"><i class="fa fa-check"></i>散布図に補助線を追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図にコネクタ線を追加"><i class="fa fa-check"></i>散布図にコネクタ線を追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図に近似曲線を追加"><i class="fa fa-check"></i>散布図に近似曲線を追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図にラベルを追加"><i class="fa fa-check"></i>散布図にラベルを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#バブルチャートにラベルを追加"><i class="fa fa-check"></i>バブルチャートにラベルを追加</a></li>
</ul></li>
<li class="chapter" data-level="5.13" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#棒グラフ"><i class="fa fa-check"></i><b>5.13</b> 棒グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#縦棒グラフの基本形"><i class="fa fa-check"></i>縦棒グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#横棒グラフ"><i class="fa fa-check"></i>横棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#縦棒グラフの順序並べ替え"><i class="fa fa-check"></i>縦棒グラフの順序並べ替え</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#縦棒グラフにラベルを追加"><i class="fa fa-check"></i>縦棒グラフにラベルを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#集合縦棒グラフ"><i class="fa fa-check"></i>集合縦棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフ"><i class="fa fa-check"></i>積み上げ縦棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフにラベルを追加"><i class="fa fa-check"></i>積み上げ縦棒グラフにラベルを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフ-1"><i class="fa fa-check"></i>100％積み上げ縦棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフにラベルを追加-1"><i class="fa fa-check"></i>100％積み上げ縦棒グラフにラベルを追加</a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#円グラフ"><i class="fa fa-check"></i><b>5.14</b> 円グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#円グラフの基本形"><i class="fa fa-check"></i>円グラフの基本形</a></li>
</ul></li>
<li class="chapter" data-level="5.15" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#折れ線グラフ"><i class="fa fa-check"></i><b>5.15</b> 折れ線グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#折れ線グラフの基本形"><i class="fa fa-check"></i>折れ線グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#折れ線グラフにマーカーを追加"><i class="fa fa-check"></i>折れ線グラフにマーカーを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#折れ線グラフに系列ラベルを追加"><i class="fa fa-check"></i>折れ線グラフに系列ラベルを追加</a></li>
</ul></li>
<li class="chapter" data-level="5.16" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ステップグラフ"><i class="fa fa-check"></i><b>5.16</b> ステップグラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ステップグラフの基本形"><i class="fa fa-check"></i>ステップグラフの基本形</a></li>
</ul></li>
<li class="chapter" data-level="5.17" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#面グラフ"><i class="fa fa-check"></i><b>5.17</b> 面グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#面グラフの基本形"><i class="fa fa-check"></i>面グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ面グラフ"><i class="fa fa-check"></i>積み上げ面グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#リボングラフの基本形"><i class="fa fa-check"></i>リボングラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#リボングラフに折れ線グラフを追加"><i class="fa fa-check"></i>リボングラフに折れ線グラフを追加</a></li>
</ul></li>
<li class="chapter" data-level="5.18" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#箱ひげ図ヴァイオリングラフ"><i class="fa fa-check"></i><b>5.18</b> 箱ひげ図・ヴァイオリングラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#箱ひげ図の基本形"><i class="fa fa-check"></i>箱ひげ図の基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#箱ひげ図に個別サンプルを追加"><i class="fa fa-check"></i>箱ひげ図に個別サンプルを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ヴァイオリングラフの基本形"><i class="fa fa-check"></i>ヴァイオリングラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ヴァイオリングラフに個別サンプルを追加"><i class="fa fa-check"></i>ヴァイオリングラフに個別サンプルを追加</a></li>
</ul></li>
<li class="chapter" data-level="5.19" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ドットプロット"><i class="fa fa-check"></i><b>5.19</b> ドットプロット</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ドットプロットの基本形"><i class="fa fa-check"></i>ドットプロットの基本形</a></li>
</ul></li>
<li class="chapter" data-level="5.20" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#色の設定"><i class="fa fa-check"></i><b>5.20</b> 色の設定</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#色の手動指定離散型変数"><i class="fa fa-check"></i>色の手動指定（離散型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#brewerカラーパレット離散型変数"><i class="fa fa-check"></i>Brewerカラーパレット（離散型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#viridisカラーパレット離散型変数"><i class="fa fa-check"></i>Viridisカラーパレット（離散型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ggsciカラーパレット離散型変数"><i class="fa fa-check"></i>ggsciカラーパレット（離散型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#distillerカラーパレット連続型変数"><i class="fa fa-check"></i>distillerカラーパレット（連続型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#viridisカラーパレット連続型変数"><i class="fa fa-check"></i>Viridisカラーパレット（連続型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#gradientカラーパレット連続型変数"><i class="fa fa-check"></i>gradientカラーパレット（連続型変数）</a></li>
</ul></li>
<li class="chapter" data-level="5.21" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#軸の設定"><i class="fa fa-check"></i><b>5.21</b> 軸の設定</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#x軸連続型y軸連続型"><i class="fa fa-check"></i>X軸：連続型、Y軸：連続型</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#対数目盛"><i class="fa fa-check"></i>対数目盛</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#x軸日付型y軸連続型"><i class="fa fa-check"></i>X軸：日付型、Y軸：連続型</a></li>
</ul></li>
<li class="chapter" data-level="5.22" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#複合グラフファセット"><i class="fa fa-check"></i><b>5.22</b> 複合グラフ（ファセット）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#行方向の複合グラフ"><i class="fa fa-check"></i>行方向の複合グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#列方向の複合グラフ"><i class="fa fa-check"></i>列方向の複合グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#行列方向の複合グラフ"><i class="fa fa-check"></i>行・列方向の複合グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#行数列数を指定した複合グラフ"><i class="fa fa-check"></i>行数・列数を指定した複合グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#複合グラフの設定"><i class="fa fa-check"></i>複合グラフの設定</a></li>
</ul></li>
<li class="chapter" data-level="5.23" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#地図ファセット"><i class="fa fa-check"></i><b>5.23</b> 地図ファセット</a></li>
<li class="chapter" data-level="5.24" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#その他設定保存"><i class="fa fa-check"></i><b>5.24</b> その他設定・保存</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#タイトルキャプション"><i class="fa fa-check"></i>タイトル・キャプション</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#パネル目盛線"><i class="fa fa-check"></i>パネル目盛線</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#凡例"><i class="fa fa-check"></i>凡例</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#フォントマージン設定"><i class="fa fa-check"></i>フォント・マージン設定</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#保存"><i class="fa fa-check"></i>保存</a></li>
</ul></li>
<li class="chapter" data-level="5.25" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#実例"><i class="fa fa-check"></i><b>5.25</b> 実例</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#実例1世界の新型コロナ死亡率の箱ひげ図"><i class="fa fa-check"></i>実例1：世界の新型コロナ死亡率の箱ひげ図</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="探索的データ分析.html"><a href="探索的データ分析.html"><i class="fa fa-check"></i><b>6</b> 探索的データ分析</a>
<ul>
<li class="chapter" data-level="6.1" data-path="探索的データ分析.html"><a href="探索的データ分析.html#第6章の準備"><i class="fa fa-check"></i><b>6.1</b> 第6章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#パッケージのインポート-3"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#ggplot2の設定-1"><i class="fa fa-check"></i>ggplot2の設定</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="探索的データ分析.html"><a href="探索的データ分析.html#データの中身記述統計量"><i class="fa fa-check"></i><b>6.2</b> データの中身（記述統計量）</a></li>
<li class="chapter" data-level="6.3" data-path="探索的データ分析.html"><a href="探索的データ分析.html#データの分布"><i class="fa fa-check"></i><b>6.3</b> データの分布</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#離散型変数の度数分布"><i class="fa fa-check"></i>離散型変数の度数分布</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#連続型変数の度数分布"><i class="fa fa-check"></i>連続型変数の度数分布</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#外れ値"><i class="fa fa-check"></i>外れ値</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="探索的データ分析.html"><a href="探索的データ分析.html#データの関係性"><i class="fa fa-check"></i><b>6.4</b> データの関係性</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#離散型変数の関係性"><i class="fa fa-check"></i>離散型変数の関係性</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#連続型変数の関係性"><i class="fa fa-check"></i>連続型変数の関係性</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="探索的データ分析.html"><a href="探索的データ分析.html#相関関係ペアプロット"><i class="fa fa-check"></i><b>6.5</b> 相関関係・ペアプロット</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#相関係数行列"><i class="fa fa-check"></i>相関係数行列</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#corrplotパッケージ"><i class="fa fa-check"></i>corrplotパッケージ</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#corrrパッケージ"><i class="fa fa-check"></i>corrrパッケージ</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#ggallyパッケージ"><i class="fa fa-check"></i>GGallyパッケージ</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="探索的データ分析.html"><a href="探索的データ分析.html#探索的データ分析の一括実行"><i class="fa fa-check"></i><b>6.6</b> 探索的データ分析の一括実行</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#dataexplorerパッケージ"><i class="fa fa-check"></i>DataExplorerパッケージ</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#smartedaパッケージ"><i class="fa fa-check"></i>SmartEDAパッケージ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="線形回帰.html"><a href="線形回帰.html"><i class="fa fa-check"></i><b>7</b> 線形回帰</a>
<ul>
<li class="chapter" data-level="7.1" data-path="線形回帰.html"><a href="線形回帰.html#第7章の準備"><i class="fa fa-check"></i><b>7.1</b> 第7章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#パッケージのインポート-4"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#外部データセットの取得-3"><i class="fa fa-check"></i>外部データセットの取得</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="線形回帰.html"><a href="線形回帰.html#用語の説明"><i class="fa fa-check"></i><b>7.2</b> 用語の説明</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#標本と推定"><i class="fa fa-check"></i>標本と推定</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#推定量の望ましい性質"><i class="fa fa-check"></i>推定量の望ましい性質</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="線形回帰.html"><a href="線形回帰.html#最小2乗法ols"><i class="fa fa-check"></i><b>7.3</b> 最小2乗法（OLS）</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#最小2乗法の仮定"><i class="fa fa-check"></i>最小2乗法の仮定</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#検定と信頼区間"><i class="fa fa-check"></i>検定と信頼区間</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="線形回帰.html"><a href="線形回帰.html#モデルの種類と係数の解釈"><i class="fa fa-check"></i><b>7.4</b> モデルの種類と係数の解釈</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#水準モデル"><i class="fa fa-check"></i>水準モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#対数モデル"><i class="fa fa-check"></i>対数モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#変化率モデル"><i class="fa fa-check"></i>変化率モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#多項式モデル"><i class="fa fa-check"></i>多項式モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#交互作用モデル"><i class="fa fa-check"></i>交互作用モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#ダミー変数"><i class="fa fa-check"></i>ダミー変数</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="線形回帰.html"><a href="線形回帰.html#重回帰モデルの注意点"><i class="fa fa-check"></i><b>7.5</b> 重回帰モデルの注意点</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#欠落変数バイアス"><i class="fa fa-check"></i>欠落変数バイアス</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#多重共線性"><i class="fa fa-check"></i>多重共線性</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#変数選択の指針"><i class="fa fa-check"></i>変数選択の指針</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="線形回帰.html"><a href="線形回帰.html#rの単回帰モデル推定"><i class="fa fa-check"></i><b>7.6</b> Rの単回帰モデル推定</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例4.1-線形単回帰"><i class="fa fa-check"></i>実証例4.1 線形単回帰</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#対数変化率モデルの推定"><i class="fa fa-check"></i>対数・変化率モデルの推定</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="線形回帰.html"><a href="線形回帰.html#rの重回帰モデル推定"><i class="fa fa-check"></i><b>7.7</b> Rの重回帰モデル推定</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例5.15.4-線形重回帰"><i class="fa fa-check"></i>実証例5.1・5.4 線形重回帰</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例5.5-多項式モデル"><i class="fa fa-check"></i>実証例5.5 多項式モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例5.6-ダミー交互作用モデル"><i class="fa fa-check"></i>実証例5.6 ダミー・交互作用モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例5.7-ダミー交互作用モデル"><i class="fa fa-check"></i>実証例5.7 ダミー・交互作用モデル</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">エコノミストのためのR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="線形回帰" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> 線形回帰<a href="線形回帰.html#線形回帰" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>第7章「線形回帰」では、計量経済学の基本である線形回帰モデルについて解説します。この章の説明は、山本（2015）、西山 他（2019）、末石（2015）をもとにしています。詳細は各参考文献を参照してください。また、実証例のRコードは北川（2020）のウェブサイトを参考にしています。</p>
<div id="第7章の準備" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> 第7章の準備<a href="線形回帰.html#第7章の準備" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="パッケージのインポート-4" class="section level3 unnumbered hasAnchor">
<h3>パッケージのインポート<a href="線形回帰.html#パッケージのインポート-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="線形回帰.html#cb545-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(estimatr)</span>
<span id="cb545-2"><a href="線形回帰.html#cb545-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb545-3"><a href="線形回帰.html#cb545-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb545-4"><a href="線形回帰.html#cb545-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyquant)</span>
<span id="cb545-5"><a href="線形回帰.html#cb545-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="外部データセットの取得-3" class="section level3 unnumbered hasAnchor">
<h3>外部データセットの取得<a href="線形回帰.html#外部データセットの取得-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>この章では、西山 他（2019）の実証例のデータセットを使用します。<a href="http://www.yuhikaku.co.jp/books/detail/9784641053854">西山 他（2019）のサポートウェブサイト</a>からデータファイルを取得し、各自の実行環境のワーキングディレクトリ直下に<code>data_nishiyama</code>フォルダを作成して、その中に格納してください。</p>
</div>
</div>
<div id="用語の説明" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> 用語の説明<a href="線形回帰.html#用語の説明" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>まず、統計学・計量経済学で使用される基本的な用語を説明します。</p>
<div id="標本と推定" class="section level3 unnumbered hasAnchor">
<h3>標本と推定<a href="線形回帰.html#標本と推定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>母集団</strong>：　調べる対象全体（population）</p>
<p><strong>標本</strong>：　母集団から取り出した対象の一部（sample）</p>
<p><strong>推定</strong>：　標本を使って母集団の分布に関する未知の値を言い当てること（estimation）</p>
<p><strong>未知パラメータ</strong>：　推定すべき未知の値。一般的に<span class="math inline">\(\theta\)</span>で表す（unknown parameter）</p>
<p><strong>統計量</strong>：　未知の値に依存せず、標本があれば値が計算できるデータの関数（statistic）</p>
<p><strong>推定量</strong>：　推定に用いる統計量（estimator）</p>
<p><strong>推定値</strong>：　未知の値について、実際にデータから計算して得た値（estimate）</p>
<p><strong>点推定</strong>：　未知パラメータの値を1点で言い当てること（point estimation）</p>
<p><strong>区間推定</strong>：　統計誤差を考慮して未知パラメータの値を区間で言い当てること（interval estimation）</p>
<p><strong>統計誤差</strong>：　母集団全体でなく標本を用いることで推定結果に生じる誤差（statistical error）</p>
</div>
<div id="推定量の望ましい性質" class="section level3 unnumbered hasAnchor">
<h3>推定量の望ましい性質<a href="線形回帰.html#推定量の望ましい性質" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>不偏性</strong>：　推定量の期待値が推定対象の未知パラメータの真の値に等しいこと（unbiasedness）</p>
<p><strong>一致制</strong>：　サンプルサイズが大きくなると、推定量が未知パラメータの真の値となる確率が1に近づくこと（consistency）</p>
<p><strong>漸近正規性</strong>：　サンプルサイズが大きいとき、そのサンプルから構成される確率変数が近似的に正規分布に従うこと（asymptomatic normality）</p>
<p><strong>効率性</strong>：　推定量の分散が小さく、未知パラメータの真の値に近い値をとりやすいこと（efficiency）</p>
<p><strong>頑健性</strong>：　異常値があっても推定量が影響を受けにくいこと（robustness）</p>
</div>
</div>
<div id="最小2乗法ols" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> 最小2乗法（OLS）<a href="線形回帰.html#最小2乗法ols" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>次に、線形回帰の推定方法である最小2乗法と、統計的仮説検定について解説します。</p>
<p>変数<span class="math inline">\(X\)</span>を用いて変数<span class="math inline">\(Y\)</span>を推定する、次のようなモデルを考えます。</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1X_i + u_i \quad (i = 1,\, \ldots,\, n)
\]</span></p>
<p>ここで、<span class="math inline">\(Y_i\)</span>は被説明変数（dependent variable）、<span class="math inline">\(X_i\)</span>は説明変数（independent variable）、<span class="math inline">\(u_i\)</span>は誤差項（error term）と呼ばれます。誤差項は<span class="math inline">\(X_i\)</span>以外で<span class="math inline">\(Y_i\)</span>に影響を与える要因をひとまとめにしたものと解釈できます。</p>
<div id="最小2乗法の仮定" class="section level3 unnumbered hasAnchor">
<h3>最小2乗法の仮定<a href="線形回帰.html#最小2乗法の仮定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>次の3つの仮定が成立するとき、OLS推定量は推定の望ましい性質である「不偏性」、「一致性」、「漸近正規性」を満たします。</p>
<div id="仮定1データが無作為抽出" class="section level4 unnumbered hasAnchor">
<h4>仮定1：データが無作為抽出<a href="線形回帰.html#仮定1データが無作為抽出" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>標本が同一の母集団から無作為抽出（ランダムサンプリング）されているという仮定であり、数学的には、<span class="math inline">\(Y_i\)</span>と<span class="math inline">\(X_i\)</span>が独立かつ同一の分布に従う（independently and identically distributed、i.i.d）と定義されます。</p>
<p>多くのクロスセクションデータでは仮定1が成立しますが、時系列データや、時系列の要素を含むパネルデータでは仮定1が成立しないと考えるのが自然です。家計の消費支出の慣性効果など、経済主体の行動は過去からの影響を受けやすく、過去と現在のデータに相関があることが多いためです。</p>
<p>仮定1が成立しない場合、誤差項に<strong>自己相関</strong>が発生します。</p>
</div>
<div id="仮定2異常値が少ない" class="section level4 unnumbered hasAnchor">
<h4>仮定2：異常値が少ない<a href="線形回帰.html#仮定2異常値が少ない" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>標本に含まれる異常値（データの絶対値が平均から大幅に離れている値）が少ないという仮定であり、数学的には変数の4次のモーメントが有限（<span class="math inline">\(0 &lt; E(X_i^4) &lt; \infty, \quad 0 &lt; E(Y_i^4) &lt; \infty\)</span>）と定義されます。すなわち、データの分布の裾が厚くない（ファット・テールでない）ということです。</p>
<p>一部の金融データなどでは異常値を取ることが多く（分布の裾が厚く）、仮定2が満たされない可能性があります。</p>
<p>仮定2が成立しない場合、OLS推定量が漸近正規性を満たさなくなります。漸近正規性は、直接的に推定量の良し悪しに関わる性質ではありませんが、係数に関する仮説検定や区間推定を行う基礎になる重要な性質です。</p>
</div>
<div id="仮定3説明変数と誤差項が無相関" class="section level4 unnumbered hasAnchor">
<h4>仮定3：説明変数と誤差項が無相関<a href="線形回帰.html#仮定3説明変数と誤差項が無相関" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>外生性</strong>と呼ばれる仮定であり、<span class="math inline">\(Y_i\)</span>の変動要因のうち<span class="math inline">\(X_i\)</span>以外の部分（すなわち誤差項<span class="math inline">\(u_i\)</span>）が平均的には<span class="math inline">\(X_i\)</span>と無関係であることを意味します。数学的には、誤差項の条件付き期待値が説明変数に依存しない（<span class="math inline">\(E(u_i|X_i) = 0\)</span>）と定義されます。</p>
<p>仮定3が成立していれば、モデルが因果関係を表していると解釈できます（ただし、仮定3が成立しているかどうかを回帰分析の結果から判断することはできません）。</p>
<p>仮定3が成立しないケースは多く、例えば、説明変数に本来含まれるべき変数が欠落している<strong>欠落変数バイアス</strong>、被説明変数が説明変数の変動要因になっている<strong>内生性バイアス（逆の因果性）</strong>などがあります。</p>
<p>仮定3は非常に重要です。仮定3が成立しない場合、OLS推定量は不偏性と一致性を満たさず、未知パラメータの値をきちんと推定することができない深刻な問題が発生します。対処方法として、他の説明変数の追加（重回帰モデル）による欠落変数バイアスの解消、パネルデータを用いた固定効果モデルの推定、2段階最小2乗法や操作変数法による内生性バイアスの解消を検討する必要があります。</p>
</div>
<div id="均一分散の仮定" class="section level4 unnumbered hasAnchor">
<h4>均一分散の仮定<a href="線形回帰.html#均一分散の仮定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>被説明変数<span class="math inline">\(Y_i\)</span>のデータの散らばり具合が説明変数<span class="math inline">\(X_i\)</span>の値によらず一定であるとき、誤差項<span class="math inline">\(u_i\)</span>の分散が一定、すなわち<strong>均一分散（homoskedasticity）</strong>であるといいます（<span class="math inline">\(Var(u|X) = E(u^2|X) = \sigma^2\)</span>）。</p>
<p>仮定1～3に加えて、均一分散の仮定が成立している場合、OLS推定量は線形な不偏推定量の中で「効率性」が最も高くなります（ガウス＝マルコフの定理）。これは、推定量の分散が最も小さく、推定量が真の値に近い値を取りやすいことを意味します。この時の推定量を、最良線形不偏推定量（best linear unbiased estimator, BLUE）と呼びます。</p>
<p>しかし、経済データ（特にクロスセクションデータ）で均一分散の仮定が成立することは少なく、誤差項<span class="math inline">\(u_i\)</span>の分散が説明変数<span class="math inline">\(X_i\)</span>に依存する<strong>不均一分散（heteroskedasticity）</strong>の方がむしろ一般的と考えられます。例えば、複数の家計の所得・消費データから消費関数を推定する際、所得水準が高いほど消費スタイルの違いによる消費額のばらつきが大きいことが想定されますが、その場合は均一分散の仮定が成立しません。</p>
<p>均一分散の仮定が成立しない（不均一分散が生じている）場合は、推定量の効率性が悪化し、ばらつきが大きくなってしまう問題があります。そのような場合に、均一分散を仮定して標準誤差（推定量の標準偏差を推定した値）を計算すると分散の大きさを過小評価してしまうため、不均一分散の可能性を考慮した<strong>不均一分散に頑健な標準誤差（ホワイトの標準誤差）</strong>を用いる必要があります。</p>
</div>
</div>
<div id="検定と信頼区間" class="section level3 unnumbered hasAnchor">
<h3>検定と信頼区間<a href="線形回帰.html#検定と信頼区間" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="帰無仮説と対立仮説" class="section level4 unnumbered hasAnchor">
<h4>帰無仮説と対立仮説<a href="線形回帰.html#帰無仮説と対立仮説" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>モデル<span class="math inline">\(Y_i = \beta_0 + \beta_1 X_i + u_i\)</span>について、次のような帰無仮説<span class="math inline">\(H_0\)</span>（null hypothesis）と対立仮説<span class="math inline">\(H_1\)</span>（alternative hypothesis）を考えます。</p>
<p><span class="math display">\[
H_0 : \beta_1 = 0 \\
H_1 : \beta_1 \neq 0
\]</span></p>
<p>推定にあたり、我々が本当に興味があるのは未知パラメータ<span class="math inline">\(\beta_1\)</span>の真の値であり、またそれを言い当てるための推定値と標準誤差であるわけですが、ここでは「少なくとも未知パラメータの真の値がゼロではない（有意である）」ことを統計的に確認するために、こうした検定を行います。</p>
</div>
<div id="t値" class="section level4 unnumbered hasAnchor">
<h4>t値<a href="線形回帰.html#t値" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>検定には<strong>t統計量（t値）</strong>を用います。t統計量は、未知パラメータの推定量と帰無仮説の設定値の差を、標準誤差（推定量の標準偏差を推定した値）で割ったものです。</p>
<p><span class="math display">\[
t = \frac{推定量 - 帰無仮説の設定値（ここではゼロ）}{標準誤差}
\]</span></p>
<p>t値が大きいほど、推定値に対して相対的に標準誤差が小さいことを意味します。目安として、t値が1.9や1.6など絶対値で2に近い値より大きければ、推定値の標準誤差は未知パラメータの符号条件を変えるほど大きくなく、未知パラメータの真の値がゼロである可能性は低い（推定値が統計的に有意である）と判断できます。</p>
</div>
<div id="p値" class="section level4 unnumbered hasAnchor">
<h4>p値<a href="線形回帰.html#p値" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>このt値を確率に置き換えたものが<strong>p値</strong>です。p値は「帰無仮説が正しいとしたときの確率分布のもとで、t値が観測したデータ（標本）から計算した値より極端な値をとる確率」を示したもので、t値が大きくなるほどp値は小さくなります。</p>
<p>p値は、直感的にいうと「未知パラメータの推定値がゼロになる確率」であり、p値がある一定の水準より小さければ、観測したデータは帰無仮説下では起こりにくいと判断し、帰無仮説<span class="math inline">\(H_0\)</span>を棄却して対立仮説<span class="math inline">\(H_1\)</span>を採択します。その際の「一定の水準」を<strong>有意水準</strong>と言い、一般的に5％や1％といった水準が用いられます。</p>
<p>ここで注意が必要なのは、<u>計算したp値が有意水準より大きく（例えば15％など）、帰無仮説を棄却できなかった場合に、帰無仮説が正しい（未知パラメータの真の値がゼロ）と結論付けられるわけではない</u>ということです（McAlinn（2022）P.50）。この場合は、「未知パラメータの推定値が統計的に有意であることが確認できず、判断を留保する」と結論することになります。</p>
</div>
<div id="信頼区間" class="section level4 unnumbered hasAnchor">
<h4>信頼区間<a href="線形回帰.html#信頼区間" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>信頼区間（confidence interval、CI）</strong>は、推定結果の精度を幅で示すものです。具体的には、未知パラメータの推定値と標準誤差を用い、ある一定の確率の下で未知パラメータの真の値を含む区間を計算します。その際の「一定の確率」を<strong>信頼係数</strong>といい、要求される推定の精度に応じ、一般的に95％や99％といった水準が用いられます。</p>
<p>信頼区間の解釈には注意が必要です。例えば、<u>標本から未知パラメータの95％信頼区間が10～20と計算されたとき、これは「パラメータの真の値が95％の確率で10～20の間にある」ことを意味するものではありません</u>。パラメータの真の値は定数であり、動かないのに対し、信頼区間は標本から計算した実現値のうちの一つであり、標本の選び方によりランダムに変わるためです。<u>95％信頼区間の意味は、「同一の母集団から独立な標本が100回得られて、信頼区間を100回計算することができれば、そのうち95回はパラメータの真の値を含む」ということ</u>です（末石（2015）P.11）。</p>
</div>
</div>
</div>
<div id="モデルの種類と係数の解釈" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> モデルの種類と係数の解釈<a href="線形回帰.html#モデルの種類と係数の解釈" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>ここでは線形回帰モデルの具体的な推定式として、実務で頻繁に用いる水準モデル、対数モデル、変化率モデル、多項式モデル、交互作用モデル、ダミー変数モデルを取り上げ、それぞれの内容と係数の解釈方法を説明します。</p>
<div id="水準モデル" class="section level3 unnumbered hasAnchor">
<h3>水準モデル<a href="線形回帰.html#水準モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X + u
\]</span></p>
<p>被説明変数<span class="math inline">\(Y\)</span>、説明変数<span class="math inline">\(X\)</span>ともにレベルの場合、係数<span class="math inline">\(\beta_1\)</span>は、説明変数<span class="math inline">\(X\)</span>が1単位変化すると被説明変数<span class="math inline">\(Y\)</span>が<span class="math inline">\(\beta_1\)</span>単位変化することを示します。</p>
<p>例えば、<span class="math inline">\(Y\)</span>が実質賃金（円）、<span class="math inline">\(X\)</span>が労働生産性（円）のとき、労働生産性が1円上昇すると実質賃金は<span class="math inline">\(\beta_1\)</span>円上昇します。</p>
</div>
<div id="対数モデル" class="section level3 unnumbered hasAnchor">
<h3>対数モデル<a href="線形回帰.html#対数モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="両辺が自然対数の場合" class="section level4 unnumbered hasAnchor">
<h4>両辺が自然対数の場合<a href="線形回帰.html#両辺が自然対数の場合" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
\ln Y = \beta_0 + \beta_1 \ln X + u
\]</span></p>
<p>被説明変数<span class="math inline">\(\ln Y\)</span>、説明変数<span class="math inline">\(\ln X\)</span>ともに自然対数の場合、係数<span class="math inline">\(\beta_1\)</span>は、説明変数<span class="math inline">\(X\)</span>が1％変化したときに被説明変数<span class="math inline">\(Y\)</span>が<span class="math inline">\(\beta_1\)</span>％変化することを示します。このとき、<span class="math inline">\(\beta_1\)</span>を<strong>弾性値（弾力性）</strong>と呼びます。</p>
<p>このように解釈できる理由は、次の通りです。変数<span class="math inline">\(X\)</span>がある小さい量<span class="math inline">\(\Delta x\)</span>だけ変化したときの<span class="math inline">\(\ln X\)</span>の変化量を<span class="math inline">\(\Delta \ln X\)</span>とすると、対数関数の性質を用いて、</p>
<p><span class="math display">\[
\Delta \ln X = \ln (X + \Delta x) - \ln X = \ln (1 + \frac{\Delta x}{X}) \approx \frac{\Delta x}{X}
\]</span></p>
<p>となります。<span class="math inline">\(\Delta x / X\)</span>は<span class="math inline">\(X\)</span>の変化率なので、この式から、<span class="math inline">\(X\)</span>が1％変化することと<span class="math inline">\(\ln X\)</span>が0.01変化することはほぼ同じであることがわかります。すると、「<span class="math inline">\(X\)</span>が1％変化する」＝「<span class="math inline">\(\ln X\)</span>が<span class="math inline">\(0.01\)</span>変化する」＝「<span class="math inline">\(\ln Y\)</span>が<span class="math inline">\(0.01 \times \beta_1\)</span>変化する」＝「<span class="math inline">\(Y\)</span>が<span class="math inline">\(\beta_1\)</span>％変化する」となります（西山 他（2019）P.107）。</p>
</div>
<div id="どちらか一方の辺が自然対数の場合" class="section level4 unnumbered hasAnchor">
<h4>どちらか一方の辺が自然対数の場合<a href="線形回帰.html#どちらか一方の辺が自然対数の場合" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
\ln Y = \beta_0 + \beta_1 X + u \\
Y = \beta_0 + \beta_1 \ln X + u
\]</span></p>
<p>被説明変数<span class="math inline">\(\ln Y\)</span>が自然対数、説明変数<span class="math inline">\(X\)</span>がレベルのとき、係数<span class="math inline">\(\beta_1\)</span>は、説明変数<span class="math inline">\(X\)</span>が1単位変化したときに被説明変数<span class="math inline">\(Y\)</span>が<span class="math inline">\(\beta_1\)</span>％変化することを示します。このとき、<span class="math inline">\(\beta_1\)</span>を<strong>偏弾性値</strong>と呼びます。</p>
<p>逆に、被説明変数<span class="math inline">\(Y\)</span>がレベル、説明変数<span class="math inline">\(\ln X\)</span>が自然対数の場合、係数<span class="math inline">\(\beta_1\)</span>は、説明変数<span class="math inline">\(X\)</span>が1％変化したときに被説明変数<span class="math inline">\(Y\)</span>が<span class="math inline">\(\beta_1/100\)</span>単位変化することを示します。</p>
</div>
</div>
<div id="変化率モデル" class="section level3 unnumbered hasAnchor">
<h3>変化率モデル<a href="線形回帰.html#変化率モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
100 \times \frac{\Delta Y_t}{Y_{t-1}} = \beta_0 + \beta_1 \times 100 \times \frac{\Delta X_t}{X_{t-1}} + u \\
100 \times \Delta \ln Y_t = \beta_0 + \beta_1 \times 100 \times \Delta \ln X_t + u
\]</span> 時系列データについて、ある変数<span class="math inline">\(X_t\)</span>と、その1期ラグ付き変数<span class="math inline">\(X_{t-1}\)</span>の差<span class="math inline">\(X_t - X_{t-1}\)</span>を<strong>階差</strong>と呼び、<span class="math inline">\(\Delta X_t = X_t - X_{t-1}\)</span>と表します。階差<span class="math inline">\(\Delta X_t\)</span>を1期ラグ付き変数<span class="math inline">\(X_{t-1}\)</span>で割り、100を掛けてパーセント表示にした系列<span class="math inline">\(100 \times \Delta X_t / X_{t-1}\)</span>を<strong>変化率</strong>と呼びます。</p>
<p>また、上記の対数モデルで見た<span class="math inline">\(\Delta \ln X \approx \Delta X / X\)</span>を用いると、時系列データの変数<span class="math inline">\(X_t\)</span>について自然対数の階差をとった<span class="math inline">\(\Delta \ln X_t = \ln X_t - \ln X_{t-1}\)</span>に100を掛けた系列は、変化率<span class="math inline">\(100 \times \Delta X_t / X_{t-1}\)</span>に近似できます。すなわち、<span class="math inline">\(100 \times \Delta \ln X_t \approx 100 \times \Delta X_t / X_{t-1}\)</span>です。この<span class="math inline">\(100 \times \Delta \ln X_t\)</span>を<strong>対数階差変化率</strong>と呼びます。</p>
<p>被説明変数と説明変数がともに変化率もしくは対数階差変化率のとき、係数<span class="math inline">\(\beta_1\)</span>は、説明変数（変化率）が1％ポイント変化したときに、被説明変数（変化率）が<span class="math inline">\(\beta_1\)</span>％ポイント変化することを示します。なお、このときの係数<span class="math inline">\(\beta_1\)</span>は、対数モデルの係数の解釈である弾力性とは全く異なるものである点に注意してください。</p>
</div>
<div id="多項式モデル" class="section level3 unnumbered hasAnchor">
<h3>多項式モデル<a href="線形回帰.html#多項式モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X + \beta_2 X^2 + u
\]</span></p>
<p>多項式の推定式では、説明変数<span class="math inline">\(X\)</span>が入る項が複数あるため、<span class="math inline">\(\beta_1\)</span>、<span class="math inline">\(\beta_2\)</span>単独では<span class="math inline">\(X\)</span>の変化による<span class="math inline">\(Y\)</span>への影響を測ることができません。<span class="math inline">\(X\)</span>の変化による<span class="math inline">\(Y\)</span>への影響は、右辺を<span class="math inline">\(X\)</span>で微分した結果である</p>
<p><span class="math display">\[
\frac{\partial(\beta_0 + \beta_1 X + \beta_2 X^2)}{\partial X} = \beta_1 + 2 \beta_2 X
\]</span></p>
<p>で表されます。これを<strong>限界効果</strong>と呼びます。ただし、限界効果の大きさは<span class="math inline">\(X\)</span>の値に依存するので、一定ではありません。そこで、限界効果の<span class="math inline">\(X\)</span>を<span class="math inline">\(X\)</span>の平均値<span class="math inline">\(\overline{X}\)</span>で置き換えた<strong>平均限界効果</strong><span class="math inline">\(\beta_1 + 2 \beta_2 \overline{X}\)</span>も、<span class="math inline">\(X\)</span>の変化による<span class="math inline">\(Y\)</span>への影響を測る値をして使用されます。</p>
<p>なお、上記の例では、限界効果がゼロ、すなわち<span class="math inline">\(\beta_1 + 2 \beta_2 X = 0\)</span>とおいて、<span class="math inline">\(X\)</span>について解くと、<span class="math inline">\(X = -\beta_1 / 2 \beta_2\)</span>が<span class="math inline">\(Y\)</span>を最大もしくは最小にする<span class="math inline">\(X\)</span>の値であることが計算できます。</p>
</div>
<div id="交互作用モデル" class="section level3 unnumbered hasAnchor">
<h3>交互作用モデル<a href="線形回帰.html#交互作用モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_1 X_2 + u
\]</span></p>
<p>交互作用モデルには、複数の変数の掛け算である<strong>交差項</strong>（ここでは<span class="math inline">\(X_1 X_2\)</span>）が入っています。これは、説明変数<span class="math inline">\(X_1\)</span>と<span class="math inline">\(X_2\)</span>が互いに影響しながら相乗効果として被説明変数<span class="math inline">\(Y\)</span>に影響するメカニズムを捉えています。</p>
<p>例えば、被説明変数<span class="math inline">\(Y\)</span>が給与額、説明変数<span class="math inline">\(X_1\)</span>と<span class="math inline">\(X_2\)</span>がそれぞれ教育年数と勤続年数の交互作用モデルを推定すると、給与額は教育年数、勤続年数それぞれ単独の影響だけでなく、教育年数と勤続年数の相乗効果の影響も受けることを想定していることになります（山本（2015）P.40）。</p>
<p>上記の交互作用モデルにおける説明変数<span class="math inline">\(X_1\)</span>の限界効果は<span class="math inline">\(\beta_1 + \beta_3 X_2\)</span>、平均限界効果は<span class="math inline">\(\beta_1 + \beta_3 \overline{X_2}\)</span>となります。</p>
</div>
<div id="ダミー変数" class="section level3 unnumbered hasAnchor">
<h3>ダミー変数<a href="線形回帰.html#ダミー変数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="切片ダミーの場合" class="section level4 unnumbered hasAnchor">
<h4>切片ダミーの場合<a href="線形回帰.html#切片ダミーの場合" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 D + \beta_2 X + u
\]</span></p>
<p>切片ダミーは、データの属性を区別するダミー変数<span class="math inline">\(D\)</span>が単独の項として推定式に入っているモデルであり、被説明変数<span class="math inline">\(Y\)</span>の平均的な水準がデータの属性により異なるメカニズムを捉えます。</p>
<p>例えば、被説明変数<span class="math inline">\(Y\)</span>が給与額、説明変数<span class="math inline">\(X\)</span>が勤続年数のモデルで、男性なら1、女性なら0をとる「男性ダミー変数」<span class="math inline">\(D\)</span>を考えます。このとき、男性の給与額は<span class="math inline">\(Y = (\beta_0 + \beta_1) + \beta_2 X\)</span>、女性の給与額は<span class="math inline">\(Y = \beta_0 + \beta_2 X\)</span>で表されるため、男性ダミー<span class="math inline">\(D\)</span>の係数<span class="math inline">\(\beta_1\)</span>は給与額の男性プレミアム（またはディスカウント）を捉えたものと解釈できます。</p>
<p>なお、「男性ダミー変数」<span class="math inline">\(D\)</span>の係数<span class="math inline">\(\beta_1\)</span>が捉えているのは、比較の基準である女性の給与額との差であり、男性の給与額の絶対的な水準を示すものではありません。また、<span class="math inline">\(\beta_1\)</span>は比較の基準である女性の給与額に関する情報は一切もっていません。</p>
</div>
<div id="傾きダミーの場合" class="section level4 unnumbered hasAnchor">
<h4>傾きダミーの場合<a href="線形回帰.html#傾きダミーの場合" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X + \beta_2 D X+ u
\]</span></p>
<p>傾きダミーは、ダミー変数<span class="math inline">\(D\)</span>が説明変数<span class="math inline">\(X\)</span>との交差項として推定式に入っているモデルであり、説明変数<span class="math inline">\(X\)</span>の影響が属性により異なるメカニズムを捉えます。</p>
<p>例えば、被説明変数<span class="math inline">\(Y\)</span>が給与額、説明変数<span class="math inline">\(X\)</span>が勤続年数のモデルで、男性なら1、女性なら0をとる「男性ダミー変数」<span class="math inline">\(D\)</span>を考えます。このとき、男性の給与額は<span class="math inline">\(Y = \beta_0 + (\beta_1 + \beta_2) X\)</span>、女性の給与額は<span class="math inline">\(Y = \beta_0 + \beta_1 X\)</span>で表されるため、男性ダミー<span class="math inline">\(D\)</span>の係数<span class="math inline">\(\beta_2\)</span>は給与額に対する勤続年数の効果を増幅（または縮小）させる影響を捉えたものと解釈できます。</p>
<p>なお、「男性ダミー変数」<span class="math inline">\(D\)</span>の係数<span class="math inline">\(\beta_2\)</span>が捉えているのは、比較の基準である女性の勤続年数効果との差であり、男性の勤続年数効果を示すものではありません。また、<span class="math inline">\(\beta_2\)</span>は比較の基準である女性の勤続年数効果に関する情報は一切もっていません。</p>
</div>
</div>
</div>
<div id="重回帰モデルの注意点" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> 重回帰モデルの注意点<a href="線形回帰.html#重回帰モデルの注意点" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>重回帰モデルは、次のように説明変数を2つ以上もつ回帰モデルのことです。</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1X_{1i} + \beta_2X_{2i} + \dots + \beta_kX_{ki} + u_i \quad (i = 1,\, \ldots,\, n)
\]</span></p>
<div id="欠落変数バイアス" class="section level3 unnumbered hasAnchor">
<h3>欠落変数バイアス<a href="線形回帰.html#欠落変数バイアス" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>重回帰モデルを使用する主な目的は、最小2乗法の仮定3「説明変数と誤差項が無相関」が成立しない原因の一つである<strong>欠落変数バイアス（omitted variable bias）</strong>に対処するためです。</p>
<p>欠落変数バイアスは、被説明変数<span class="math inline">\(Y_i\)</span>に影響を及ぼす変数を説明変数に含んでいないことによって起こります。こうした変数を<strong>交絡因子（confounding factor）</strong>と呼びます。</p>
<p>重回帰分析では、交絡因子の可能性がある変数を説明変数に追加し、欠落変数バイアスの問題を回避します。この作業を<strong>コントロール</strong>と呼び、追加される変数を<strong>コントロール変数</strong>と言います。コントロール変数は欠落変数バイアスを回避するためにモデルに追加されるため、コントロール変数が被説明変数に与える影響を推定することは主たる目的ではありません。</p>
</div>
<div id="多重共線性" class="section level3 unnumbered hasAnchor">
<h3>多重共線性<a href="線形回帰.html#多重共線性" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>多重共線性には2つのケースがあります。</p>
<p>一つは<strong>完全な多重共線性（perfect multicollinearity）</strong>で、ある説明変数が他の説明変数の線形和によって表される場合が該当します。このとき、最小2乗推定量が一意に定まらないため、推定不能になります。</p>
<p>もう一つは<strong>不完全な多重共線性</strong>で、説明変数間に強い相関がある場合が該当します。一般的に多重共線性というときはこちらを差すことが多いでしょう。多重共線性が発生すると、推定量の分散が大きくなり、係数の正確な推定が困難になります。</p>
<p>多重共線性には有効な解決策はありません。重回帰モデルでは欠落変数バイアスを回避するためにコントロール変数を追加していることが多く、多重共線性に対処するためにコントロール変数を除外すれば、欠落変数バイアスを回避することができなくなるためです。</p>
<p>末石（2015）P.18では、「明らかに不要な説明変数が入っているときは別として、多重共線性をなくそうとあれこれと工夫をするよりも、多くの場合は放置しておくのが無難」、「多重共線性はないに越したことはないが、完全な多重共線性とは異なり、論理的な欠陥ではない」、「推定量の分散は大きくなるが、それは標準誤差に反映されるので、検定をしたり信頼区間を求める際には、特に問題にならない」としています。</p>
</div>
<div id="変数選択の指針" class="section level3 unnumbered hasAnchor">
<h3>変数選択の指針<a href="線形回帰.html#変数選択の指針" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ここでは、重回帰分析にとって重要な「どの変数を推定式に含めるべきか」について解説します。詳細は西山 他（2019）P.185を参照してください。</p>
<div id="欠落変数バイアスを避けられるか" class="section level4 unnumbered hasAnchor">
<h4>1. 欠落変数バイアスを避けられるか<a href="線形回帰.html#欠落変数バイアスを避けられるか" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>興味がある説明変数が被説明変数に与える影響を正しく推定するためには、<u>その説明変数と相関し、かつ被説明変数に影響を与える変数</u>をコントロール変数として回帰モデルに含める必要があります。コントロール変数について注意すべき点は次の通りです。</p>
<ul>
<li>コントロール変数は分析対象として興味がなくても良い。</li>
<li>興味のある説明変数と無関係なコントロール変数を入れる必要はない。</li>
<li>コントロール変数に関する欠落変数バイアスを考慮する必要はない。</li>
<li>コントロール変数の係数は一致推定できず、係数の解釈は困難である（符号条件などが直感に反する結果でも気にする必要はない）。</li>
</ul>
</div>
<div id="興味のある説明変数の影響の解釈が変わりうるか" class="section level4 unnumbered hasAnchor">
<h4>2. 興味のある説明変数の影響の解釈が変わりうるか<a href="線形回帰.html#興味のある説明変数の影響の解釈が変わりうるか" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>重回帰分析では、モデルにどの変数を入れるかによって、係数の解釈が変わりえます。特に、<u>興味ある説明変数が被説明変数に影響を与える経路の中間にある変数（<strong>中間経路の変数</strong>）をモデルに含めると、係数が本来の研究対象とは異なる解釈を持つ可能性があります</u>。これを<strong>過剰制御</strong>と呼びます。</p>
<p>例えば、被説明変数を賃金、興味がある説明変数を教育として、教育が賃金に与える影響を分析する場合を考えます。ここで、変数として職業を入れると、職業は教育が賃金に影響を与える経路の中間に位置します。この時、教育の係数は、職業を固定した場合に教育の変化が賃金に与える影響を表すと解釈できますが、教育の変化は職業の変化を通じて賃金にも影響すると想定されるため、教育の係数は教育が賃金に与える影響すべてを捉えることができなくなります。</p>
</div>
<div id="推定量の分散を小さくできるか" class="section level4 unnumbered hasAnchor">
<h4>3. 推定量の分散を小さくできるか<a href="線形回帰.html#推定量の分散を小さくできるか" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>重回帰モデルに変数を追加する場合、<u>興味がある説明変数と相関している変数を追加すると、興味がある説明変数の係数の推定精度が悪化</u>します。一方で、<u>被説明変数に影響を与える変数を追加すると、モデルの推定誤差が改善</u>します。このように、変数の追加にはトレードオフがあります。</p>
</div>
<div id="のどの基準を優先すべきか" class="section level4 unnumbered hasAnchor">
<h4>1～3のどの基準を優先すべきか<a href="線形回帰.html#のどの基準を優先すべきか" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><u>重回帰分析をどのような目的で用いるかによって、変数選択の際に優先すべき基準が変化</u>します。</p>
<p><strong>興味がある説明変数の係数を推定する場合</strong>：　欠落変数バイアスの回避（1）と、説明変数の影響の解釈（2）を優先すべきで、推定量の分散（3）は副次的な問題になります。</p>
<p><strong>被説明変数の予測を行う場合</strong>：　モデルの推定誤差を減少させること（3）を優先すべきで、欠落変数バイアスの回避（1）や、説明変数の影響の解釈（2）は副次的な問題になります。</p>
</div>
</div>
</div>
<div id="rの単回帰モデル推定" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Rの単回帰モデル推定<a href="線形回帰.html#rの単回帰モデル推定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>線形単回帰モデル<span class="math inline">\(Y = \beta_0 + \beta_1 X + u\)</span>を最小2乗法で推定するには、<code>estimatr</code>パッケージの<code>lm_robust()</code>関数で<code>formula</code>引数を<code>Y ~ X</code>と設定します。</p>
<p><code>se_type</code>引数は計算する標準誤差の種類を指定します。<code>classical</code>を指定すると均一分散を仮定した標準誤差を使用しますが、上記の通り経済データは不均一分散であることが一般的であるため、不均一分散に頑健な標準誤差（ホワイトの標準誤差）の<code>HC1</code>か、デフォルトの<code>HC2</code>を使用するとよいでしょう。<code>se_type</code>引数の指定方法に関する数学的な解説は、<a href="https://declaredesign.org/r/estimatr/articles/mathematical-notes.html#lm_robust-notes">公式ウェブサイト</a>を参照してください。</p>
<p><code>lm_robust()</code>関数が返すオブジェクトを<code>summary()</code>関数で出力すると、係数の推定値、標準誤差、t値、p値、信頼区間の下限・上限値、決定係数、F検定の結果が表示されます。</p>
<div id="実証例4.1-線形単回帰" class="section level3 unnumbered hasAnchor">
<h3>実証例4.1 線形単回帰<a href="線形回帰.html#実証例4.1-線形単回帰" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>西山 他（2019）P.128～129の実証例4.1のデータを用い、実質賃金（wage）を被説明変数、労働生産性（productivity）を説明変数として、線形単回帰モデルを推定します。標準誤差は<code>se_type = "HC1"</code>と設定し、不均一分散に対して頑健な標準誤差（ホワイトの標準誤差）を使用します。</p>
<p>この結果は、<span class="math inline">\(実質賃金の推定量 = 276.13 + 0.55\,労働生産性\)</span> を意味しており、定数項と労働生産性の係数はどちらもp値が0.05より小さく、有意水準5％で帰無仮説が棄却されます。この結果から、統計的には労働生産性が100円上昇すると賃金が55円上がる傾向があると解釈できます。</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="線形回帰.html#cb546-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CSVデータを読み込み</span></span>
<span id="cb546-2"><a href="線形回帰.html#cb546-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">&quot;data_nishiyama/ch04/ch04_wage.csv&quot;</span>,</span>
<span id="cb546-3"><a href="線形回帰.html#cb546-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb546-4"><a href="線形回帰.html#cb546-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col_types =</span> <span class="st">&quot;ddd&quot;</span>,</span>
<span id="cb546-5"><a href="線形回帰.html#cb546-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip =</span> <span class="dv">0</span>)</span>
<span id="cb546-6"><a href="線形回帰.html#cb546-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb546-7"><a href="線形回帰.html#cb546-7" aria-hidden="true" tabindex="-1"></a><span class="co"># GGally::ggpairs()関数でペアプロットを出力</span></span>
<span id="cb546-8"><a href="線形回帰.html#cb546-8" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb546-9"><a href="線形回帰.html#cb546-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(productivity, wage) <span class="sc">%&gt;%</span> </span>
<span id="cb546-10"><a href="線形回帰.html#cb546-10" aria-hidden="true" tabindex="-1"></a>  GGally<span class="sc">::</span><span class="fu">ggpairs</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-268-1.png" width="672" /></p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="線形回帰.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimatr::lm_robust()関数でwageをproductivityに回帰</span></span>
<span id="cb547-2"><a href="線形回帰.html#cb547-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">lm_robust</span>(<span class="at">formula =</span> wage <span class="sc">~</span> productivity,</span>
<span id="cb547-3"><a href="線形回帰.html#cb547-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> data,</span>
<span id="cb547-4"><a href="線形回帰.html#cb547-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">se_type =</span> <span class="st">&quot;HC1&quot;</span>, <span class="co"># 標準誤差の設定（classical, HC0, HC1, HC2, HC3, CR0, CR2）</span></span>
<span id="cb547-5"><a href="線形回帰.html#cb547-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="co"># 有意水準</span></span>
<span id="cb547-6"><a href="線形回帰.html#cb547-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb547-7"><a href="線形回帰.html#cb547-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 回帰した結果を出力</span></span>
<span id="cb547-8"><a href="線形回帰.html#cb547-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## estimatr::lm_robust(formula = wage ~ productivity, data = data, 
##     se_type = &quot;HC1&quot;, alpha = 0.05)
## 
## Standard error type:  HC1 
## 
## Coefficients:
##              Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF
## (Intercept)  276.1296   71.25559   3.875 1.019e-03  126.990 425.2693 19
## productivity   0.5468    0.02046  26.722 1.553e-16    0.504   0.5896 19
## 
## Multiple R-squared:  0.9635 ,    Adjusted R-squared:  0.9616 
## F-statistic: 714.1 on 1 and 19 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="線形回帰.html#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 回帰した結果をデータフレーム形式で出力</span></span>
<span id="cb549-2"><a href="線形回帰.html#cb549-2" aria-hidden="true" tabindex="-1"></a>estimatr<span class="sc">::</span><span class="fu">tidy</span>(result)</span></code></pre></div>
<pre><code>##           term    estimate   std.error statistic      p.value    conf.low
## 1  (Intercept) 276.1296070 71.25558981  3.875199 1.018919e-03 126.9899435
## 2 productivity   0.5468196  0.02046305 26.722296 1.553174e-16   0.5039899
##     conf.high df outcome
## 1 425.2692704 19    wage
## 2   0.5896492 19    wage</code></pre>
</div>
<div id="対数変化率モデルの推定" class="section level3 unnumbered hasAnchor">
<h3>対数・変化率モデルの推定<a href="線形回帰.html#対数変化率モデルの推定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>実証例4.1のデータセットを利用して、両辺が自然対数のモデル、両辺が対数階差変化率のモデル、両辺が変化率のモデルを推定します。</p>
<p>自然対数は<code>log()</code>関数で計算します。対数階差変化率は対数変換した値に<code>tidyquant::CHANGE()</code>関数を適用して対数階差を計算します。変化率は<code>tidyquant::PCT_CHANGE()</code>関数で求めることができます。</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="線形回帰.html#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 自然対数、対数階差変化率、変化率を計算</span></span>
<span id="cb551-2"><a href="線形回帰.html#cb551-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb551-3"><a href="線形回帰.html#cb551-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ln_wage =</span> <span class="fu">log</span>(wage),</span>
<span id="cb551-4"><a href="線形回帰.html#cb551-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">ln_productivity =</span> <span class="fu">log</span>(productivity),</span>
<span id="cb551-5"><a href="線形回帰.html#cb551-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">dlog_wage =</span> <span class="dv">100</span> <span class="sc">*</span> tidyquant<span class="sc">::</span><span class="fu">CHANGE</span>(ln_wage),</span>
<span id="cb551-6"><a href="線形回帰.html#cb551-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">dlog_productivity =</span> <span class="dv">100</span> <span class="sc">*</span> tidyquant<span class="sc">::</span><span class="fu">CHANGE</span>(ln_productivity),</span>
<span id="cb551-7"><a href="線形回帰.html#cb551-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">pch_wage =</span> <span class="dv">100</span> <span class="sc">*</span> tidyquant<span class="sc">::</span><span class="fu">PCT_CHANGE</span>(wage),</span>
<span id="cb551-8"><a href="線形回帰.html#cb551-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">pch_productivity =</span> <span class="dv">100</span> <span class="sc">*</span> tidyquant<span class="sc">::</span><span class="fu">PCT_CHANGE</span>(productivity))</span></code></pre></div>
<p>対数モデルにおける労働生産性の係数0.874は、労働生産性が1％変化すると実質賃金が0.874％変化することを示しています（弾性値）。また、同係数のp値は0.05を下回っており、統計的に有意であるといえます。</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="線形回帰.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 対数モデル</span></span>
<span id="cb552-2"><a href="線形回帰.html#cb552-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">lm_robust</span>(<span class="at">formula =</span> ln_wage <span class="sc">~</span> ln_productivity,</span>
<span id="cb552-3"><a href="線形回帰.html#cb552-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> data,</span>
<span id="cb552-4"><a href="線形回帰.html#cb552-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">se_type =</span> <span class="st">&quot;HC1&quot;</span>, <span class="co"># 標準誤差の設定（classical, HC0, HC1, HC2, HC3, CR0, CR2）</span></span>
<span id="cb552-5"><a href="線形回帰.html#cb552-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="co"># 有意水準</span></span>
<span id="cb552-6"><a href="線形回帰.html#cb552-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb552-7"><a href="線形回帰.html#cb552-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## estimatr::lm_robust(formula = ln_wage ~ ln_productivity, data = data, 
##     se_type = &quot;HC1&quot;, alpha = 0.05)
## 
## Standard error type:  HC1 
## 
## Coefficients:
##                 Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF
## (Intercept)       0.5576    0.26022   2.143 4.530e-02  0.01292    1.102 19
## ln_productivity   0.8742    0.03191  27.397 9.782e-17  0.80745    0.941 19
## 
## Multiple R-squared:  0.9649 ,    Adjusted R-squared:  0.9631 
## F-statistic: 750.6 on 1 and 19 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>対数階差変化率は変化率の近似値なので、対数階差変化率モデルと変化率モデルはほぼ同じ推定結果になります。労働生産性の係数のp値はどちらも0.05を上回っており、有意ではありません。</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="線形回帰.html#cb554-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 対数階差変化率モデル</span></span>
<span id="cb554-2"><a href="線形回帰.html#cb554-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">lm_robust</span>(<span class="at">formula =</span> dlog_wage <span class="sc">~</span> dlog_productivity,</span>
<span id="cb554-3"><a href="線形回帰.html#cb554-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> data,</span>
<span id="cb554-4"><a href="線形回帰.html#cb554-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">se_type =</span> <span class="st">&quot;HC1&quot;</span>, <span class="co"># 標準誤差の設定（classical, HC0, HC1, HC2, HC3, CR0, CR2）</span></span>
<span id="cb554-5"><a href="線形回帰.html#cb554-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="co"># 有意水準</span></span>
<span id="cb554-6"><a href="線形回帰.html#cb554-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb554-7"><a href="線形回帰.html#cb554-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## estimatr::lm_robust(formula = dlog_wage ~ dlog_productivity, 
##     data = data, se_type = &quot;HC1&quot;, alpha = 0.05)
## 
## Standard error type:  HC1 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|) CI Lower CI Upper DF
## (Intercept)         0.7637     0.2900   2.633  0.01687   0.1544   1.3730 18
## dlog_productivity   0.2251     0.1791   1.257  0.22497  -0.1512   0.6014 18
## 
## Multiple R-squared:  0.1154 ,    Adjusted R-squared:  0.06623 
## F-statistic: 1.579 on 1 and 18 DF,  p-value: 0.225</code></pre>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="線形回帰.html#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 変化率モデル</span></span>
<span id="cb556-2"><a href="線形回帰.html#cb556-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">lm_robust</span>(<span class="at">formula =</span> pch_wage <span class="sc">~</span> pch_productivity,</span>
<span id="cb556-3"><a href="線形回帰.html#cb556-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> data,</span>
<span id="cb556-4"><a href="線形回帰.html#cb556-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">se_type =</span> <span class="st">&quot;HC1&quot;</span>, <span class="co"># 標準誤差の設定（classical, HC0, HC1, HC2, HC3, CR0, CR2）</span></span>
<span id="cb556-5"><a href="線形回帰.html#cb556-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="co"># 有意水準</span></span>
<span id="cb556-6"><a href="線形回帰.html#cb556-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-7"><a href="線形回帰.html#cb556-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## estimatr::lm_robust(formula = pch_wage ~ pch_productivity, data = data, 
##     se_type = &quot;HC1&quot;, alpha = 0.05)
## 
## Standard error type:  HC1 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|) CI Lower CI Upper DF
## (Intercept)        0.7725     0.2940   2.627  0.01708   0.1548   1.3902 18
## pch_productivity   0.2225     0.1801   1.236  0.23247  -0.1558   0.6009 18
## 
## Multiple R-squared:  0.1121 ,    Adjusted R-squared:  0.06276 
## F-statistic: 1.527 on 1 and 18 DF,  p-value: 0.2325</code></pre>
</div>
</div>
<div id="rの重回帰モデル推定" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Rの重回帰モデル推定<a href="線形回帰.html#rの重回帰モデル推定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>重回帰モデルも、単回帰モデルと同様に<code>estimatr</code>パッケージの<code>lm_robust()</code>関数で推定します。重回帰モデルの場合は、<code>formula</code>引数に<code>Y ~ X1 + X2</code>といった形で複数の説明変数を設定します。</p>
<div id="実証例5.15.4-線形重回帰" class="section level3 unnumbered hasAnchor">
<h3>実証例5.1・5.4 線形重回帰<a href="線形回帰.html#実証例5.15.4-線形重回帰" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>西山 他（2019）P.151～152の都道府県別データを用い、信頼関係の強さと規範意識が経済成長に与える影響を、教育水準と初期時点での豊かさをコントロールして推定します。使用する変数は次の通りです。詳細は、西山 他（2019）第5章の9節（P.191）と補論A（P.203）を参照してください。</p>
<ul>
<li>y80：　1980年時点の人口1人当たりGDP（100万円）</li>
<li>y99：　1999年時点の人口1人当たりGDP（100万円）</li>
<li>trust80：　1980年時点の信頼関係の強さ（標準化した値）</li>
<li>norm80：　1980年時点の規範意識の強さ（標準化した値）</li>
<li>education80：　1980年時点の教育水準（標準化した値）</li>
<li>did：　人口集中地区に居住する人口の割合</li>
</ul>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="線形回帰.html#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CSVデータを読み込み</span></span>
<span id="cb558-2"><a href="線形回帰.html#cb558-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">&quot;data_nishiyama/ch05/youdou.csv&quot;</span>,</span>
<span id="cb558-3"><a href="線形回帰.html#cb558-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col_names =</span> <span class="cn">TRUE</span>,</span>
<span id="cb558-4"><a href="線形回帰.html#cb558-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">col_types =</span> <span class="cn">NULL</span>,</span>
<span id="cb558-5"><a href="線形回帰.html#cb558-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">skip =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## Rows: 47 Columns: 23
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## dbl (22): id, y80, y90, y99, education80, trust80, trust96, norm80, norm96, ...
## lgl  (1): X
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="線形回帰.html#cb560-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 西山 他（2019）P.143～144に従い、各都道府県の人口1人当たりGDPの年平均経済成長率を計算</span></span>
<span id="cb560-2"><a href="線形回帰.html#cb560-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb560-3"><a href="線形回帰.html#cb560-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ln_y80 =</span> <span class="fu">log</span>(y80),</span>
<span id="cb560-4"><a href="線形回帰.html#cb560-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">ln_y99 =</span> <span class="fu">log</span>(y99),</span>
<span id="cb560-5"><a href="線形回帰.html#cb560-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">gr_80_99 =</span> <span class="dv">100</span> <span class="sc">*</span> (ln_y99 <span class="sc">-</span> ln_y80) <span class="sc">/</span> <span class="dv">19</span>)</span>
<span id="cb560-6"><a href="線形回帰.html#cb560-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-7"><a href="線形回帰.html#cb560-7" aria-hidden="true" tabindex="-1"></a><span class="co"># GGally::ggpairs()関数でペアプロットを出力</span></span>
<span id="cb560-8"><a href="線形回帰.html#cb560-8" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb560-9"><a href="線形回帰.html#cb560-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(gr_80_99, trust80, norm80, education80, ln_y80, ln_y99, did) <span class="sc">%&gt;%</span> </span>
<span id="cb560-10"><a href="線形回帰.html#cb560-10" aria-hidden="true" tabindex="-1"></a>  GGally<span class="sc">::</span><span class="fu">ggpairs</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-274-1.png" width="672" /></p>
<p>まず、1980～1999年の年平均経済成長率を、信頼関係の強さと規範意識それぞれで説明する単回帰モデルを推定します。</p>
<p>これらモデルは、信頼関係の強さと規範意識の係数のp値がともに0.05より小さく、係数が有意であることを示しています。</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="線形回帰.html#cb561-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">lm_robust</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> trust80,</span>
<span id="cb561-2"><a href="線形回帰.html#cb561-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> data,</span>
<span id="cb561-3"><a href="線形回帰.html#cb561-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">se_type =</span> <span class="st">&quot;HC1&quot;</span>,</span>
<span id="cb561-4"><a href="線形回帰.html#cb561-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb561-5"><a href="線形回帰.html#cb561-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-6"><a href="線形回帰.html#cb561-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## estimatr::lm_robust(formula = gr_80_99 ~ trust80, data = data, 
##     se_type = &quot;HC1&quot;, alpha = 0.05)
## 
## Standard error type:  HC1 
## 
## Coefficients:
##             Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF
## (Intercept)   3.1394    0.06044  51.943 8.188e-42  3.01763   3.2611 45
## trust80       0.2247    0.06640   3.384 1.491e-03  0.09094   0.3584 45
## 
## Multiple R-squared:  0.179 , Adjusted R-squared:  0.1608 
## F-statistic: 11.45 on 1 and 45 DF,  p-value: 0.001491</code></pre>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="線形回帰.html#cb563-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">lm_robust</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> norm80,</span>
<span id="cb563-2"><a href="線形回帰.html#cb563-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> data,</span>
<span id="cb563-3"><a href="線形回帰.html#cb563-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">se_type =</span> <span class="st">&quot;HC1&quot;</span>,</span>
<span id="cb563-4"><a href="線形回帰.html#cb563-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb563-5"><a href="線形回帰.html#cb563-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb563-6"><a href="線形回帰.html#cb563-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## estimatr::lm_robust(formula = gr_80_99 ~ norm80, data = data, 
##     se_type = &quot;HC1&quot;, alpha = 0.05)
## 
## Standard error type:  HC1 
## 
## Coefficients:
##             Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF
## (Intercept)   3.0905    0.04826  64.033 7.544e-46   2.9933   3.1878 45
## norm80        0.5597    0.07058   7.931 4.348e-10   0.4176   0.7019 45
## 
## Multiple R-squared:  0.4563 ,    Adjusted R-squared:  0.4442 
## F-statistic:  62.9 on 1 and 45 DF,  p-value: 4.348e-10</code></pre>
<p>次に、説明変数に、教育水準と、豊かさの代理変数として1980年時点の対数GDP水準を追加した重回帰モデルを推定します。</p>
<p>信頼関係の強さの係数の推定値は、単回帰モデルの0.22から0.02へと大幅に低下していることが確認できます。単回帰モデルでは、教育水準や豊かさが経済成長率に与える影響が、誤って信頼関係の強さの影響として推定されていた可能性が示唆されます。また、信頼関係の強さの係数のp値は0.79と大きく、係数は有意ではありません。</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="線形回帰.html#cb565-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">lm_robust</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> trust80 <span class="sc">+</span> education80 <span class="sc">+</span> ln_y80,</span>
<span id="cb565-2"><a href="線形回帰.html#cb565-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> data,</span>
<span id="cb565-3"><a href="線形回帰.html#cb565-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">se_type =</span> <span class="st">&quot;HC1&quot;</span>,</span>
<span id="cb565-4"><a href="線形回帰.html#cb565-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb565-5"><a href="線形回帰.html#cb565-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb565-6"><a href="線形回帰.html#cb565-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## estimatr::lm_robust(formula = gr_80_99 ~ trust80 + education80 + 
##     ln_y80, data = data, se_type = &quot;HC1&quot;, alpha = 0.05)
## 
## Standard error type:  HC1 
## 
## Coefficients:
##             Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF
## (Intercept)  6.04885    0.42643 14.1849 8.041e-18    5.189   6.9088 43
## trust80      0.02058    0.07564  0.2721 7.868e-01   -0.132   0.1731 43
## education80  2.61208    2.70857  0.9644 3.403e-01   -2.850   8.0744 43
## ln_y80      -2.38309    0.49147 -4.8489 1.658e-05   -3.374  -1.3920 43
## 
## Multiple R-squared:  0.5619 ,    Adjusted R-squared:  0.5313 
## F-statistic: 20.21 on 3 and 43 DF,  p-value: 2.531e-08</code></pre>
<p>一方、規範意識の係数の推定値は重回帰モデルでも0.34と小さくなく、経済学的に意味のある結果（規範意識は経済成長率にとって重要な要素）であると考えられます。また係数のp値は0.018と、有意水準5％で統計的に有意であるといえます。</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="線形回帰.html#cb567-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">lm_robust</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> norm80 <span class="sc">+</span> education80 <span class="sc">+</span> ln_y80,</span>
<span id="cb567-2"><a href="線形回帰.html#cb567-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> data,</span>
<span id="cb567-3"><a href="線形回帰.html#cb567-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">se_type =</span> <span class="st">&quot;HC1&quot;</span>,</span>
<span id="cb567-4"><a href="線形回帰.html#cb567-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb567-5"><a href="線形回帰.html#cb567-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb567-6"><a href="線形回帰.html#cb567-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## estimatr::lm_robust(formula = gr_80_99 ~ norm80 + education80 + 
##     ln_y80, data = data, se_type = &quot;HC1&quot;, alpha = 0.05)
## 
## Standard error type:  HC1 
## 
## Coefficients:
##             Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF
## (Intercept)   5.2909     0.6682   7.918 6.204e-10  3.94324   6.6385 43
## norm80        0.3383     0.1370   2.469 1.758e-02  0.06202   0.6145 43
## education80   4.3872     1.9611   2.237 3.051e-02  0.43233   8.3421 43
## ln_y80       -1.9911     0.5746  -3.465 1.213e-03 -3.14987  -0.8324 43
## 
## Multiple R-squared:  0.6391 ,    Adjusted R-squared:  0.614 
## F-statistic: 41.04 on 3 and 43 DF,  p-value: 1.11e-12</code></pre>
</div>
<div id="実証例5.5-多項式モデル" class="section level3 unnumbered hasAnchor">
<h3>実証例5.5 多項式モデル<a href="線形回帰.html#実証例5.5-多項式モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1980～1999年の年平均経済成長率を、1980年時点のGDP水準（対数をとらない値）の2次多項式で説明するモデルを推定します。</p>
<p>2乗の項は、あらかじめ<code>dplyr::mutate()</code>関数などを使用して計算しておくか、もしくは<code>I(変数 ^ 2)</code>として<code>lm_robust()</code>関数の回帰式に含めます。</p>
<p>推定結果は、1980年時点GDPの項、その2乗項ともに係数のp値が0.05より大きく、有意ではありません。ただし、それだけでは1980年時点GDPが経済成長率に影響を与えるかどうかは判断できません。判断するためには、1980年時点GDPの項と2乗項の係数がどちらも同時にゼロであるという<strong>結合仮説</strong>をF検定する必要があります。</p>
<p>推定結果においてF検定のp値をみると0.05より小さく、「1980年時点GDPの項と2乗項の係数がどちらも同時にゼロ（＝1980年時点GDPの影響はない）」という帰無仮説が棄却されます。</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="線形回帰.html#cb569-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">lm_robust</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> y80 <span class="sc">+</span> <span class="fu">I</span>(y80 <span class="sc">^</span> <span class="dv">2</span>),</span>
<span id="cb569-2"><a href="線形回帰.html#cb569-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> data,</span>
<span id="cb569-3"><a href="線形回帰.html#cb569-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">se_type =</span> <span class="st">&quot;HC1&quot;</span>,</span>
<span id="cb569-4"><a href="線形回帰.html#cb569-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb569-5"><a href="線形回帰.html#cb569-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb569-6"><a href="線形回帰.html#cb569-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## estimatr::lm_robust(formula = gr_80_99 ~ y80 + I(y80^2), data = data, 
##     se_type = &quot;HC1&quot;, alpha = 0.05)
## 
## Standard error type:  HC1 
## 
## Coefficients:
##             Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF
## (Intercept)  6.51866    1.38538   4.705 2.535e-05  3.72662   9.3107 44
## y80         -1.22615    0.70791  -1.732 9.027e-02 -2.65285   0.2005 44
## I(y80^2)     0.08935    0.08861   1.008 3.188e-01 -0.08923   0.2679 44
## 
## Multiple R-squared:  0.5503 ,    Adjusted R-squared:  0.5299 
## F-statistic: 27.39 on 2 and 44 DF,  p-value: 1.879e-08</code></pre>
<p>なお、推定結果から、限界効果は<span class="math inline">\(-1.226 + 2 \times0.089 \times 1980年時点GDP\)</span>と計算できます。平均限界効果は、1980年時点GDPの平均値が3.876なので、<span class="math inline">\(-1.226 + 2 \times0.089 \times 3.876 \approx -0.536\)</span>となります。</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="線形回帰.html#cb571-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 平均限界効果の計算</span></span>
<span id="cb571-2"><a href="線形回帰.html#cb571-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>coefficients[<span class="st">&quot;y80&quot;</span>] <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> result<span class="sc">$</span>coefficients[<span class="st">&quot;I(y80^2)&quot;</span>] <span class="sc">*</span> <span class="fu">mean</span>(data<span class="sc">$</span>y80)</span></code></pre></div>
<pre><code>##        y80 
## -0.5335568</code></pre>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="線形回帰.html#cb573-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 多項式モデルを推定した回帰曲線をプロット</span></span>
<span id="cb573-2"><a href="線形回帰.html#cb573-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> </span>
<span id="cb573-3"><a href="線形回帰.html#cb573-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">fitted =</span> result<span class="sc">$</span>fitted.values) <span class="sc">%&gt;%</span> </span>
<span id="cb573-4"><a href="線形回帰.html#cb573-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb573-5"><a href="線形回帰.html#cb573-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> y80, <span class="at">y =</span> gr_80_99)) <span class="sc">+</span></span>
<span id="cb573-6"><a href="線形回帰.html#cb573-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> y80, <span class="at">y =</span> fitted))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
</div>
<div id="実証例5.6-ダミー交互作用モデル" class="section level3 unnumbered hasAnchor">
<h3>実証例5.6 ダミー・交互作用モデル<a href="線形回帰.html#実証例5.6-ダミー交互作用モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1980～1999年の年平均経済成長率を、1980年時点の対数GDP水準で説明するモデルに、切片ダミー変数と傾きダミー変数を追加します。</p>
<p>追加するダミー変数は、人口集中地区に居住する割合を示す変数（<code>did</code>）が0.4より大きいときに1をとる「都市化ダミー」です。</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="線形回帰.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 都市化ダミー変数を追加</span></span>
<span id="cb574-2"><a href="線形回帰.html#cb574-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb574-3"><a href="線形回帰.html#cb574-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dummy_1 =</span> <span class="dv">1</span> <span class="sc">*</span> (did <span class="sc">&gt;</span> <span class="fl">0.4</span>))</span></code></pre></div>
<p>傾きダミー変数と1980年時点の対数GDP水準の交差項は、<code>dummy * ln_y80</code>として<code>lm_robust()</code>関数の回帰式に含めます。</p>
<p>推定結果をみると、切片ダミーの係数は-0.176、傾きダミーの係数は0.064となっていますが、p値はどちらも0.05より大きく有意ではありません。</p>
<p>なお、1980年時点の対数GDP水準の係数-1.911は、1980年時点のGDPが1％増加すると、1980～1999年の年平均経済成長率が1.911％ポイント低下することを意味しています。</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="線形回帰.html#cb575-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">lm_robust</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> dummy_1 <span class="sc">+</span> ln_y80 <span class="sc">+</span> dummy_1 <span class="sc">*</span> ln_y80,</span>
<span id="cb575-2"><a href="線形回帰.html#cb575-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> data,</span>
<span id="cb575-3"><a href="線形回帰.html#cb575-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">se_type =</span> <span class="st">&quot;HC1&quot;</span>,</span>
<span id="cb575-4"><a href="線形回帰.html#cb575-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb575-5"><a href="線形回帰.html#cb575-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb575-6"><a href="線形回帰.html#cb575-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## estimatr::lm_robust(formula = gr_80_99 ~ dummy_1 + ln_y80 + dummy_1 * 
##     ln_y80, data = data, se_type = &quot;HC1&quot;, alpha = 0.05)
## 
## Standard error type:  HC1 
## 
## Coefficients:
##                Estimate Std. Error t value  Pr(&gt;|t|) CI Lower CI Upper DF
## (Intercept)     5.74905     0.8019  7.1692 7.325e-09    4.132   7.3663 43
## dummy_1        -0.17551     0.9498 -0.1848 8.543e-01   -2.091   1.7399 43
## ln_y80         -1.91120     0.6545 -2.9199 5.554e-03   -3.231  -0.5912 43
## dummy_1:ln_y80  0.06441     0.7481  0.0861 9.318e-01   -1.444   1.5730 43
## 
## Multiple R-squared:  0.5564 ,    Adjusted R-squared:  0.5254 
## F-statistic: 20.39 on 3 and 43 DF,  p-value: 2.26e-08</code></pre>
</div>
<div id="実証例5.7-ダミー交互作用モデル" class="section level3 unnumbered hasAnchor">
<h3>実証例5.7 ダミー・交互作用モデル<a href="線形回帰.html#実証例5.7-ダミー交互作用モデル" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1980～1999年の年平均経済成長率を、実証例5.6で作成した都市化ダミー変数と、1980年時点の対数GDP水準が1.4より大きい場合に1をとる「豊かさダミー変数」で説明するモデルを推定します。</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="線形回帰.html#cb577-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 豊かさダミー変数を追加</span></span>
<span id="cb577-2"><a href="線形回帰.html#cb577-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb577-3"><a href="線形回帰.html#cb577-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">dummy_2 =</span> <span class="dv">1</span> <span class="sc">*</span> (ln_y80 <span class="sc">&gt;</span> <span class="fl">1.4</span>))</span></code></pre></div>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="線形回帰.html#cb578-1" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> estimatr<span class="sc">::</span><span class="fu">lm_robust</span>(<span class="at">formula =</span> gr_80_99 <span class="sc">~</span> dummy_1 <span class="sc">+</span> dummy_2 <span class="sc">+</span> dummy_1 <span class="sc">*</span> dummy_2,</span>
<span id="cb578-2"><a href="線形回帰.html#cb578-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> data,</span>
<span id="cb578-3"><a href="線形回帰.html#cb578-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">se_type =</span> <span class="st">&quot;HC1&quot;</span>,</span>
<span id="cb578-4"><a href="線形回帰.html#cb578-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">alpha =</span> <span class="fl">0.05</span>)</span>
<span id="cb578-5"><a href="線形回帰.html#cb578-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb578-6"><a href="線形回帰.html#cb578-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span></code></pre></div>
<pre><code>## 
## Call:
## estimatr::lm_robust(formula = gr_80_99 ~ dummy_1 + dummy_2 + 
##     dummy_1 * dummy_2, data = data, se_type = &quot;HC1&quot;, alpha = 0.05)
## 
## Standard error type:  HC1 
## 
## Coefficients:
##                 Estimate Std. Error t value  Pr(&gt;|t|) CI Lower  CI Upper DF
## (Intercept)      3.45474    0.07453 46.3533 2.398e-38   3.3044  3.605044 43
## dummy_1         -0.23329    0.11212 -2.0808 4.345e-02  -0.4594 -0.007186 43
## dummy_2         -0.58003    0.20057 -2.8919 5.985e-03  -0.9845 -0.175540 43
## dummy_1:dummy_2  0.04725    0.23525  0.2009 8.418e-01  -0.4272  0.521687 43
## 
## Multiple R-squared:  0.4982 ,    Adjusted R-squared:  0.4631 
## F-statistic:  15.3 on 3 and 43 DF,  p-value: 6.445e-07</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="探索的データ分析.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlights": true
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
