<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 ggplot2によるグラフ作成 | エコノミストのためのR</title>
  <meta name="description" content="5 ggplot2によるグラフ作成 | エコノミストのためのR" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="5 ggplot2によるグラフ作成 | エコノミストのためのR" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="naohat23/econ-code-bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 ggplot2によるグラフ作成 | エコノミストのためのR" />
  
  
  

<meta name="author" content="服部直樹" />


<meta name="date" content="2022-06-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="時系列データ操作.html"/>
<link rel="next" href="探索的データ分析.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://naohat23.github.io/econ-code-bookdown">エコノミストのためのR</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>はじめに</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#なぜrを使うのか"><i class="fa fa-check"></i>なぜRを使うのか？</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#本書で出来ること"><i class="fa fa-check"></i>本書で出来ること　</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#本書で出来ないこと"><i class="fa fa-check"></i>本書で出来ないこと</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#目次"><i class="fa fa-check"></i>目次</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#参考文献ウェブサイト"><i class="fa fa-check"></i>参考文献・ウェブサイト</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#rの使用方法"><i class="fa fa-check"></i>Rの使用方法</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#計量経済学"><i class="fa fa-check"></i>計量経済学</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rの設定.html"><a href="rの設定.html"><i class="fa fa-check"></i><b>1</b> Rの設定</a>
<ul>
<li class="chapter" data-level="1.1" data-path="rの設定.html"><a href="rの設定.html#設定全般"><i class="fa fa-check"></i><b>1.1</b> 設定全般</a>
<ul>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#rのインストール"><i class="fa fa-check"></i>Rのインストール</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#rのバージョン確認"><i class="fa fa-check"></i>Rのバージョン確認</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#セッション情報の確認"><i class="fa fa-check"></i>セッション情報の確認</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#オブジェクトを全削除"><i class="fa fa-check"></i>オブジェクトを全削除</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#警告の非表示"><i class="fa fa-check"></i>警告の非表示</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#関数が出力する警告やメッセージの非表示"><i class="fa fa-check"></i>関数が出力する警告やメッセージの非表示</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="rの設定.html"><a href="rの設定.html#プロキシサーバーの設定"><i class="fa fa-check"></i><b>1.2</b> プロキシサーバーの設定</a></li>
<li class="chapter" data-level="1.3" data-path="rの設定.html"><a href="rの設定.html#パッケージ"><i class="fa fa-check"></i><b>1.3</b> パッケージ</a>
<ul>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#使用するパッケージ一覧"><i class="fa fa-check"></i>使用するパッケージ一覧</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#パッケージのインストールとインポート"><i class="fa fa-check"></i>パッケージのインストールとインポート</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="rの設定.html"><a href="rの設定.html#グラフの設定"><i class="fa fa-check"></i><b>1.4</b> グラフの設定</a>
<ul>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#グラフのテーマ設定"><i class="fa fa-check"></i>グラフのテーマ設定</a></li>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#グラフのフォント設定"><i class="fa fa-check"></i>グラフのフォント設定</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="rの設定.html"><a href="rの設定.html#サンプルデータセット"><i class="fa fa-check"></i><b>1.5</b> サンプルデータセット</a>
<ul>
<li class="chapter" data-level="" data-path="rの設定.html"><a href="rの設定.html#rのサンプルデータセット"><i class="fa fa-check"></i>Rのサンプルデータセット</a></li>
<li class="chapter" data-level="1.5.1" data-path="rの設定.html"><a href="rの設定.html#外部データセット"><i class="fa fa-check"></i><b>1.5.1</b> 外部データセット</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="rの設定.html"><a href="rの設定.html#r起動時に実行する設定"><i class="fa fa-check"></i><b>1.6</b> R起動時に実行する設定</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html"><i class="fa fa-check"></i><b>2</b> Rの基本的な使用方法</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#主要ショートカットキー"><i class="fa fa-check"></i><b>2.1</b> 主要ショートカットキー</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#編集"><i class="fa fa-check"></i>編集</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#実行"><i class="fa fa-check"></i>実行</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#その他"><i class="fa fa-check"></i>その他</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#基本操作"><i class="fa fa-check"></i><b>2.2</b> 基本操作</a></li>
<li class="chapter" data-level="2.3" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#演算"><i class="fa fa-check"></i><b>2.3</b> 演算</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#四則計算"><i class="fa fa-check"></i>四則計算</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#数値計算"><i class="fa fa-check"></i>数値計算</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#一致大小関係"><i class="fa fa-check"></i>一致・大小関係</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#包含集合関係"><i class="fa fa-check"></i>包含・集合関係</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ベクトル"><i class="fa fa-check"></i><b>2.4</b> ベクトル</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ベクトルの作成"><i class="fa fa-check"></i>ベクトルの作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ベクトル要素へのアクセス"><i class="fa fa-check"></i>ベクトル要素へのアクセス</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#規則性があるベクトルの作成"><i class="fa fa-check"></i>規則性があるベクトルの作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ベクトルの演算"><i class="fa fa-check"></i>ベクトルの演算</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#行列"><i class="fa fa-check"></i><b>2.5</b> 行列</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#行列の作成"><i class="fa fa-check"></i>行列の作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#行列の要素へのアクセス"><i class="fa fa-check"></i>行列の要素へのアクセス</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#行列の演算"><i class="fa fa-check"></i>行列の演算</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データフレーム"><i class="fa fa-check"></i><b>2.6</b> データフレーム</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データフレームの作成"><i class="fa fa-check"></i>データフレームの作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データフレームの要素へのアクセス"><i class="fa fa-check"></i>データフレームの要素へのアクセス</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#その他のデータフレームの機能"><i class="fa fa-check"></i>その他のデータフレームの機能</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#リスト"><i class="fa fa-check"></i><b>2.7</b> リスト</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#リストの作成"><i class="fa fa-check"></i>リストの作成</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#リストの要素へのアクセス"><i class="fa fa-check"></i>リストの要素へのアクセス</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#制御構文"><i class="fa fa-check"></i><b>2.8</b> 制御構文</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ifelse文"><i class="fa fa-check"></i>if/else文</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#forループ"><i class="fa fa-check"></i>forループ</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#whileループ"><i class="fa fa-check"></i>whileループ</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#breakによる繰り返しの終了"><i class="fa fa-check"></i>breakによる繰り返しの終了</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#tryによるエラー処理"><i class="fa fa-check"></i>tryによるエラー処理</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#データの読み込み書き出し"><i class="fa fa-check"></i><b>2.9</b> データの読み込み・書き出し</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#csvデータの読み込み"><i class="fa fa-check"></i>CSVデータの読み込み</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#excelデータの読み込みxls形式"><i class="fa fa-check"></i>Excelデータの読み込み（xls形式）</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#excelデータの読み込みxlsx形式"><i class="fa fa-check"></i>Excelデータの読み込み（xlsx形式）</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#csvデータの書き出し"><i class="fa fa-check"></i>CSVデータの書き出し</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#オブジェクトのセーブロード"><i class="fa fa-check"></i><b>2.10</b> オブジェクトのセーブ・ロード</a>
<ul>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#セーブ"><i class="fa fa-check"></i>セーブ</a></li>
<li class="chapter" data-level="" data-path="rの基本的な使用方法.html"><a href="rの基本的な使用方法.html#ロード"><i class="fa fa-check"></i>ロード</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html"><i class="fa fa-check"></i><b>3</b> tidyverseによるデータ操作</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#第3章の準備"><i class="fa fa-check"></i><b>3.1</b> 第3章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#パッケージのインポート"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#外部データセットの取得"><i class="fa fa-check"></i>外部データセットの取得</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#tidyverseとは"><i class="fa fa-check"></i><b>3.2</b> tidyverseとは</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#tidy-data縦型横型データ"><i class="fa fa-check"></i>tidy data（縦型・横型データ）</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#tidyverseの特徴"><i class="fa fa-check"></i>tidyverseの特徴</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列の選択"><i class="fa fa-check"></i><b>3.3</b> 列の選択</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名で選択"><i class="fa fa-check"></i>列名で選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名を格納したベクトルで選択"><i class="fa fa-check"></i>列名を格納したベクトルで選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列を非選択削除"><i class="fa fa-check"></i>列を非選択（削除）</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名に特定の文字列を含む列を選択"><i class="fa fa-check"></i>列名に特定の文字列を含む列を選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名が特定の文字列から始まる列を選択"><i class="fa fa-check"></i>列名が特定の文字列から始まる列を選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名が特定の文字列で終わる列を選択"><i class="fa fa-check"></i>列名が特定の文字列で終わる列を選択</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#特定の型の列を選択"><i class="fa fa-check"></i>特定の型の列を選択</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列名の変更"><i class="fa fa-check"></i><b>3.4</b> 列名の変更</a></li>
<li class="chapter" data-level="3.5" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#行のフィルタ"><i class="fa fa-check"></i><b>3.5</b> 行のフィルタ</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#条件に一致する行"><i class="fa fa-check"></i>条件に一致する行</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#条件に一致しない行not条件"><i class="fa fa-check"></i>条件に一致しない行（NOT条件）</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数条件"><i class="fa fa-check"></i>複数条件</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#andor条件を明示的に指定した複数条件"><i class="fa fa-check"></i>AND・OR条件を明示的に指定した複数条件</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#in演算子によるor条件"><i class="fa fa-check"></i><code>%in%</code>演算子によるOR条件</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#or条件の否定"><i class="fa fa-check"></i>OR条件の否定</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#関数による条件指定"><i class="fa fa-check"></i>関数による条件指定</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#論理値を返す関数による条件指定"><i class="fa fa-check"></i>論理値を返す関数による条件指定</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#行の並べ替え"><i class="fa fa-check"></i><b>3.6</b> 行の並べ替え</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#昇順ソート"><i class="fa fa-check"></i>昇順ソート</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#降順ソート"><i class="fa fa-check"></i>降順ソート</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#降順ソート日付型"><i class="fa fa-check"></i>降順ソート（日付型）</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数条件によるソート"><i class="fa fa-check"></i>複数条件によるソート</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#列の作成修正"><i class="fa fa-check"></i><b>3.7</b> 列の作成・修正</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#新たな列の作成"><i class="fa fa-check"></i>新たな列の作成</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#既存の列の修正"><i class="fa fa-check"></i>既存の列の修正</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#条件付き系列の作成"><i class="fa fa-check"></i>条件付き系列の作成</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数列の一括処理"><i class="fa fa-check"></i>複数列の一括処理</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#グループ化"><i class="fa fa-check"></i><b>3.8</b> グループ化</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#単一の列でグループ化"><i class="fa fa-check"></i>単一の列でグループ化</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数の列でグループ化"><i class="fa fa-check"></i>複数の列でグループ化</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#グループ化フィルタ"><i class="fa fa-check"></i>グループ化＆フィルタ</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#グループ化の解除"><i class="fa fa-check"></i>グループ化の解除</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#集計"><i class="fa fa-check"></i><b>3.9</b> 集計</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#グループ別の集計"><i class="fa fa-check"></i>グループ別の集計</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#クロス集計"><i class="fa fa-check"></i>クロス集計</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#複数列の一括処理-1"><i class="fa fa-check"></i>複数列の一括処理</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#縦型横型の変換"><i class="fa fa-check"></i><b>3.10</b> 縦型・横型の変換</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#縦型データを横型データに変換"><i class="fa fa-check"></i>縦型データを横型データに変換</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#横型データを縦型データに変換"><i class="fa fa-check"></i>横型データを縦型データに変換</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#データの結合"><i class="fa fa-check"></i><b>3.11</b> データの結合</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#内部結合"><i class="fa fa-check"></i>内部結合</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#左外部結合"><i class="fa fa-check"></i>左外部結合</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#右外部結合"><i class="fa fa-check"></i>右外部結合</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#完全外部結合"><i class="fa fa-check"></i>完全外部結合</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#重複処理"><i class="fa fa-check"></i><b>3.12</b> 重複処理</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#重複行の抽出"><i class="fa fa-check"></i>重複行の抽出</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#重複行の削除"><i class="fa fa-check"></i>重複行の削除</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#欠損値処理"><i class="fa fa-check"></i><b>3.13</b> 欠損値処理</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#naの削除"><i class="fa fa-check"></i>NAの削除</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#naの置換"><i class="fa fa-check"></i>NAの置換</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#naのフィル"><i class="fa fa-check"></i>NAのフィル</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#補完処理"><i class="fa fa-check"></i><b>3.14</b> 補完処理</a>
<ul>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#組み合わせ候補の補完"><i class="fa fa-check"></i>組み合わせ候補の補完</a></li>
<li class="chapter" data-level="" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#時系列データの補完"><i class="fa fa-check"></i>時系列データの補完</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="tidyverseによるデータ操作.html"><a href="tidyverseによるデータ操作.html#サンプリング"><i class="fa fa-check"></i><b>3.15</b> サンプリング</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="時系列データ操作.html"><a href="時系列データ操作.html"><i class="fa fa-check"></i><b>4</b> 時系列データ操作</a>
<ul>
<li class="chapter" data-level="4.1" data-path="時系列データ操作.html"><a href="時系列データ操作.html#第4章の準備"><i class="fa fa-check"></i><b>4.1</b> 第4章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#パッケージのインポート-1"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#外部データセットの取得-1"><i class="fa fa-check"></i>外部データセットの取得</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="時系列データ操作.html"><a href="時系列データ操作.html#データ変換"><i class="fa fa-check"></i><b>4.2</b> データ変換</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ラグリード系列の作成"><i class="fa fa-check"></i>ラグ・リード系列の作成</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#変化率系列の作成"><i class="fa fa-check"></i>変化率系列の作成</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#移動平均系列の作成"><i class="fa fa-check"></i>移動平均系列の作成</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="時系列データ操作.html"><a href="時系列データ操作.html#時系列データの頻度変換"><i class="fa fa-check"></i><b>4.3</b> 時系列データの頻度変換</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データを週次データに変換"><i class="fa fa-check"></i>日次データを週次データに変換</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データを月次データに変換"><i class="fa fa-check"></i>日次データを月次データに変換</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データを四半期データに変換"><i class="fa fa-check"></i>日次データを四半期データに変換</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="時系列データ操作.html"><a href="時系列データ操作.html#季節調整x-13"><i class="fa fa-check"></i><b>4.4</b> 季節調整（X-13）</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="時系列データ操作.html"><a href="時系列データ操作.html#ts型データの可視化"><i class="fa fa-check"></i><b>4.4.1</b> ts型データの可視化</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#x-13arima-seatsの実施方法"><i class="fa fa-check"></i>X-13ARIMA-SEATSの実施方法</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#実例月次データの季節調整"><i class="fa fa-check"></i>実例：月次データの季節調整</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="時系列データ操作.html"><a href="時系列データ操作.html#季節調整stl分解"><i class="fa fa-check"></i><b>4.5</b> 季節調整（STL分解）</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="時系列データ操作.html"><a href="時系列データ操作.html#stl分解の実施方法"><i class="fa fa-check"></i><b>4.5.1</b> STL分解の実施方法</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#週次データのstl分解"><i class="fa fa-check"></i>週次データのSTL分解</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データのstl分解単一周期"><i class="fa fa-check"></i>日次データのSTL分解（単一周期）</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#日次データのstl分解複数周期"><i class="fa fa-check"></i>日次データのSTL分解（複数周期）</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="時系列データ操作.html"><a href="時系列データ操作.html#トレンド推定"><i class="fa fa-check"></i><b>4.6</b> トレンド推定</a>
<ul>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#hpフィルタ"><i class="fa fa-check"></i>HPフィルタ</a></li>
<li class="chapter" data-level="" data-path="時系列データ操作.html"><a href="時系列データ操作.html#一般化加法モデルgam"><i class="fa fa-check"></i>一般化加法モデル（GAM）</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html"><i class="fa fa-check"></i><b>5</b> ggplot2によるグラフ作成</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#第5章の準備"><i class="fa fa-check"></i><b>5.1</b> 第5章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#パッケージのインポート-2"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#外部データセットの取得-2"><i class="fa fa-check"></i>外部データセットの取得</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ggplot2とは"><i class="fa fa-check"></i><b>5.2</b> ggplot2とは</a></li>
<li class="chapter" data-level="5.3" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ggplot2の設定"><i class="fa fa-check"></i><b>5.3</b> ggplot2の設定</a></li>
<li class="chapter" data-level="5.4" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#gui形式の直感的なグラフ作成"><i class="fa fa-check"></i><b>5.4</b> GUI形式の直感的なグラフ作成</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#esquisseパッケージ"><i class="fa fa-check"></i>esquisseパッケージ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ggplotguiパッケージ"><i class="fa fa-check"></i>ggplotguiパッケージ</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の度数分布離散型"><i class="fa fa-check"></i><b>5.5</b> 1次元の度数分布（離散型）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#度数棒グラフの基本形"><i class="fa fa-check"></i>度数棒グラフの基本形</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の度数分布連続型"><i class="fa fa-check"></i><b>5.6</b> 1次元の度数分布（連続型）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ヒストグラムの基本形"><i class="fa fa-check"></i>ヒストグラムの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#横並びヒストグラム"><i class="fa fa-check"></i>横並びヒストグラム</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げヒストグラム"><i class="fa fa-check"></i>積み上げヒストグラム</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の密度グラフ"><i class="fa fa-check"></i><b>5.7</b> 1次元の密度グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#密度グラフの基本形"><i class="fa fa-check"></i>密度グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#横並び密度グラフ"><i class="fa fa-check"></i>横並び密度グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ密度グラフ"><i class="fa fa-check"></i>積み上げ密度グラフ</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の度数分布離散型-1"><i class="fa fa-check"></i><b>5.8</b> 2次元の度数分布（離散型）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#度数バブルチャートの基本形"><i class="fa fa-check"></i>度数バブルチャートの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#度数ヒートマップの基本形"><i class="fa fa-check"></i>度数ヒートマップの基本形</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の度数分布連続型-1"><i class="fa fa-check"></i><b>5.9</b> 2次元の度数分布（連続型）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#度数ヒートマップの基本形-1"><i class="fa fa-check"></i>度数ヒートマップの基本形</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元の密度グラフ-1"><i class="fa fa-check"></i><b>5.10</b> 2次元の密度グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元密度グラフの基本形"><i class="fa fa-check"></i>2次元密度グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#次元密度グラフの塗りつぶし版"><i class="fa fa-check"></i>2次元密度グラフの塗りつぶし版</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#qqプロット"><i class="fa fa-check"></i><b>5.11</b> QQプロット</a></li>
<li class="chapter" data-level="5.12" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図バブルチャート"><i class="fa fa-check"></i><b>5.12</b> 散布図・バブルチャート</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図の基本形"><i class="fa fa-check"></i>散布図の基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#バブルチャートの基本形"><i class="fa fa-check"></i>バブルチャートの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図に補助線を追加"><i class="fa fa-check"></i>散布図に補助線を追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図にコネクタ線を追加"><i class="fa fa-check"></i>散布図にコネクタ線を追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図に近似曲線を追加"><i class="fa fa-check"></i>散布図に近似曲線を追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#散布図にラベルを追加"><i class="fa fa-check"></i>散布図にラベルを追加</a></li>
<li class="chapter" data-level="5.12.1" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#バブルチャートにラベルを追加"><i class="fa fa-check"></i><b>5.12.1</b> バブルチャートにラベルを追加</a></li>
</ul></li>
<li class="chapter" data-level="5.13" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#棒グラフ"><i class="fa fa-check"></i><b>5.13</b> 棒グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#縦棒グラフの基本形"><i class="fa fa-check"></i>縦棒グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#横棒グラフ"><i class="fa fa-check"></i>横棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#縦棒グラフの順序並べ替え"><i class="fa fa-check"></i>縦棒グラフの順序並べ替え</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#縦棒グラフにラベルを追加"><i class="fa fa-check"></i>縦棒グラフにラベルを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#集合縦棒グラフ"><i class="fa fa-check"></i>集合縦棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフ"><i class="fa fa-check"></i>積み上げ縦棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフにラベルを追加"><i class="fa fa-check"></i>積み上げ縦棒グラフにラベルを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフ-1"><i class="fa fa-check"></i>100％積み上げ縦棒グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフにラベルを追加-1"><i class="fa fa-check"></i>100％積み上げ縦棒グラフにラベルを追加</a></li>
</ul></li>
<li class="chapter" data-level="5.14" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#円グラフ"><i class="fa fa-check"></i><b>5.14</b> 円グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#円グラフの基本形"><i class="fa fa-check"></i>円グラフの基本形</a></li>
</ul></li>
<li class="chapter" data-level="5.15" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#折れ線グラフ"><i class="fa fa-check"></i><b>5.15</b> 折れ線グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#折れ線グラフの基本形"><i class="fa fa-check"></i>折れ線グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#折れ線グラフにマーカーを追加"><i class="fa fa-check"></i>折れ線グラフにマーカーを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#折れ線グラフに系列ラベルを追加"><i class="fa fa-check"></i>折れ線グラフに系列ラベルを追加</a></li>
</ul></li>
<li class="chapter" data-level="5.16" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ステップグラフ"><i class="fa fa-check"></i><b>5.16</b> ステップグラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ステップグラフの基本形"><i class="fa fa-check"></i>ステップグラフの基本形</a></li>
</ul></li>
<li class="chapter" data-level="5.17" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#面グラフ"><i class="fa fa-check"></i><b>5.17</b> 面グラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#面グラフの基本形"><i class="fa fa-check"></i>面グラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#積み上げ面グラフ"><i class="fa fa-check"></i>積み上げ面グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#リボングラフの基本形"><i class="fa fa-check"></i>リボングラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#リボングラフに折れ線グラフを追加"><i class="fa fa-check"></i>リボングラフに折れ線グラフを追加</a></li>
</ul></li>
<li class="chapter" data-level="5.18" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#箱ひげ図ヴァイオリングラフ"><i class="fa fa-check"></i><b>5.18</b> 箱ひげ図・ヴァイオリングラフ</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#箱ひげ図の基本形"><i class="fa fa-check"></i>箱ひげ図の基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#箱ひげ図に個別サンプルを追加"><i class="fa fa-check"></i>箱ひげ図に個別サンプルを追加</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ヴァイオリングラフの基本形"><i class="fa fa-check"></i>ヴァイオリングラフの基本形</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ヴァイオリングラフに個別サンプルを追加"><i class="fa fa-check"></i>ヴァイオリングラフに個別サンプルを追加</a></li>
</ul></li>
<li class="chapter" data-level="5.19" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ドットプロット"><i class="fa fa-check"></i><b>5.19</b> ドットプロット</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ドットプロットの基本形"><i class="fa fa-check"></i>ドットプロットの基本形</a></li>
</ul></li>
<li class="chapter" data-level="5.20" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#色の設定"><i class="fa fa-check"></i><b>5.20</b> 色の設定</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#色の手動指定離散型変数"><i class="fa fa-check"></i>色の手動指定（離散型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#brewerカラーパレット離散型変数"><i class="fa fa-check"></i>Brewerカラーパレット（離散型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#viridisカラーパレット離散型変数"><i class="fa fa-check"></i>Viridisカラーパレット（離散型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#ggsciカラーパレット離散型変数"><i class="fa fa-check"></i>ggsciカラーパレット（離散型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#distillerカラーパレット連続型変数"><i class="fa fa-check"></i>distillerカラーパレット（連続型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#viridisカラーパレット連続型変数"><i class="fa fa-check"></i>Viridisカラーパレット（連続型変数）</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#gradientカラーパレット連続型変数"><i class="fa fa-check"></i>gradientカラーパレット（連続型変数）</a></li>
</ul></li>
<li class="chapter" data-level="5.21" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#軸の設定"><i class="fa fa-check"></i><b>5.21</b> 軸の設定</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#x軸連続型y軸連続型"><i class="fa fa-check"></i>X軸：連続型、Y軸：連続型</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#対数目盛"><i class="fa fa-check"></i>対数目盛</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#x軸日付型y軸連続型"><i class="fa fa-check"></i>X軸：日付型、Y軸：連続型</a></li>
</ul></li>
<li class="chapter" data-level="5.22" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#複合グラフファセット"><i class="fa fa-check"></i><b>5.22</b> 複合グラフ（ファセット）</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#行方向の複合グラフ"><i class="fa fa-check"></i>行方向の複合グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#列方向の複合グラフ"><i class="fa fa-check"></i>列方向の複合グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#行列方向の複合グラフ"><i class="fa fa-check"></i>行・列方向の複合グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#行数列数を指定した複合グラフ"><i class="fa fa-check"></i>行数・列数を指定した複合グラフ</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#複合グラフの設定"><i class="fa fa-check"></i>複合グラフの設定</a></li>
</ul></li>
<li class="chapter" data-level="5.23" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#地図ファセット"><i class="fa fa-check"></i><b>5.23</b> 地図ファセット</a></li>
<li class="chapter" data-level="5.24" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#その他設定保存"><i class="fa fa-check"></i><b>5.24</b> その他設定・保存</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#タイトルキャプション"><i class="fa fa-check"></i>タイトル・キャプション</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#パネル目盛線"><i class="fa fa-check"></i>パネル目盛線</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#凡例"><i class="fa fa-check"></i>凡例</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#フォントマージン設定"><i class="fa fa-check"></i>フォント・マージン設定</a></li>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#保存"><i class="fa fa-check"></i>保存</a></li>
</ul></li>
<li class="chapter" data-level="5.25" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#実例"><i class="fa fa-check"></i><b>5.25</b> 実例</a>
<ul>
<li class="chapter" data-level="" data-path="ggplot2によるグラフ作成.html"><a href="ggplot2によるグラフ作成.html#実例1世界の新型コロナ死亡率の箱ひげ図"><i class="fa fa-check"></i>実例1：世界の新型コロナ死亡率の箱ひげ図</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="探索的データ分析.html"><a href="探索的データ分析.html"><i class="fa fa-check"></i><b>6</b> 探索的データ分析</a>
<ul>
<li class="chapter" data-level="6.1" data-path="探索的データ分析.html"><a href="探索的データ分析.html#第6章の準備"><i class="fa fa-check"></i><b>6.1</b> 第6章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#パッケージのインポート-3"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#ggplot2の設定-1"><i class="fa fa-check"></i>ggplot2の設定</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="探索的データ分析.html"><a href="探索的データ分析.html#データの中身記述統計量"><i class="fa fa-check"></i><b>6.2</b> データの中身（記述統計量）</a></li>
<li class="chapter" data-level="6.3" data-path="探索的データ分析.html"><a href="探索的データ分析.html#データの分布"><i class="fa fa-check"></i><b>6.3</b> データの分布</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="探索的データ分析.html"><a href="探索的データ分析.html#離散型変数の度数分布"><i class="fa fa-check"></i><b>6.3.1</b> 離散型変数の度数分布</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#連続型変数の度数分布"><i class="fa fa-check"></i>連続型変数の度数分布</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#外れ値"><i class="fa fa-check"></i>外れ値</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="探索的データ分析.html"><a href="探索的データ分析.html#データの関係性"><i class="fa fa-check"></i><b>6.4</b> データの関係性</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#離散型変数の関係性"><i class="fa fa-check"></i>離散型変数の関係性</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#連続型変数の関係性"><i class="fa fa-check"></i>連続型変数の関係性</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="探索的データ分析.html"><a href="探索的データ分析.html#相関関係ペアプロット"><i class="fa fa-check"></i><b>6.5</b> 相関関係・ペアプロット</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#相関係数行列"><i class="fa fa-check"></i>相関係数行列</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#corrplotパッケージ"><i class="fa fa-check"></i>corrplotパッケージ</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#corrrパッケージ"><i class="fa fa-check"></i>corrrパッケージ</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#ggallyパッケージ"><i class="fa fa-check"></i>GGallyパッケージ</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="探索的データ分析.html"><a href="探索的データ分析.html#探索的データ分析の一括実行"><i class="fa fa-check"></i><b>6.6</b> 探索的データ分析の一括実行</a>
<ul>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#dataexplorerパッケージ"><i class="fa fa-check"></i>DataExplorerパッケージ</a></li>
<li class="chapter" data-level="" data-path="探索的データ分析.html"><a href="探索的データ分析.html#smartedaパッケージ"><i class="fa fa-check"></i>SmartEDAパッケージ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="線形回帰.html"><a href="線形回帰.html"><i class="fa fa-check"></i><b>7</b> 線形回帰</a>
<ul>
<li class="chapter" data-level="7.1" data-path="線形回帰.html"><a href="線形回帰.html#第7章の準備"><i class="fa fa-check"></i><b>7.1</b> 第7章の準備</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#パッケージのインポート-4"><i class="fa fa-check"></i>パッケージのインポート</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#外部データセットの取得-3"><i class="fa fa-check"></i>外部データセットの取得</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="線形回帰.html"><a href="線形回帰.html#用語の説明"><i class="fa fa-check"></i><b>7.2</b> 用語の説明</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#標本と推定"><i class="fa fa-check"></i>標本と推定</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#推定量の望ましい性質"><i class="fa fa-check"></i>推定量の望ましい性質</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="線形回帰.html"><a href="線形回帰.html#最小2乗法ols"><i class="fa fa-check"></i><b>7.3</b> 最小2乗法（OLS）</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#最小2乗法の仮定"><i class="fa fa-check"></i>最小2乗法の仮定</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#検定と信頼区間"><i class="fa fa-check"></i>検定と信頼区間</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="線形回帰.html"><a href="線形回帰.html#モデルの種類と係数の解釈"><i class="fa fa-check"></i><b>7.4</b> モデルの種類と係数の解釈</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#水準モデル"><i class="fa fa-check"></i>水準モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#対数モデル"><i class="fa fa-check"></i>対数モデル</a></li>
<li class="chapter" data-level="7.4.1" data-path="線形回帰.html"><a href="線形回帰.html#変化率モデル"><i class="fa fa-check"></i><b>7.4.1</b> 変化率モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#多項式モデル"><i class="fa fa-check"></i>多項式モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#交互作用モデル"><i class="fa fa-check"></i>交互作用モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#ダミー変数"><i class="fa fa-check"></i>ダミー変数</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="線形回帰.html"><a href="線形回帰.html#単回帰モデル"><i class="fa fa-check"></i><b>7.5</b> 単回帰モデル</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例4.1-線形単回帰"><i class="fa fa-check"></i>実証例4.1 線形単回帰</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#対数変化率モデルの推定"><i class="fa fa-check"></i>対数・変化率モデルの推定</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="線形回帰.html"><a href="線形回帰.html#重回帰モデル"><i class="fa fa-check"></i><b>7.6</b> 重回帰モデル</a>
<ul>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#欠落変数バイアス"><i class="fa fa-check"></i>欠落変数バイアス</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#多重共線性"><i class="fa fa-check"></i>多重共線性</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#変数選択の指針"><i class="fa fa-check"></i>変数選択の指針</a></li>
<li class="chapter" data-level="7.6.1" data-path="線形回帰.html"><a href="線形回帰.html#実証例5.15.4-線形重回帰"><i class="fa fa-check"></i><b>7.6.1</b> 実証例5.1・5.4 線形重回帰</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例5.5-多項式モデル"><i class="fa fa-check"></i>実証例5.5 多項式モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例5.6-ダミー交互作用モデル"><i class="fa fa-check"></i>実証例5.6 ダミー・交互作用モデル</a></li>
<li class="chapter" data-level="" data-path="線形回帰.html"><a href="線形回帰.html#実証例5.7-ダミー交互作用モデル"><i class="fa fa-check"></i>実証例5.7 ダミー・交互作用モデル</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">エコノミストのためのR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot2によるグラフ作成" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> ggplot2によるグラフ作成<a href="ggplot2によるグラフ作成.html#ggplot2によるグラフ作成" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>第5章「ggplot2によるグラフ作成」では、<code>tidyverse</code>の<code>ggplot2</code>パッケージを主に使用したグラフ作成方法について解説します。</p>
<div id="第5章の準備" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> 第5章の準備<a href="ggplot2によるグラフ作成.html#第5章の準備" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="パッケージのインポート-2" class="section level3 unnumbered hasAnchor">
<h3>パッケージのインポート<a href="ggplot2によるグラフ作成.html#パッケージのインポート-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="ggplot2によるグラフ作成.html#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(esquisse)</span>
<span id="cb381-2"><a href="ggplot2によるグラフ作成.html#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geofacet)</span>
<span id="cb381-3"><a href="ggplot2によるグラフ作成.html#cb381-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplotgui)</span>
<span id="cb381-4"><a href="ggplot2によるグラフ作成.html#cb381-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb381-5"><a href="ggplot2によるグラフ作成.html#cb381-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsci)</span>
<span id="cb381-6"><a href="ggplot2によるグラフ作成.html#cb381-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb381-7"><a href="ggplot2によるグラフ作成.html#cb381-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lemon)</span>
<span id="cb381-8"><a href="ggplot2によるグラフ作成.html#cb381-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb381-9"><a href="ggplot2によるグラフ作成.html#cb381-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb381-10"><a href="ggplot2によるグラフ作成.html#cb381-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb381-11"><a href="ggplot2によるグラフ作成.html#cb381-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb381-12"><a href="ggplot2によるグラフ作成.html#cb381-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="外部データセットの取得-2" class="section level3 unnumbered hasAnchor">
<h3>外部データセットの取得<a href="ggplot2によるグラフ作成.html#外部データセットの取得-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>この章では、外部データセットとして以下のデータを使用します。第1章のコードを使用してあらかじめウェブからデータセットを取得してください。</p>
<ul>
<li>OWIDのCOVID-19データセット：　<code>data_owid</code></li>
<li>日本の県内総生産：　<code>data_gdp_pref</code></li>
</ul>
</div>
</div>
<div id="ggplot2とは" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> ggplot2とは<a href="ggplot2によるグラフ作成.html#ggplot2とは" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>ggplot2</code>パッケージでは、最初に<code>ggplot()</code>関数でグラフを作成するデータと変数を指定します。その後に、<code>geom_histogram()</code>などのグラフの種類を指定する関数や、<code>scale_x_date</code>などの軸設定の関数、<code>theme()</code>などの各種設定の関数を<code>+</code>演算子で追加していきます。</p>
<p><code>ggplot()</code>関数では、まず<code>data</code>引数に<code>tibble</code>形式の縦型データを指定します。次に<code>mapping</code>引数に<code>aes()</code>関数を指定し、<code>aes()</code>関数の中でX軸やY軸の変数、必要に応じて<code>color</code>や<code>size</code>など変数の値に応じて変化させる色・サイズなどの要素を指定します。</p>
<p>なお、グラフの種類により、X軸、Y軸に指定できる変数の型（連続型、離散型）が決まっていますので、注意してください。</p>
<p><code>ggplot2</code>パッケージの詳細については<a href="https://ggplot2.tidyverse.org/">公式ウェブサイト</a>を参照してください。各関数の使い方については、公式ウェブサイトのチートシートが分かりやすくまとまっています。</p>
</div>
<div id="ggplot2の設定" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> ggplot2の設定<a href="ggplot2によるグラフ作成.html#ggplot2の設定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>第1章で紹介した<code>ggplot2</code>の設定です。</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="ggplot2によるグラフ作成.html#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ggplotのテーマ設定（Excelのグラフと類似したテーマを選択）</span></span>
<span id="cb382-2"><a href="ggplot2によるグラフ作成.html#cb382-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_light</span>())</span>
<span id="cb382-3"><a href="ggplot2によるグラフ作成.html#cb382-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-4"><a href="ggplot2によるグラフ作成.html#cb382-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Windowsにおけるggplot2の日本語フォント設定</span></span>
<span id="cb382-5"><a href="ggplot2によるグラフ作成.html#cb382-5" aria-hidden="true" tabindex="-1"></a><span class="fu">windowsFonts</span>(<span class="st">&quot;MEIRYO&quot;</span> <span class="ot">=</span> <span class="fu">windowsFont</span>(<span class="st">&quot;Meiryo UI&quot;</span>))</span>
<span id="cb382-6"><a href="ggplot2によるグラフ作成.html#cb382-6" aria-hidden="true" tabindex="-1"></a><span class="fu">windowsFonts</span>(<span class="st">&quot;YUGO&quot;</span> <span class="ot">=</span> <span class="fu">windowsFont</span>(<span class="st">&quot;Yu Gothic UI&quot;</span>))</span></code></pre></div>
</div>
<div id="gui形式の直感的なグラフ作成" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> GUI形式の直感的なグラフ作成<a href="ggplot2によるグラフ作成.html#gui形式の直感的なグラフ作成" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>この章では<code>ggplot2</code>パッケージによるグラフ作成方法を紹介しますが、<code>ggplot2</code>はコードを記述してグラフを作成するため、試行錯誤を伴う探索的データ分析（EDA）にはあまり向いていません。</p>
<p>そこで、<code>ggplot2</code>によるグラフ作成を行う前に、GUI形式でコードを記述せずにグラフを作成できるパッケージを用い、どのようなグラフを作成するべきか検討します。</p>
<div id="esquisseパッケージ" class="section level3 unnumbered hasAnchor">
<h3>esquisseパッケージ<a href="ggplot2によるグラフ作成.html#esquisseパッケージ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>esquisse</code>パッケージは、ドラッグ＆ドロップでX軸・Y軸の変数や色・サイズを変化させる属性の変数を指定し、グラフを作成することができる便利なパッケージです。ただし、データセットの規模が大きいと起動に時間がかかるため、変数の数が多い場合は、あらかじめ注目する変数を絞るといった前処理が必要です。</p>
<p>Rで下記のコードを実行すると別のウィンドウで<code>esquisse</code>の画面が立ち上がり、GUI形式でインタラクティブにグラフを作成することができます。ウェブサイト上では実行できないため、各自で試してみてください。</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="ggplot2によるグラフ作成.html#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># irisデータ</span></span>
<span id="cb383-2"><a href="ggplot2によるグラフ作成.html#cb383-2" aria-hidden="true" tabindex="-1"></a>esquisse<span class="sc">::</span><span class="fu">esquisser</span>(<span class="at">data =</span> iris)</span></code></pre></div>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="ggplot2によるグラフ作成.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 世界の新型コロナデータの一部を抽出</span></span>
<span id="cb384-2"><a href="ggplot2によるグラフ作成.html#cb384-2" aria-hidden="true" tabindex="-1"></a>data_owid <span class="sc">%&gt;%</span> </span>
<span id="cb384-3"><a href="ggplot2によるグラフ作成.html#cb384-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(location, date, new_cases_smoothed) <span class="sc">%&gt;%</span> </span>
<span id="cb384-4"><a href="ggplot2によるグラフ作成.html#cb384-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Japan&quot;</span>, <span class="st">&quot;United States&quot;</span>, <span class="st">&quot;United Kingdom&quot;</span>, <span class="st">&quot;Germany&quot;</span>, <span class="st">&quot;France&quot;</span>, <span class="st">&quot;Italy&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb384-5"><a href="ggplot2によるグラフ作成.html#cb384-5" aria-hidden="true" tabindex="-1"></a>  esquisse<span class="sc">::</span><span class="fu">esquisser</span>()</span></code></pre></div>
</div>
<div id="ggplotguiパッケージ" class="section level3 unnumbered hasAnchor">
<h3>ggplotguiパッケージ<a href="ggplot2によるグラフ作成.html#ggplotguiパッケージ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>その他、GUI形式でグラフを作成することができるパッケージとして、<code>ggplotgui</code>があります。同様にウェブサイト上では実行できないため、各自で試してみてください。</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="ggplot2によるグラフ作成.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># irisデータ</span></span>
<span id="cb385-2"><a href="ggplot2によるグラフ作成.html#cb385-2" aria-hidden="true" tabindex="-1"></a>ggplotgui<span class="sc">::</span><span class="fu">ggplot_shiny</span>(<span class="at">data =</span> iris)</span></code></pre></div>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="ggplot2によるグラフ作成.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 世界の新型コロナデータの一部を抽出</span></span>
<span id="cb386-2"><a href="ggplot2によるグラフ作成.html#cb386-2" aria-hidden="true" tabindex="-1"></a>data_owid <span class="sc">%&gt;%</span> </span>
<span id="cb386-3"><a href="ggplot2によるグラフ作成.html#cb386-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(location, date, new_cases_smoothed) <span class="sc">%&gt;%</span> </span>
<span id="cb386-4"><a href="ggplot2によるグラフ作成.html#cb386-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Japan&quot;</span>, <span class="st">&quot;United States&quot;</span>, <span class="st">&quot;United Kingdom&quot;</span>, <span class="st">&quot;Germany&quot;</span>, <span class="st">&quot;France&quot;</span>, <span class="st">&quot;Italy&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb386-5"><a href="ggplot2によるグラフ作成.html#cb386-5" aria-hidden="true" tabindex="-1"></a>  ggplotgui<span class="sc">::</span><span class="fu">ggplot_shiny</span>()</span></code></pre></div>
</div>
</div>
<div id="次元の度数分布離散型" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> 1次元の度数分布（離散型）<a href="ggplot2によるグラフ作成.html#次元の度数分布離散型" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：離散型変数</li>
<li>Y軸：なし</li>
</ul>
<p>離散型変数の1次元の度数分布を作成するには、度数棒グラフを用います。度数棒グラフを作成するには<code>geom_bar()</code>関数を使用します。</p>
<div id="度数棒グラフの基本形" class="section level3 unnumbered hasAnchor">
<h3>度数棒グラフの基本形<a href="ggplot2によるグラフ作成.html#度数棒グラフの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="ggplot2によるグラフ作成.html#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb387-2"><a href="ggplot2によるグラフ作成.html#cb387-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> manufacturer)) <span class="sc">+</span> </span>
<span id="cb387-3"><a href="ggplot2によるグラフ作成.html#cb387-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb387-4"><a href="ggplot2によるグラフ作成.html#cb387-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb387-5"><a href="ggplot2によるグラフ作成.html#cb387-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb387-6"><a href="ggplot2によるグラフ作成.html#cb387-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">0.5</span>, <span class="co"># 線の太さ</span></span>
<span id="cb387-7"><a href="ggplot2によるグラフ作成.html#cb387-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.9</span>) <span class="co"># 棒の幅 (0-1)</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
</div>
</div>
<div id="次元の度数分布連続型" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> 1次元の度数分布（連続型）<a href="ggplot2によるグラフ作成.html#次元の度数分布連続型" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：連続型変数</li>
<li>Y軸：なし</li>
</ul>
<p>連続型変数の1次元の度数分布を作成するには、ヒストグラムを用います。ヒストグラムを作成するには<code>geom_histogram()</code>関数や<code>geom_freqpoly()</code>関数を使用します。</p>
<div id="ヒストグラムの基本形" class="section level3 unnumbered hasAnchor">
<h3>ヒストグラムの基本形<a href="ggplot2によるグラフ作成.html#ヒストグラムの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="ggplot2によるグラフ作成.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb388-2"><a href="ggplot2によるグラフ作成.html#cb388-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy)) <span class="sc">+</span></span>
<span id="cb388-3"><a href="ggplot2によるグラフ作成.html#cb388-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="co"># 階級幅</span></span>
<span id="cb388-4"><a href="ggplot2によるグラフ作成.html#cb388-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb388-5"><a href="ggplot2によるグラフ作成.html#cb388-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fill =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb388-6"><a href="ggplot2によるグラフ作成.html#cb388-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fl">0.5</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
</div>
<div id="横並びヒストグラム" class="section level3 unnumbered hasAnchor">
<h3>横並びヒストグラム<a href="ggplot2によるグラフ作成.html#横並びヒストグラム" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>グループ別のヒストグラムを横並び形式で作成するには、<code>position</code>引数に<code>"dodge"</code>を指定します。</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="ggplot2によるグラフ作成.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb389-2"><a href="ggplot2によるグラフ作成.html#cb389-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">fill =</span> class)) <span class="sc">+</span></span>
<span id="cb389-3"><a href="ggplot2によるグラフ作成.html#cb389-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="co"># 階級幅</span></span>
<span id="cb389-4"><a href="ggplot2によるグラフ作成.html#cb389-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="co"># 横並びポジション</span></span>
<span id="cb389-5"><a href="ggplot2によるグラフ作成.html#cb389-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb389-6"><a href="ggplot2によるグラフ作成.html#cb389-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fl">0.5</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
<p>グループ別の度数分布は<code>geom_freqpoly()</code>関数でも可視化することができます。</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="ggplot2によるグラフ作成.html#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb390-2"><a href="ggplot2によるグラフ作成.html#cb390-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb390-3"><a href="ggplot2によるグラフ作成.html#cb390-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="co"># 階級幅</span></span>
<span id="cb390-4"><a href="ggplot2によるグラフ作成.html#cb390-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">0.5</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
</div>
<div id="積み上げヒストグラム" class="section level3 unnumbered hasAnchor">
<h3>積み上げヒストグラム<a href="ggplot2によるグラフ作成.html#積み上げヒストグラム" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>グループ別のヒストグラムを積み上げ形式で作成するには、<code>position</code>引数に<code>"stack"</code>を指定します。</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="ggplot2によるグラフ作成.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb391-2"><a href="ggplot2によるグラフ作成.html#cb391-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">fill =</span> class)) <span class="sc">+</span></span>
<span id="cb391-3"><a href="ggplot2によるグラフ作成.html#cb391-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="co"># 階級幅</span></span>
<span id="cb391-4"><a href="ggplot2によるグラフ作成.html#cb391-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">position =</span> <span class="st">&quot;stack&quot;</span>, <span class="co"># 積み上げポジション</span></span>
<span id="cb391-5"><a href="ggplot2によるグラフ作成.html#cb391-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb391-6"><a href="ggplot2によるグラフ作成.html#cb391-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fl">0.5</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
</div>
</div>
<div id="次元の密度グラフ" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> 1次元の密度グラフ<a href="ggplot2によるグラフ作成.html#次元の密度グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：連続型変数</li>
<li>Y軸：なし</li>
</ul>
<p>密度グラフは<code>geom_density()</code>関数で作成します。</p>
<div id="密度グラフの基本形" class="section level3 unnumbered hasAnchor">
<h3>密度グラフの基本形<a href="ggplot2によるグラフ作成.html#密度グラフの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="ggplot2によるグラフ作成.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb392-2"><a href="ggplot2によるグラフ作成.html#cb392-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy)) <span class="sc">+</span></span>
<span id="cb392-3"><a href="ggplot2によるグラフ作成.html#cb392-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="co"># カーネル関数の種類</span></span>
<span id="cb392-4"><a href="ggplot2によるグラフ作成.html#cb392-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb392-5"><a href="ggplot2によるグラフ作成.html#cb392-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb392-6"><a href="ggplot2によるグラフ作成.html#cb392-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">1.0</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-155-1.png" width="672" /></p>
</div>
<div id="横並び密度グラフ" class="section level3 unnumbered hasAnchor">
<h3>横並び密度グラフ<a href="ggplot2によるグラフ作成.html#横並び密度グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>グループ別の密度グラフを横並び形式で作成するには、<code>position</code>引数に<code>"dodge"</code>を指定します。</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="ggplot2によるグラフ作成.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb393-2"><a href="ggplot2によるグラフ作成.html#cb393-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb393-3"><a href="ggplot2によるグラフ作成.html#cb393-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="co"># カーネル関数の種類</span></span>
<span id="cb393-4"><a href="ggplot2によるグラフ作成.html#cb393-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="co"># 横並びポジション</span></span>
<span id="cb393-5"><a href="ggplot2によるグラフ作成.html#cb393-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb393-6"><a href="ggplot2によるグラフ作成.html#cb393-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">1.0</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
<p>横並びの密度グラフは<code>geom_freqpoly()</code>関数でも作成できます。<code>geom_freqpoly()</code>関数で<code>mapping = aes(y = ..density..)</code>を指定すると、各グループの度数を標準化して密度グラフに変換します。</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="ggplot2によるグラフ作成.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb394-2"><a href="ggplot2によるグラフ作成.html#cb394-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">y =</span> ..density.., <span class="at">color =</span> class)) <span class="sc">+</span></span>
<span id="cb394-3"><a href="ggplot2によるグラフ作成.html#cb394-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_freqpoly</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="co"># 階級幅</span></span>
<span id="cb394-4"><a href="ggplot2によるグラフ作成.html#cb394-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="fl">0.5</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
</div>
<div id="積み上げ密度グラフ" class="section level3 unnumbered hasAnchor">
<h3>積み上げ密度グラフ<a href="ggplot2によるグラフ作成.html#積み上げ密度グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>グループ別の密度グラフを積み上げ形式で作成するには、<code>position</code>引数に<code>"stack"</code>を指定します。</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="ggplot2によるグラフ作成.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb395-2"><a href="ggplot2によるグラフ作成.html#cb395-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">fill =</span> class)) <span class="sc">+</span></span>
<span id="cb395-3"><a href="ggplot2によるグラフ作成.html#cb395-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">kernel =</span> <span class="st">&quot;gaussian&quot;</span>, <span class="co"># カーネル関数の種類</span></span>
<span id="cb395-4"><a href="ggplot2によるグラフ作成.html#cb395-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="st">&quot;stack&quot;</span>, <span class="co"># 積み上げポジション</span></span>
<span id="cb395-5"><a href="ggplot2によるグラフ作成.html#cb395-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb395-6"><a href="ggplot2によるグラフ作成.html#cb395-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb395-7"><a href="ggplot2によるグラフ作成.html#cb395-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-158-1.png" width="672" /></p>
</div>
</div>
<div id="次元の度数分布離散型-1" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> 2次元の度数分布（離散型）<a href="ggplot2によるグラフ作成.html#次元の度数分布離散型-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：離散型変数</li>
<li>Y軸：離散型変数</li>
</ul>
<p>離散型変数の2次元の度数分布を作成するには、度数バブルチャートや度数ヒートマップを用います。度数バブルチャートを作成するには<code>geom_count()</code>関数を使用します。また、離散型変数の度数ヒートマップを作成するには<code>geom_tile()</code>関数を使用します。</p>
<div id="度数バブルチャートの基本形" class="section level3 unnumbered hasAnchor">
<h3>度数バブルチャートの基本形<a href="ggplot2によるグラフ作成.html#度数バブルチャートの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="ggplot2によるグラフ作成.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb396-2"><a href="ggplot2によるグラフ作成.html#cb396-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> manufacturer, <span class="at">y =</span> class)) <span class="sc">+</span></span>
<span id="cb396-3"><a href="ggplot2によるグラフ作成.html#cb396-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_count</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb396-4"><a href="ggplot2によるグラフ作成.html#cb396-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb396-5"><a href="ggplot2によるグラフ作成.html#cb396-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb396-6"><a href="ggplot2によるグラフ作成.html#cb396-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="co"># マーカーの種類</span></span>
<span id="cb396-7"><a href="ggplot2によるグラフ作成.html#cb396-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 線の太さ</span></span>
<span id="cb396-8"><a href="ggplot2によるグラフ作成.html#cb396-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">15</span>) <span class="sc">+</span> <span class="co"># 変量とマーカーの面積を比例させる</span></span>
<span id="cb396-9"><a href="ggplot2によるグラフ作成.html#cb396-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">1.0</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
</div>
<div id="度数ヒートマップの基本形" class="section level3 unnumbered hasAnchor">
<h3>度数ヒートマップの基本形<a href="ggplot2によるグラフ作成.html#度数ヒートマップの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="ggplot2によるグラフ作成.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg <span class="sc">%&gt;%</span> </span>
<span id="cb397-2"><a href="ggplot2によるグラフ作成.html#cb397-2" aria-hidden="true" tabindex="-1"></a>         dplyr<span class="sc">::</span><span class="fu">count</span>(manufacturer, class), <span class="co"># データの度数を格納した変数を作成</span></span>
<span id="cb397-3"><a href="ggplot2によるグラフ作成.html#cb397-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> manufacturer, <span class="at">y =</span> class, <span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb397-4"><a href="ggplot2によるグラフ作成.html#cb397-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">height =</span> <span class="fl">1.0</span>, <span class="co"># タイルの高さ</span></span>
<span id="cb397-5"><a href="ggplot2によるグラフ作成.html#cb397-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">width =</span> <span class="fl">1.0</span>, <span class="co"># タイルの幅</span></span>
<span id="cb397-6"><a href="ggplot2によるグラフ作成.html#cb397-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの色の透明度</span></span>
<span id="cb397-7"><a href="ggplot2によるグラフ作成.html#cb397-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb397-8"><a href="ggplot2によるグラフ作成.html#cb397-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb397-9"><a href="ggplot2によるグラフ作成.html#cb397-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 線の太さ</span></span>
<span id="cb397-10"><a href="ggplot2によるグラフ作成.html#cb397-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span> </span>
<span id="cb397-11"><a href="ggplot2によるグラフ作成.html#cb397-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">1.0</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-160-1.png" width="672" /></p>
</div>
</div>
<div id="次元の度数分布連続型-1" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> 2次元の度数分布（連続型）<a href="ggplot2によるグラフ作成.html#次元の度数分布連続型-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：連続型変数</li>
<li>Y軸：連続型変数</li>
</ul>
<p>連続型変数の2次元の度数分布を作成するには、度数ヒートマップを用います。連続型変数の度数ヒートマップを作成するには<code>geom_bin2d()</code>関数を使用します。</p>
<div id="度数ヒートマップの基本形-1" class="section level3 unnumbered hasAnchor">
<h3>度数ヒートマップの基本形<a href="ggplot2によるグラフ作成.html#度数ヒートマップの基本形-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="ggplot2によるグラフ作成.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds,</span>
<span id="cb398-2"><a href="ggplot2によるグラフ作成.html#cb398-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb398-3"><a href="ggplot2によるグラフ作成.html#cb398-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bin2d</span>(<span class="at">bins =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">75</span>), <span class="co"># X軸・Y軸の階級数（デフォルトは30）</span></span>
<span id="cb398-4"><a href="ggplot2によるグラフ作成.html#cb398-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの色の透明度</span></span>
<span id="cb398-5"><a href="ggplot2によるグラフ作成.html#cb398-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="cn">NA</span>, <span class="co"># 線の色</span></span>
<span id="cb398-6"><a href="ggplot2によるグラフ作成.html#cb398-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類</span></span>
<span id="cb398-7"><a href="ggplot2によるグラフ作成.html#cb398-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="co"># 線の太さ</span></span>
<span id="cb398-8"><a href="ggplot2によるグラフ作成.html#cb398-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-161-1.png" width="672" /></p>
</div>
</div>
<div id="次元の密度グラフ-1" class="section level2 hasAnchor" number="5.10">
<h2><span class="header-section-number">5.10</span> 2次元の密度グラフ<a href="ggplot2によるグラフ作成.html#次元の密度グラフ-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：連続型変数</li>
<li>Y軸：連続型変数</li>
</ul>
<p>2次元の密度グラフを作成するには、<code>geom_density2d()</code>関数ファミリーを使用します。</p>
<p>まず、使用するサンプルデータを作成します。データサイズが大きい場合、2次元密度グラフを作成するために時間を要するため、<code>dplyr::sample_n()</code>関数でサンプリングします。</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="ggplot2によるグラフ作成.html#cb399-1" aria-hidden="true" tabindex="-1"></a>diamonds_small <span class="ot">&lt;-</span> diamonds <span class="sc">%&gt;%</span> </span>
<span id="cb399-2"><a href="ggplot2によるグラフ作成.html#cb399-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">sample_n</span>(<span class="at">size =</span> <span class="dv">5000</span>)</span></code></pre></div>
<div id="次元密度グラフの基本形" class="section level3 unnumbered hasAnchor">
<h3>2次元密度グラフの基本形<a href="ggplot2によるグラフ作成.html#次元密度グラフの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="ggplot2によるグラフ作成.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds_small,</span>
<span id="cb400-2"><a href="ggplot2によるグラフ作成.html#cb400-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span> </span>
<span id="cb400-3"><a href="ggplot2によるグラフ作成.html#cb400-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density2d</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
</div>
<div id="次元密度グラフの塗りつぶし版" class="section level3 unnumbered hasAnchor">
<h3>2次元密度グラフの塗りつぶし版<a href="ggplot2によるグラフ作成.html#次元密度グラフの塗りつぶし版" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="ggplot2によるグラフ作成.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> diamonds_small,</span>
<span id="cb401-2"><a href="ggplot2によるグラフ作成.html#cb401-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span> </span>
<span id="cb401-3"><a href="ggplot2によるグラフ作成.html#cb401-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density2d_filled</span>() <span class="sc">+</span></span>
<span id="cb401-4"><a href="ggplot2によるグラフ作成.html#cb401-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Reds&quot;</span>,</span>
<span id="cb401-5"><a href="ggplot2によるグラフ作成.html#cb401-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">direction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-164-1.png" width="672" /></p>
</div>
</div>
<div id="qqプロット" class="section level2 hasAnchor" number="5.11">
<h2><span class="header-section-number">5.11</span> QQプロット<a href="ggplot2によるグラフ作成.html#qqプロット" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸・Y軸：連続型変数</li>
</ul>
<p>QQプロットは<code>geom_qq()</code>関数で作成します。他のグラフと異なり、<code>mapping = aes(sample = 変数)</code>で変数を指定します。</p>
<p>QQ（Quantile-Quantile）プロットは、データが正規分布にどの程度近いかを検証するグラフです。Y軸にデータを順番に並べた値、X軸にデータが正規分布に従うと仮定した場合にとりうる期待値を標準化した値をとり、散布図を描いたものです。</p>
<p>QQプロットが直線上にある場合、データは正規分布に従うと解釈できます。一方、QQプロットが直線から乖離している場合は、正規分布に従っておらず、分布にゆがみがあると解釈できます。</p>
<p>例えば、QQプロットが<u>右下に凸な形状の場合は、データは右に長い裾（テール）</u>をもちます。一方、QQプロットが<u>左上に凸な形状の場合は、データの分布は左に長い裾（テール）</u>をもちます。</p>
<p>また、QQプロットが<u>S字状（前半は右下に凸、後半は左上に凸）の場合は、データの両裾が重い、いわゆるファット・テールの分布</u>になります。一方、<u>逆S字状（前半は左上に凸、後半は右下に凸）の場合は、ピーク部分が突出した分布</u>になります。</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="ggplot2によるグラフ作成.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 右に長い裾をもつデータのQQプロット</span></span>
<span id="cb402-2"><a href="ggplot2によるグラフ作成.html#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> iris,</span>
<span id="cb402-3"><a href="ggplot2によるグラフ作成.html#cb402-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">sample =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb402-4"><a href="ggplot2によるグラフ作成.html#cb402-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb402-5"><a href="ggplot2によるグラフ作成.html#cb402-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="ggplot2によるグラフ作成.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ファット・テールをもつデータのQQプロット</span></span>
<span id="cb403-2"><a href="ggplot2によるグラフ作成.html#cb403-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> economics,</span>
<span id="cb403-3"><a href="ggplot2によるグラフ作成.html#cb403-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">sample =</span> unemploy)) <span class="sc">+</span></span>
<span id="cb403-4"><a href="ggplot2によるグラフ作成.html#cb403-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb403-5"><a href="ggplot2によるグラフ作成.html#cb403-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
</div>
<div id="散布図バブルチャート" class="section level2 hasAnchor" number="5.12">
<h2><span class="header-section-number">5.12</span> 散布図・バブルチャート<a href="ggplot2によるグラフ作成.html#散布図バブルチャート" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：連続型変数</li>
<li>Y軸：連続型変数</li>
</ul>
<p>散布図とバブルチャートは<code>geom_point()</code>関数で作成します。バブルチャートの上に<code>geom_smooth()</code>関数で近似曲線を重ねることができます。</p>
<p>まず、プロット用のデータを作成します。</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="ggplot2によるグラフ作成.html#cb404-1" aria-hidden="true" tabindex="-1"></a>data_mpg_point <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span> </span>
<span id="cb404-2"><a href="ggplot2によるグラフ作成.html#cb404-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(manufacturer) <span class="sc">%&gt;%</span> </span>
<span id="cb404-3"><a href="ggplot2によるグラフ作成.html#cb404-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(displ, cty, hwy), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb404-4"><a href="ggplot2によるグラフ作成.html#cb404-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-5"><a href="ggplot2によるグラフ作成.html#cb404-5" aria-hidden="true" tabindex="-1"></a>data_mpg_point</span></code></pre></div>
<pre><code>## # A tibble: 15 x 4
##    manufacturer displ   cty   hwy
##    &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 audi          2.54  17.6  26.4
##  2 chevrolet     5.06  15    21.9
##  3 dodge         4.38  13.1  17.9
##  4 ford          4.54  14    19.4
##  5 honda         1.71  24.4  32.6
##  6 hyundai       2.43  18.6  26.9
##  7 jeep          4.58  13.5  17.6
##  8 land rover    4.3   11.5  16.5
##  9 lincoln       5.4   11.3  17  
## 10 mercury       4.4   13.2  18  
## 11 nissan        3.27  18.1  24.6
## 12 pontiac       3.96  17    26.4
## 13 subaru        2.46  19.3  25.6
## 14 toyota        2.95  18.5  24.9
## 15 volkswagen    2.26  20.9  29.2</code></pre>
<div id="散布図の基本形" class="section level3 unnumbered hasAnchor">
<h3>散布図の基本形<a href="ggplot2によるグラフ作成.html#散布図の基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="ggplot2によるグラフ作成.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb406-2"><a href="ggplot2によるグラフ作成.html#cb406-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb406-3"><a href="ggplot2によるグラフ作成.html#cb406-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb406-4"><a href="ggplot2によるグラフ作成.html#cb406-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb406-5"><a href="ggplot2によるグラフ作成.html#cb406-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb406-6"><a href="ggplot2によるグラフ作成.html#cb406-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="co"># マーカーの種類</span></span>
<span id="cb406-7"><a href="ggplot2によるグラフ作成.html#cb406-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.0</span>, <span class="co"># マーカーの大きさ</span></span>
<span id="cb406-8"><a href="ggplot2によるグラフ作成.html#cb406-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> <span class="fl">0.5</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-168-1.png" width="672" /></p>
</div>
<div id="バブルチャートの基本形" class="section level3 unnumbered hasAnchor">
<h3>バブルチャートの基本形<a href="ggplot2によるグラフ作成.html#バブルチャートの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>バブルチャートを作成するには、<code>ggplot()</code>関数の<code>mapping = aes()</code>関数で<code>size</code>引数にバブルのサイズを変化させたい変数を指定します。</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="ggplot2によるグラフ作成.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_mpg_point,</span>
<span id="cb407-2"><a href="ggplot2によるグラフ作成.html#cb407-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy, <span class="at">size =</span> displ)) <span class="sc">+</span> <span class="co"># aes() 関数内のsize引数に連続型変数を指定</span></span>
<span id="cb407-3"><a href="ggplot2によるグラフ作成.html#cb407-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb407-4"><a href="ggplot2によるグラフ作成.html#cb407-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb407-5"><a href="ggplot2によるグラフ作成.html#cb407-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb407-6"><a href="ggplot2によるグラフ作成.html#cb407-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="co"># マーカーの種類</span></span>
<span id="cb407-7"><a href="ggplot2によるグラフ作成.html#cb407-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> <span class="fl">0.5</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-169-1.png" width="672" /></p>
</div>
<div id="散布図に補助線を追加" class="section level3 unnumbered hasAnchor">
<h3>散布図に補助線を追加<a href="ggplot2によるグラフ作成.html#散布図に補助線を追加" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>水平線、垂直線、傾き・切片のある直線といった補助線を追加するには、それぞれ<code>geom_hline()</code>関数、<code>geom_vline()</code>関数、<code>geom_abline()</code>関数を使用します。</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="ggplot2によるグラフ作成.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb408-2"><a href="ggplot2によるグラフ作成.html#cb408-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb408-3"><a href="ggplot2によるグラフ作成.html#cb408-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">20</span>, <span class="co"># 水平線の縦軸との交点</span></span>
<span id="cb408-4"><a href="ggplot2によるグラフ作成.html#cb408-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;Tomato&quot;</span>, <span class="co"># 水平線の色</span></span>
<span id="cb408-5"><a href="ggplot2によるグラフ作成.html#cb408-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 水平線の太さ</span></span>
<span id="cb408-6"><a href="ggplot2によるグラフ作成.html#cb408-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">20</span>, <span class="co"># 垂直線の横軸との交点</span></span>
<span id="cb408-7"><a href="ggplot2によるグラフ作成.html#cb408-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;Forestgreen&quot;</span>, <span class="co"># 垂直線の色</span></span>
<span id="cb408-8"><a href="ggplot2によるグラフ作成.html#cb408-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 垂直線の太さ</span></span>
<span id="cb408-9"><a href="ggplot2によるグラフ作成.html#cb408-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="co"># 直線の切片</span></span>
<span id="cb408-10"><a href="ggplot2によるグラフ作成.html#cb408-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> <span class="dv">1</span>, <span class="co"># 直線の傾き</span></span>
<span id="cb408-11"><a href="ggplot2によるグラフ作成.html#cb408-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;gold&quot;</span>, <span class="co"># 直線の色</span></span>
<span id="cb408-12"><a href="ggplot2によるグラフ作成.html#cb408-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 直線の太さ</span></span>
<span id="cb408-13"><a href="ggplot2によるグラフ作成.html#cb408-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb408-14"><a href="ggplot2によるグラフ作成.html#cb408-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb408-15"><a href="ggplot2によるグラフ作成.html#cb408-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb408-16"><a href="ggplot2によるグラフ作成.html#cb408-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="co"># マーカーの種類</span></span>
<span id="cb408-17"><a href="ggplot2によるグラフ作成.html#cb408-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.0</span>, <span class="co"># マーカーの大きさ</span></span>
<span id="cb408-18"><a href="ggplot2によるグラフ作成.html#cb408-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> <span class="fl">0.5</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-170-1.png" width="672" /></p>
</div>
<div id="散布図にコネクタ線を追加" class="section level3 unnumbered hasAnchor">
<h3>散布図にコネクタ線を追加<a href="ggplot2によるグラフ作成.html#散布図にコネクタ線を追加" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>散布図のマーカー間をつなぐコネクタ線を追加するには、<code>geom_path()</code>関数を追加します。折れ線グラフを作成する<code>geom_line()</code>関数とは異なるので注意してください。</p>
<p><code>geom_path()</code>関数と<code>geom_line()</code>関数はどちらもマーカー間をつなぐコネクタ線を追加する関数ですが、<code>geom_path()</code>関数はデータセット上の順番で線を引く一方、<code>geom_line()</code>関数はデータセット上の順番に関わらずX軸上の順番で線を引くという違いがあります。</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="ggplot2によるグラフ作成.html#cb409-1" aria-hidden="true" tabindex="-1"></a>economics <span class="sc">%&gt;%</span> </span>
<span id="cb409-2"><a href="ggplot2によるグラフ作成.html#cb409-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(date <span class="sc">&gt;=</span> <span class="st">&quot;2000-01-01&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb409-3"><a href="ggplot2によるグラフ作成.html#cb409-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> unemploy, <span class="at">y =</span> uempmed)) <span class="sc">+</span></span>
<span id="cb409-4"><a href="ggplot2によるグラフ作成.html#cb409-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb409-5"><a href="ggplot2によるグラフ作成.html#cb409-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb409-6"><a href="ggplot2によるグラフ作成.html#cb409-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 線の大きさ</span></span>
<span id="cb409-7"><a href="ggplot2によるグラフ作成.html#cb409-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb409-8"><a href="ggplot2によるグラフ作成.html#cb409-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb409-9"><a href="ggplot2によるグラフ作成.html#cb409-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb409-10"><a href="ggplot2によるグラフ作成.html#cb409-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="co"># マーカーの種類</span></span>
<span id="cb409-11"><a href="ggplot2によるグラフ作成.html#cb409-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.0</span>, <span class="co"># マーカーの大きさ</span></span>
<span id="cb409-12"><a href="ggplot2によるグラフ作成.html#cb409-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> <span class="fl">0.5</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
</div>
<div id="散布図に近似曲線を追加" class="section level3 unnumbered hasAnchor">
<h3>散布図に近似曲線を追加<a href="ggplot2によるグラフ作成.html#散布図に近似曲線を追加" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>散布図に近似曲線を追加するには、<code>geom_smooth()</code>関数を使用します。</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="ggplot2によるグラフ作成.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb410-2"><a href="ggplot2によるグラフ作成.html#cb410-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb410-3"><a href="ggplot2によるグラフ作成.html#cb410-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb410-4"><a href="ggplot2によるグラフ作成.html#cb410-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb410-5"><a href="ggplot2によるグラフ作成.html#cb410-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb410-6"><a href="ggplot2によるグラフ作成.html#cb410-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="co"># マーカーの種類</span></span>
<span id="cb410-7"><a href="ggplot2によるグラフ作成.html#cb410-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.0</span>, <span class="co"># マーカーの大きさ</span></span>
<span id="cb410-8"><a href="ggplot2によるグラフ作成.html#cb410-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 線の太さ</span></span>
<span id="cb410-9"><a href="ggplot2によるグラフ作成.html#cb410-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="co"># 近似曲線の推計式</span></span>
<span id="cb410-10"><a href="ggplot2によるグラフ作成.html#cb410-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="co"># 近似手法 (lm, glm, gam, loess)</span></span>
<span id="cb410-11"><a href="ggplot2によるグラフ作成.html#cb410-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="co"># 誤差範囲の透明度</span></span>
<span id="cb410-12"><a href="ggplot2によるグラフ作成.html#cb410-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="co"># 近似曲線の色</span></span>
<span id="cb410-13"><a href="ggplot2によるグラフ作成.html#cb410-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;gray&quot;</span>, <span class="co"># 誤差範囲の色</span></span>
<span id="cb410-14"><a href="ggplot2によるグラフ作成.html#cb410-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="co"># 近似曲線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb410-15"><a href="ggplot2によるグラフ作成.html#cb410-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.0</span>) <span class="co"># 近似曲線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-172-1.png" width="672" /></p>
</div>
<div id="散布図にラベルを追加" class="section level3 unnumbered hasAnchor">
<h3>散布図にラベルを追加<a href="ggplot2によるグラフ作成.html#散布図にラベルを追加" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>散布図にラベルを追加するには、<code>ggrepel</code>パッケージの<code>geom_text_repel()</code>関数を使用します。<code>geom_text_repel()</code>関数は、散布図のマーカーとラベルが重ならないようにラベルの位置を自動で調整します。</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="ggplot2によるグラフ作成.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_mpg_point,</span>
<span id="cb411-2"><a href="ggplot2によるグラフ作成.html#cb411-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb411-3"><a href="ggplot2によるグラフ作成.html#cb411-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb411-4"><a href="ggplot2によるグラフ作成.html#cb411-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb411-5"><a href="ggplot2によるグラフ作成.html#cb411-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb411-6"><a href="ggplot2によるグラフ作成.html#cb411-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="co"># マーカーの種類</span></span>
<span id="cb411-7"><a href="ggplot2によるグラフ作成.html#cb411-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.0</span>, <span class="co"># マーカーの大きさ</span></span>
<span id="cb411-8"><a href="ggplot2によるグラフ作成.html#cb411-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 線の太さ</span></span>
<span id="cb411-9"><a href="ggplot2によるグラフ作成.html#cb411-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> manufacturer),</span>
<span id="cb411-10"><a href="ggplot2によるグラフ作成.html#cb411-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">seed =</span> <span class="cn">NA</span>, <span class="co"># テキストの配置を決定するランダムシード</span></span>
<span id="cb411-11"><a href="ggplot2によるグラフ作成.html#cb411-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, <span class="co"># テキストの整列方向 (both / x / y)</span></span>
<span id="cb411-12"><a href="ggplot2によるグラフ作成.html#cb411-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">hjust =</span> <span class="fl">0.0</span>, <span class="co"># 横方向の整列位置 (0-1) </span></span>
<span id="cb411-13"><a href="ggplot2によるグラフ作成.html#cb411-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="co"># 縦方向の整列位置 (0-1)</span></span>
<span id="cb411-14"><a href="ggplot2によるグラフ作成.html#cb411-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nudge_x =</span> <span class="cn">NULL</span>, <span class="co"># マーカーからの横方向のスペース (NULL, 0-)</span></span>
<span id="cb411-15"><a href="ggplot2によるグラフ作成.html#cb411-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nudge_y =</span> <span class="cn">NULL</span>, <span class="co"># マーカーからの縦方向のスペース (NULL, 0-)</span></span>
<span id="cb411-16"><a href="ggplot2によるグラフ作成.html#cb411-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">box.padding =</span> <span class="fl">0.5</span>, <span class="co"># テキスト周囲のスペース (0-)</span></span>
<span id="cb411-17"><a href="ggplot2によるグラフ作成.html#cb411-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">point.padding =</span> <span class="fl">0.1</span>, <span class="co"># マーカー周囲のスペース (0-)</span></span>
<span id="cb411-18"><a href="ggplot2によるグラフ作成.html#cb411-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.alpha =</span> <span class="fl">1.0</span>, <span class="co"># 引き出し線の透明度</span></span>
<span id="cb411-19"><a href="ggplot2によるグラフ作成.html#cb411-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.color =</span> <span class="st">&quot;grey&quot;</span>, <span class="co"># 引き出し線の色</span></span>
<span id="cb411-20"><a href="ggplot2によるグラフ作成.html#cb411-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.size =</span> <span class="fl">0.5</span>, <span class="co"># 引き出し線の太さ</span></span>
<span id="cb411-21"><a href="ggplot2によるグラフ作成.html#cb411-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">min.segment.length =</span> <span class="dv">0</span>, <span class="co"># 引き出し線の最低長</span></span>
<span id="cb411-22"><a href="ggplot2によるグラフ作成.html#cb411-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="co"># テキストの色</span></span>
<span id="cb411-23"><a href="ggplot2によるグラフ作成.html#cb411-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">&quot;YUGO&quot;</span>, <span class="co"># テキストのフォント</span></span>
<span id="cb411-24"><a href="ggplot2によるグラフ作成.html#cb411-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fontface =</span> <span class="st">&quot;plain&quot;</span>, <span class="co"># テキストの書体 (plain / bold / italic / bold.italic)</span></span>
<span id="cb411-25"><a href="ggplot2によるグラフ作成.html#cb411-25" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">4.0</span>) <span class="co"># テキストのサイズ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-173-1.png" width="672" /></p>
</div>
<div id="バブルチャートにラベルを追加" class="section level3 hasAnchor" number="5.12.1">
<h3><span class="header-section-number">5.12.1</span> バブルチャートにラベルを追加<a href="ggplot2によるグラフ作成.html#バブルチャートにラベルを追加" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="ggplot2によるグラフ作成.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_mpg_point,</span>
<span id="cb412-2"><a href="ggplot2によるグラフ作成.html#cb412-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy, <span class="at">size =</span> displ)) <span class="sc">+</span> <span class="co"># aes() 関数内のsize引数に連続型変数を指定</span></span>
<span id="cb412-3"><a href="ggplot2によるグラフ作成.html#cb412-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb412-4"><a href="ggplot2によるグラフ作成.html#cb412-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb412-5"><a href="ggplot2によるグラフ作成.html#cb412-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb412-6"><a href="ggplot2によるグラフ作成.html#cb412-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="co"># マーカーの種類</span></span>
<span id="cb412-7"><a href="ggplot2によるグラフ作成.html#cb412-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 線の太さ</span></span>
<span id="cb412-8"><a href="ggplot2によるグラフ作成.html#cb412-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> manufacturer),</span>
<span id="cb412-9"><a href="ggplot2によるグラフ作成.html#cb412-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">seed =</span> <span class="cn">NA</span>, <span class="co"># テキストの配置を決定するランダムシード</span></span>
<span id="cb412-10"><a href="ggplot2によるグラフ作成.html#cb412-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>, <span class="co"># テキストの整列方向 (both / x / y)</span></span>
<span id="cb412-11"><a href="ggplot2によるグラフ作成.html#cb412-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">hjust =</span> <span class="fl">0.0</span>, <span class="co"># 横方向の整列位置 (0-1) </span></span>
<span id="cb412-12"><a href="ggplot2によるグラフ作成.html#cb412-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="co"># 縦方向の整列位置 (0-1)</span></span>
<span id="cb412-13"><a href="ggplot2によるグラフ作成.html#cb412-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nudge_x =</span> <span class="cn">NULL</span>, <span class="co"># マーカーからの横方向のスペース (NULL, 0-)</span></span>
<span id="cb412-14"><a href="ggplot2によるグラフ作成.html#cb412-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nudge_y =</span> <span class="cn">NULL</span>, <span class="co"># マーカーからの縦方向のスペース (NULL, 0-)</span></span>
<span id="cb412-15"><a href="ggplot2によるグラフ作成.html#cb412-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">box.padding =</span> <span class="fl">1.0</span>, <span class="co"># テキスト周囲のスペース (0-)</span></span>
<span id="cb412-16"><a href="ggplot2によるグラフ作成.html#cb412-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">point.padding =</span> <span class="fl">0.1</span>, <span class="co"># マーカー周囲のスペース (0-)</span></span>
<span id="cb412-17"><a href="ggplot2によるグラフ作成.html#cb412-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.alpha =</span> <span class="fl">1.0</span>, <span class="co"># 引き出し線の透明度</span></span>
<span id="cb412-18"><a href="ggplot2によるグラフ作成.html#cb412-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.color =</span> <span class="st">&quot;grey&quot;</span>, <span class="co"># 引き出し線の色</span></span>
<span id="cb412-19"><a href="ggplot2によるグラフ作成.html#cb412-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.size =</span> <span class="fl">0.5</span>, <span class="co"># 引き出し線の太さ</span></span>
<span id="cb412-20"><a href="ggplot2によるグラフ作成.html#cb412-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">min.segment.length =</span> <span class="dv">0</span>, <span class="co"># 引き出し線の最低長</span></span>
<span id="cb412-21"><a href="ggplot2によるグラフ作成.html#cb412-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="co"># テキストの色</span></span>
<span id="cb412-22"><a href="ggplot2によるグラフ作成.html#cb412-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">&quot;YUGO&quot;</span>, <span class="co"># テキストのフォント</span></span>
<span id="cb412-23"><a href="ggplot2によるグラフ作成.html#cb412-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fontface =</span> <span class="st">&quot;plain&quot;</span>, <span class="co"># テキストの書体 (plain / bold / italic / bold.italic)</span></span>
<span id="cb412-24"><a href="ggplot2によるグラフ作成.html#cb412-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">4.0</span>) <span class="sc">+</span> <span class="co"># テキストのサイズ</span></span>
<span id="cb412-25"><a href="ggplot2によるグラフ作成.html#cb412-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">15</span>) <span class="co"># 変量とマーカーの面積を比例させる</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
</div>
</div>
<div id="棒グラフ" class="section level2 hasAnchor" number="5.13">
<h2><span class="header-section-number">5.13</span> 棒グラフ<a href="ggplot2によるグラフ作成.html#棒グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：離散型変数</li>
<li>Y軸：連続型変数</li>
</ul>
<p>棒グラフは<code>geom_col()</code>関数で作成します。</p>
<p>まず、プロット用のデータを作成します。</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="ggplot2によるグラフ作成.html#cb413-1" aria-hidden="true" tabindex="-1"></a>data_mpg_col <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span> </span>
<span id="cb413-2"><a href="ggplot2によるグラフ作成.html#cb413-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(manufacturer) <span class="sc">%&gt;%</span> </span>
<span id="cb413-3"><a href="ggplot2によるグラフ作成.html#cb413-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(cty, hwy), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb413-4"><a href="ggplot2によるグラフ作成.html#cb413-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-5"><a href="ggplot2によるグラフ作成.html#cb413-5" aria-hidden="true" tabindex="-1"></a>data_mpg_col</span></code></pre></div>
<pre><code>## # A tibble: 15 x 3
##    manufacturer   cty   hwy
##    &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;
##  1 audi          17.6  26.4
##  2 chevrolet     15    21.9
##  3 dodge         13.1  17.9
##  4 ford          14    19.4
##  5 honda         24.4  32.6
##  6 hyundai       18.6  26.9
##  7 jeep          13.5  17.6
##  8 land rover    11.5  16.5
##  9 lincoln       11.3  17  
## 10 mercury       13.2  18  
## 11 nissan        18.1  24.6
## 12 pontiac       17    26.4
## 13 subaru        19.3  25.6
## 14 toyota        18.5  24.9
## 15 volkswagen    20.9  29.2</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="ggplot2によるグラフ作成.html#cb415-1" aria-hidden="true" tabindex="-1"></a>data_owid_col <span class="ot">&lt;-</span> data_owid <span class="sc">%&gt;%</span> </span>
<span id="cb415-2"><a href="ggplot2によるグラフ作成.html#cb415-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(location, date, new_cases) <span class="sc">%&gt;%</span> </span>
<span id="cb415-3"><a href="ggplot2によるグラフ作成.html#cb415-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Japan&quot;</span>, <span class="st">&quot;United Kingdom&quot;</span>, <span class="st">&quot;Germany&quot;</span>, <span class="st">&quot;France&quot;</span>, <span class="st">&quot;Italy&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb415-4"><a href="ggplot2によるグラフ作成.html#cb415-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">str_c</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(date), <span class="st">&quot;年&quot;</span>), <span class="at">.after =</span> <span class="st">&quot;date&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb415-5"><a href="ggplot2によるグラフ作成.html#cb415-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(location, year) <span class="sc">%&gt;%</span> </span>
<span id="cb415-6"><a href="ggplot2によるグラフ作成.html#cb415-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(new_cases, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb415-7"><a href="ggplot2によるグラフ作成.html#cb415-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-8"><a href="ggplot2によるグラフ作成.html#cb415-8" aria-hidden="true" tabindex="-1"></a>data_owid_col</span></code></pre></div>
<pre><code>## # A tibble: 15 x 3
## # Groups:   location [5]
##    location       year   new_cases
##    &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;
##  1 France         2020年   2735590
##  2 France         2021年   7706191
##  3 France         2022年  20585956
##  4 Germany        2020年   1719737
##  5 Germany        2021年   5430685
##  6 Germany        2022年  20620746
##  7 Italy          2020年   2107314
##  8 Italy          2021年   4018517
##  9 Italy          2022年  12059234
## 10 Japan          2020年    235747
## 11 Japan          2021年   1496547
## 12 Japan          2022年   7494884
## 13 United Kingdom 2020年   2491790
## 14 United Kingdom 2021年  10480124
## 15 United Kingdom 2022年   8862722</code></pre>
<div id="縦棒グラフの基本形" class="section level3 unnumbered hasAnchor">
<h3>縦棒グラフの基本形<a href="ggplot2によるグラフ作成.html#縦棒グラフの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="ggplot2によるグラフ作成.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_mpg_col,</span>
<span id="cb417-2"><a href="ggplot2によるグラフ作成.html#cb417-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> manufacturer, <span class="at">y =</span> cty)) <span class="sc">+</span> </span>
<span id="cb417-3"><a href="ggplot2によるグラフ作成.html#cb417-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb417-4"><a href="ggplot2によるグラフ作成.html#cb417-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb417-5"><a href="ggplot2によるグラフ作成.html#cb417-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb417-6"><a href="ggplot2によるグラフ作成.html#cb417-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">0.5</span>, <span class="co"># 線の太さ</span></span>
<span id="cb417-7"><a href="ggplot2によるグラフ作成.html#cb417-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.9</span>) <span class="sc">+</span> <span class="co"># 棒の幅 (0-1)</span></span>
<span id="cb417-8"><a href="ggplot2によるグラフ作成.html#cb417-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">1.0</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-177-1.png" width="672" /></p>
</div>
<div id="横棒グラフ" class="section level3 unnumbered hasAnchor">
<h3>横棒グラフ<a href="ggplot2によるグラフ作成.html#横棒グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>横棒グラフを作成するには、縦棒グラフを作成した後に<code>coord_flip()</code>関数で横棒グラフに転換します。そのため、X軸とY軸の変数指定は縦棒グラフの場合と同じです。</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="ggplot2によるグラフ作成.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_mpg_col,</span>
<span id="cb418-2"><a href="ggplot2によるグラフ作成.html#cb418-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> manufacturer, <span class="at">y =</span> cty)) <span class="sc">+</span> </span>
<span id="cb418-3"><a href="ggplot2によるグラフ作成.html#cb418-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb418-4"><a href="ggplot2によるグラフ作成.html#cb418-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb418-5"><a href="ggplot2によるグラフ作成.html#cb418-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb418-6"><a href="ggplot2によるグラフ作成.html#cb418-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">0.5</span>, <span class="co"># 線の太さ</span></span>
<span id="cb418-7"><a href="ggplot2によるグラフ作成.html#cb418-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.9</span>) <span class="sc">+</span> <span class="co"># 棒の幅 (0-1)</span></span>
<span id="cb418-8"><a href="ggplot2によるグラフ作成.html#cb418-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
</div>
<div id="縦棒グラフの順序並べ替え" class="section level3 unnumbered hasAnchor">
<h3>縦棒グラフの順序並べ替え<a href="ggplot2によるグラフ作成.html#縦棒グラフの順序並べ替え" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>縦棒グラフのX軸の順番を並べ替えるには、X軸の変数を指定する際に<code>fct_reorder()</code>関数を使用します。</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="ggplot2によるグラフ作成.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_mpg_col,</span>
<span id="cb419-2"><a href="ggplot2によるグラフ作成.html#cb419-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(manufacturer, <span class="sc">-</span>cty), <span class="at">y =</span> cty)) <span class="sc">+</span> </span>
<span id="cb419-3"><a href="ggplot2によるグラフ作成.html#cb419-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb419-4"><a href="ggplot2によるグラフ作成.html#cb419-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb419-5"><a href="ggplot2によるグラフ作成.html#cb419-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb419-6"><a href="ggplot2によるグラフ作成.html#cb419-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">0.5</span>, <span class="co"># 線の太さ</span></span>
<span id="cb419-7"><a href="ggplot2によるグラフ作成.html#cb419-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.9</span>) <span class="sc">+</span> <span class="co"># 棒の幅 (0-1)</span></span>
<span id="cb419-8"><a href="ggplot2によるグラフ作成.html#cb419-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">1.0</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
</div>
<div id="縦棒グラフにラベルを追加" class="section level3 unnumbered hasAnchor">
<h3>縦棒グラフにラベルを追加<a href="ggplot2によるグラフ作成.html#縦棒グラフにラベルを追加" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>縦棒グラフにデータラベルを追加するには、<code>geom_text()</code>関数を使用します。</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="ggplot2によるグラフ作成.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_mpg_col,</span>
<span id="cb420-2"><a href="ggplot2によるグラフ作成.html#cb420-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(manufacturer, <span class="sc">-</span>cty), <span class="at">y =</span> cty)) <span class="sc">+</span> </span>
<span id="cb420-3"><a href="ggplot2によるグラフ作成.html#cb420-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb420-4"><a href="ggplot2によるグラフ作成.html#cb420-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb420-5"><a href="ggplot2によるグラフ作成.html#cb420-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb420-6"><a href="ggplot2によるグラフ作成.html#cb420-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">0.5</span>, <span class="co"># 線の太さ</span></span>
<span id="cb420-7"><a href="ggplot2によるグラフ作成.html#cb420-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.9</span>) <span class="sc">+</span> <span class="co"># 棒の幅 (0-1)</span></span>
<span id="cb420-8"><a href="ggplot2によるグラフ作成.html#cb420-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> cty <span class="sc">%&gt;%</span> <span class="fu">sprintf</span>(<span class="at">fmt =</span> <span class="st">&quot;%0.1f&quot;</span>)), <span class="co"># sprintf() 関数で数値の表示形式を指定</span></span>
<span id="cb420-9"><a href="ggplot2によるグラフ作成.html#cb420-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="co"># 縦方向の整列位置 (0-1)</span></span>
<span id="cb420-10"><a href="ggplot2によるグラフ作成.html#cb420-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="co"># テキストの色</span></span>
<span id="cb420-11"><a href="ggplot2によるグラフ作成.html#cb420-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">&quot;YUGO&quot;</span>, <span class="co"># テキストのフォント</span></span>
<span id="cb420-12"><a href="ggplot2によるグラフ作成.html#cb420-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">&quot;plain&quot;</span>, <span class="co"># テキストの書体 (plain / bold / italic / bold.italic)</span></span>
<span id="cb420-13"><a href="ggplot2によるグラフ作成.html#cb420-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">4.0</span>) <span class="sc">+</span> <span class="co"># テキストのサイズ</span></span>
<span id="cb420-14"><a href="ggplot2によるグラフ作成.html#cb420-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">1.0</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
</div>
<div id="集合縦棒グラフ" class="section level3 unnumbered hasAnchor">
<h3>集合縦棒グラフ<a href="ggplot2によるグラフ作成.html#集合縦棒グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>複数の縦棒グラフを横並び形式で作成するには、<code>position</code>引数に<code>position_dodge()</code>関数を指定します。</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="ggplot2によるグラフ作成.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_owid_col,</span>
<span id="cb421-2"><a href="ggplot2によるグラフ作成.html#cb421-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> location, <span class="at">y =</span> new_cases, <span class="at">fill =</span> year, <span class="at">group =</span> <span class="fu">rev</span>(year))) <span class="sc">+</span> </span>
<span id="cb421-3"><a href="ggplot2によるグラフ作成.html#cb421-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>), <span class="co"># 横並びポジション</span></span>
<span id="cb421-4"><a href="ggplot2によるグラフ作成.html#cb421-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb421-5"><a href="ggplot2によるグラフ作成.html#cb421-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">0.5</span>, <span class="co"># 線の太さ</span></span>
<span id="cb421-6"><a href="ggplot2によるグラフ作成.html#cb421-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.9</span>) <span class="co"># 棒の幅 (0-1)</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-181-1.png" width="672" /></p>
</div>
<div id="積み上げ縦棒グラフ" class="section level3 unnumbered hasAnchor">
<h3>積み上げ縦棒グラフ<a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>複数の縦棒グラフを積み上げ形式で作成するには、<code>position</code>引数に<code>position_stack()</code>関数を指定します。</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="ggplot2によるグラフ作成.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_owid_col,</span>
<span id="cb422-2"><a href="ggplot2によるグラフ作成.html#cb422-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> location, <span class="at">y =</span> new_cases, <span class="at">fill =</span> year, <span class="at">group =</span> <span class="fu">rev</span>(year))) <span class="sc">+</span> </span>
<span id="cb422-3"><a href="ggplot2によるグラフ作成.html#cb422-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_stack</span>(), <span class="co"># 積み上げポジション</span></span>
<span id="cb422-4"><a href="ggplot2によるグラフ作成.html#cb422-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb422-5"><a href="ggplot2によるグラフ作成.html#cb422-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">0.5</span>, <span class="co"># 線の太さ</span></span>
<span id="cb422-6"><a href="ggplot2によるグラフ作成.html#cb422-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.9</span>) <span class="sc">+</span> <span class="co"># 棒の幅 (0-1)</span></span>
<span id="cb422-7"><a href="ggplot2によるグラフ作成.html#cb422-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-182-1.png" width="672" /></p>
</div>
<div id="積み上げ縦棒グラフにラベルを追加" class="section level3 unnumbered hasAnchor">
<h3>積み上げ縦棒グラフにラベルを追加<a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフにラベルを追加" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="ggplot2によるグラフ作成.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_owid_col,</span>
<span id="cb423-2"><a href="ggplot2によるグラフ作成.html#cb423-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> location, <span class="at">y =</span> new_cases, <span class="at">fill =</span> year, <span class="at">group =</span> <span class="fu">rev</span>(year))) <span class="sc">+</span> </span>
<span id="cb423-3"><a href="ggplot2によるグラフ作成.html#cb423-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_stack</span>(), <span class="co"># 積み上げポジション</span></span>
<span id="cb423-4"><a href="ggplot2によるグラフ作成.html#cb423-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb423-5"><a href="ggplot2によるグラフ作成.html#cb423-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">0.5</span>, <span class="co"># 線の太さ</span></span>
<span id="cb423-6"><a href="ggplot2によるグラフ作成.html#cb423-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.9</span>) <span class="sc">+</span> <span class="co"># 棒の幅 (0-1)</span></span>
<span id="cb423-7"><a href="ggplot2によるグラフ作成.html#cb423-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> new_cases <span class="sc">%&gt;%</span> <span class="fu">sprintf</span>(<span class="at">fmt =</span> <span class="st">&quot;%0.1f&quot;</span>)), <span class="co"># sprintf() 関数で数値の表示形式を指定</span></span>
<span id="cb423-8"><a href="ggplot2によるグラフ作成.html#cb423-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="co"># position_stack() 関数で積み上げ棒グラフ上のラベル位置を指定</span></span>
<span id="cb423-9"><a href="ggplot2によるグラフ作成.html#cb423-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="co"># テキストの色</span></span>
<span id="cb423-10"><a href="ggplot2によるグラフ作成.html#cb423-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">&quot;YUGO&quot;</span>, <span class="co"># テキストのフォント</span></span>
<span id="cb423-11"><a href="ggplot2によるグラフ作成.html#cb423-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">&quot;plain&quot;</span>, <span class="co"># テキストの書体 (plain / bold / italic / bold.italic)</span></span>
<span id="cb423-12"><a href="ggplot2によるグラフ作成.html#cb423-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">4.0</span>) <span class="sc">+</span> <span class="co"># テキストのサイズ</span></span>
<span id="cb423-13"><a href="ggplot2によるグラフ作成.html#cb423-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-183-1.png" width="672" /></p>
</div>
<div id="積み上げ縦棒グラフ-1" class="section level3 unnumbered hasAnchor">
<h3>100％積み上げ縦棒グラフ<a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフ-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>複数の縦棒グラフを合計が100％になる積み上げ形式で作成するには、<code>position</code>引数に<code>position_fill()</code>関数を指定します。</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="ggplot2によるグラフ作成.html#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_owid_col,</span>
<span id="cb424-2"><a href="ggplot2によるグラフ作成.html#cb424-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> location, <span class="at">y =</span> new_cases, <span class="at">fill =</span> year, <span class="at">group =</span> <span class="fu">rev</span>(year))) <span class="sc">+</span> </span>
<span id="cb424-3"><a href="ggplot2によるグラフ作成.html#cb424-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_fill</span>(), <span class="co"># 割合積み上げポジション</span></span>
<span id="cb424-4"><a href="ggplot2によるグラフ作成.html#cb424-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb424-5"><a href="ggplot2によるグラフ作成.html#cb424-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">0.5</span>, <span class="co"># 線の太さ</span></span>
<span id="cb424-6"><a href="ggplot2によるグラフ作成.html#cb424-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.9</span>) <span class="sc">+</span> <span class="co"># 棒の幅 (0-1)</span></span>
<span id="cb424-7"><a href="ggplot2によるグラフ作成.html#cb424-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-184-1.png" width="672" /></p>
</div>
<div id="積み上げ縦棒グラフにラベルを追加-1" class="section level3 unnumbered hasAnchor">
<h3>100％積み上げ縦棒グラフにラベルを追加<a href="ggplot2によるグラフ作成.html#積み上げ縦棒グラフにラベルを追加-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="ggplot2によるグラフ作成.html#cb425-1" aria-hidden="true" tabindex="-1"></a>data_owid_col <span class="sc">%&gt;%</span> </span>
<span id="cb425-2"><a href="ggplot2によるグラフ作成.html#cb425-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span> </span>
<span id="cb425-3"><a href="ggplot2によるグラフ作成.html#cb425-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">percent =</span> new_cases <span class="sc">/</span> <span class="fu">sum</span>(new_cases)) <span class="sc">%&gt;%</span> </span>
<span id="cb425-4"><a href="ggplot2によるグラフ作成.html#cb425-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> location, <span class="at">y =</span> new_cases, <span class="at">fill =</span> year, <span class="at">group =</span> <span class="fu">rev</span>(year))) <span class="sc">+</span> </span>
<span id="cb425-5"><a href="ggplot2によるグラフ作成.html#cb425-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_fill</span>(), <span class="co"># 割合ポジション</span></span>
<span id="cb425-6"><a href="ggplot2によるグラフ作成.html#cb425-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb425-7"><a href="ggplot2によるグラフ作成.html#cb425-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">0.5</span>, <span class="co"># 線の太さ</span></span>
<span id="cb425-8"><a href="ggplot2によるグラフ作成.html#cb425-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.9</span>) <span class="sc">+</span> <span class="co"># 棒の幅 (0-1)</span></span>
<span id="cb425-9"><a href="ggplot2によるグラフ作成.html#cb425-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> percent <span class="sc">%&gt;%</span> <span class="fu">sprintf</span>(<span class="at">fmt =</span> <span class="st">&quot;%0.2f&quot;</span>)), <span class="co"># sprintf() 関数で数値の表示形式を指定</span></span>
<span id="cb425-10"><a href="ggplot2によるグラフ作成.html#cb425-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_fill</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="co"># position_fill() 関数で割合棒グラフ上のラベル位置を指定</span></span>
<span id="cb425-11"><a href="ggplot2によるグラフ作成.html#cb425-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="co"># テキストの色</span></span>
<span id="cb425-12"><a href="ggplot2によるグラフ作成.html#cb425-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">&quot;YUGO&quot;</span>, <span class="co"># テキストのフォント</span></span>
<span id="cb425-13"><a href="ggplot2によるグラフ作成.html#cb425-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">&quot;plain&quot;</span>, <span class="co"># テキストの書体 (plain / bold / italic / bold.italic)</span></span>
<span id="cb425-14"><a href="ggplot2によるグラフ作成.html#cb425-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">4.0</span>) <span class="sc">+</span> <span class="co"># テキストのサイズ</span></span>
<span id="cb425-15"><a href="ggplot2によるグラフ作成.html#cb425-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-185-1.png" width="672" /></p>
</div>
</div>
<div id="円グラフ" class="section level2 hasAnchor" number="5.14">
<h2><span class="header-section-number">5.14</span> 円グラフ<a href="ggplot2によるグラフ作成.html#円グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：単一の値</li>
<li>Y軸：連続型変数</li>
</ul>
<p>円グラフを作成するには、<code>geom_col()</code>関数で積み上げ棒グラフを作成した後に、<code>coord_polar()</code>関数で円グラフに転換します。</p>
<p>まず、プロット用のデータを作成します。</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="ggplot2によるグラフ作成.html#cb426-1" aria-hidden="true" tabindex="-1"></a>data_mpg_circle <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span> </span>
<span id="cb426-2"><a href="ggplot2によるグラフ作成.html#cb426-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span> </span>
<span id="cb426-3"><a href="ggplot2によるグラフ作成.html#cb426-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(hwy), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb426-4"><a href="ggplot2によるグラフ作成.html#cb426-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb426-5"><a href="ggplot2によるグラフ作成.html#cb426-5" aria-hidden="true" tabindex="-1"></a>data_mpg_circle</span></code></pre></div>
<pre><code>## # A tibble: 7 x 2
##   class        hwy
##   &lt;chr&gt;      &lt;dbl&gt;
## 1 2seater     24.8
## 2 compact     28.3
## 3 midsize     27.3
## 4 minivan     22.4
## 5 pickup      16.9
## 6 subcompact  28.1
## 7 suv         18.1</code></pre>
<div id="円グラフの基本形" class="section level3 unnumbered hasAnchor">
<h3>円グラフの基本形<a href="ggplot2によるグラフ作成.html#円グラフの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="ggplot2によるグラフ作成.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_mpg_circle,</span>
<span id="cb428-2"><a href="ggplot2によるグラフ作成.html#cb428-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> hwy, <span class="at">fill =</span> class, <span class="at">group =</span> <span class="fu">rev</span>(class))) <span class="sc">+</span> </span>
<span id="cb428-3"><a href="ggplot2によるグラフ作成.html#cb428-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_stack</span>(), <span class="co"># 積み上げポジション</span></span>
<span id="cb428-4"><a href="ggplot2によるグラフ作成.html#cb428-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb428-5"><a href="ggplot2によるグラフ作成.html#cb428-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb428-6"><a href="ggplot2によるグラフ作成.html#cb428-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 線の太さ</span></span>
<span id="cb428-7"><a href="ggplot2によるグラフ作成.html#cb428-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">label =</span> hwy <span class="sc">%&gt;%</span> <span class="fu">sprintf</span>(<span class="at">fmt =</span> <span class="st">&quot;%0.1f&quot;</span>)), <span class="co"># sprintf() 関数で数値の表示形式を指定</span></span>
<span id="cb428-8"><a href="ggplot2によるグラフ作成.html#cb428-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="co"># position_stack() 関数で積み上げ棒グラフ上のラベル位置を指定</span></span>
<span id="cb428-9"><a href="ggplot2によるグラフ作成.html#cb428-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="co"># テキストの色</span></span>
<span id="cb428-10"><a href="ggplot2によるグラフ作成.html#cb428-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="st">&quot;YUGO&quot;</span>, <span class="co"># テキストのフォント</span></span>
<span id="cb428-11"><a href="ggplot2によるグラフ作成.html#cb428-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">fontface =</span> <span class="st">&quot;plain&quot;</span>, <span class="co"># テキストの書体 (plain / bold / italic / bold.italic)</span></span>
<span id="cb428-12"><a href="ggplot2によるグラフ作成.html#cb428-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">4.0</span>) <span class="sc">+</span> <span class="co"># テキストのサイズ</span></span>
<span id="cb428-13"><a href="ggplot2によるグラフ作成.html#cb428-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">&quot;y&quot;</span>, <span class="co"># 円グラフを作成する軸</span></span>
<span id="cb428-14"><a href="ggplot2によるグラフ作成.html#cb428-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="dv">0</span>, <span class="co"># 円グラフの開始位置（ラジアン）</span></span>
<span id="cb428-15"><a href="ggplot2によるグラフ作成.html#cb428-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># 円グラフの方向（1：時計回り、-1：反時計回り）</span></span>
<span id="cb428-16"><a href="ggplot2によるグラフ作成.html#cb428-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(), <span class="co"># パネルの軸や目盛り線を表示しない</span></span>
<span id="cb428-17"><a href="ggplot2によるグラフ作成.html#cb428-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb428-18"><a href="ggplot2によるグラフ作成.html#cb428-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text  =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb428-19"><a href="ggplot2によるグラフ作成.html#cb428-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb428-20"><a href="ggplot2によるグラフ作成.html#cb428-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">reverse =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-187-1.png" width="672" /></p>
</div>
</div>
<div id="折れ線グラフ" class="section level2 hasAnchor" number="5.15">
<h2><span class="header-section-number">5.15</span> 折れ線グラフ<a href="ggplot2によるグラフ作成.html#折れ線グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：日付型変数</li>
<li>Y軸：連続型変数</li>
</ul>
<p>折れ線グラフは時系列データを可視化する最も基本的なグラフで、<code>geom_line()</code>関数で作成します。</p>
<p>まず、プロット用のデータを作成します。</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="ggplot2によるグラフ作成.html#cb429-1" aria-hidden="true" tabindex="-1"></a>data_owid_line <span class="ot">&lt;-</span> data_owid <span class="sc">%&gt;%</span></span>
<span id="cb429-2"><a href="ggplot2によるグラフ作成.html#cb429-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(location, date, new_cases_smoothed) <span class="sc">%&gt;%</span> </span>
<span id="cb429-3"><a href="ggplot2によるグラフ作成.html#cb429-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Japan&quot;</span>, <span class="st">&quot;United Kingdom&quot;</span>, <span class="st">&quot;Germany&quot;</span>, <span class="st">&quot;France&quot;</span>, <span class="st">&quot;Italy&quot;</span>),</span>
<span id="cb429-4"><a href="ggplot2によるグラフ作成.html#cb429-4" aria-hidden="true" tabindex="-1"></a>                date <span class="sc">&gt;=</span> <span class="st">&quot;2022-01-01&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb429-5"><a href="ggplot2によるグラフ作成.html#cb429-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>(<span class="fu">everything</span>())</span>
<span id="cb429-6"><a href="ggplot2によるグラフ作成.html#cb429-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-7"><a href="ggplot2によるグラフ作成.html#cb429-7" aria-hidden="true" tabindex="-1"></a>data_owid_line</span></code></pre></div>
<pre><code>## # A tibble: 873 x 3
##    location date       new_cases_smoothed
##    &lt;chr&gt;    &lt;date&gt;                  &lt;dbl&gt;
##  1 France   2022-01-01            157705.
##  2 France   2022-01-02            162095.
##  3 France   2022-01-03            167381.
##  4 France   2022-01-04            180515.
##  5 France   2022-01-05            198252.
##  6 France   2022-01-06            206286.
##  7 France   2022-01-07            220003.
##  8 France   2022-01-08            232080.
##  9 France   2022-01-09            266032.
## 10 France   2022-01-10            269809.
## # ... with 863 more rows</code></pre>
<div id="折れ線グラフの基本形" class="section level3 unnumbered hasAnchor">
<h3>折れ線グラフの基本形<a href="ggplot2によるグラフ作成.html#折れ線グラフの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="ggplot2によるグラフ作成.html#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> economics,</span>
<span id="cb431-2"><a href="ggplot2によるグラフ作成.html#cb431-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> unemploy)) <span class="sc">+</span></span>
<span id="cb431-3"><a href="ggplot2によるグラフ作成.html#cb431-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 線の透明度</span></span>
<span id="cb431-4"><a href="ggplot2によるグラフ作成.html#cb431-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb431-5"><a href="ggplot2によるグラフ作成.html#cb431-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb431-6"><a href="ggplot2によるグラフ作成.html#cb431-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.0</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-189-1.png" width="672" /></p>
</div>
<div id="折れ線グラフにマーカーを追加" class="section level3 unnumbered hasAnchor">
<h3>折れ線グラフにマーカーを追加<a href="ggplot2によるグラフ作成.html#折れ線グラフにマーカーを追加" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>折れ線グラフを作成する<code>geom_line()</code>関数と、散布図を作成する<code>geom_point()</code>関数を併用します。</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="ggplot2によるグラフ作成.html#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> economics,</span>
<span id="cb432-2"><a href="ggplot2によるグラフ作成.html#cb432-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> unemploy)) <span class="sc">+</span></span>
<span id="cb432-3"><a href="ggplot2によるグラフ作成.html#cb432-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 線の透明度</span></span>
<span id="cb432-4"><a href="ggplot2によるグラフ作成.html#cb432-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb432-5"><a href="ggplot2によるグラフ作成.html#cb432-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb432-6"><a href="ggplot2によるグラフ作成.html#cb432-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.0</span>) <span class="sc">+</span> <span class="co"># 線の太さ</span></span>
<span id="cb432-7"><a href="ggplot2によるグラフ作成.html#cb432-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 塗りつぶしの透明度</span></span>
<span id="cb432-8"><a href="ggplot2によるグラフ作成.html#cb432-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb432-9"><a href="ggplot2によるグラフ作成.html#cb432-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb432-10"><a href="ggplot2によるグラフ作成.html#cb432-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">21</span>, <span class="co"># マーカーの種類</span></span>
<span id="cb432-11"><a href="ggplot2によるグラフ作成.html#cb432-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.0</span>, <span class="co"># マーカーの大きさ</span></span>
<span id="cb432-12"><a href="ggplot2によるグラフ作成.html#cb432-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">stroke =</span> <span class="fl">0.5</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-190-1.png" width="672" /></p>
</div>
<div id="折れ線グラフに系列ラベルを追加" class="section level3 unnumbered hasAnchor">
<h3>折れ線グラフに系列ラベルを追加<a href="ggplot2によるグラフ作成.html#折れ線グラフに系列ラベルを追加" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>折れ線グラフの数が多く凡例が分かりにくい場合などに、折れ線グラフの右側に系列名のラベルを追加します。ラベルを追加するには、<code>ggrepel</code>パッケージの<code>geom_text_repel</code>関数を使用します。</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="ggplot2によるグラフ作成.html#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_owid_line,</span>
<span id="cb433-2"><a href="ggplot2によるグラフ作成.html#cb433-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> new_cases_smoothed, <span class="at">color =</span> location)) <span class="sc">+</span></span>
<span id="cb433-3"><a href="ggplot2によるグラフ作成.html#cb433-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 線の透明度</span></span>
<span id="cb433-4"><a href="ggplot2によるグラフ作成.html#cb433-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb433-5"><a href="ggplot2によるグラフ作成.html#cb433-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.0</span>) <span class="sc">+</span> <span class="co"># 線の太さ</span></span>
<span id="cb433-6"><a href="ggplot2によるグラフ作成.html#cb433-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> data_owid_line <span class="sc">%&gt;%</span></span>
<span id="cb433-7"><a href="ggplot2によるグラフ作成.html#cb433-7" aria-hidden="true" tabindex="-1"></a>                    dplyr<span class="sc">::</span><span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span> </span>
<span id="cb433-8"><a href="ggplot2によるグラフ作成.html#cb433-8" aria-hidden="true" tabindex="-1"></a>                    dplyr<span class="sc">::</span><span class="fu">filter</span>(date <span class="sc">==</span> <span class="fu">max</span>(date)),</span>
<span id="cb433-9"><a href="ggplot2によるグラフ作成.html#cb433-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> new_cases_smoothed, <span class="at">label =</span> location),</span>
<span id="cb433-10"><a href="ggplot2によるグラフ作成.html#cb433-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">seed =</span> <span class="cn">NA</span>, <span class="co"># テキストの配置を決定するランダムシード</span></span>
<span id="cb433-11"><a href="ggplot2によるグラフ作成.html#cb433-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="st">&quot;y&quot;</span>, <span class="co"># テキストの整列方向 (both / x / y)</span></span>
<span id="cb433-12"><a href="ggplot2によるグラフ作成.html#cb433-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">hjust =</span> <span class="fl">0.0</span>, <span class="co"># 横方向の整列位置 (0-1) </span></span>
<span id="cb433-13"><a href="ggplot2によるグラフ作成.html#cb433-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="co"># 縦方向の整列位置 (0-1)</span></span>
<span id="cb433-14"><a href="ggplot2によるグラフ作成.html#cb433-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nudge_x =</span> <span class="dv">5</span>, <span class="co"># マーカーからの横方向のスペース (NULL, 0-)</span></span>
<span id="cb433-15"><a href="ggplot2によるグラフ作成.html#cb433-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nudge_y =</span> <span class="cn">NULL</span>, <span class="co"># マーカーからの縦方向のスペース (NULL, 0-)</span></span>
<span id="cb433-16"><a href="ggplot2によるグラフ作成.html#cb433-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">box.padding =</span> <span class="fl">0.1</span>, <span class="co"># テキスト周囲のスペース (0-)</span></span>
<span id="cb433-17"><a href="ggplot2によるグラフ作成.html#cb433-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">point.padding =</span> <span class="fl">0.1</span>, <span class="co"># マーカー周囲のスペース (0-)</span></span>
<span id="cb433-18"><a href="ggplot2によるグラフ作成.html#cb433-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.alpha =</span> <span class="fl">1.0</span>, <span class="co"># 引き出し線の透明度</span></span>
<span id="cb433-19"><a href="ggplot2によるグラフ作成.html#cb433-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.color =</span> <span class="st">&quot;grey&quot;</span>, <span class="co"># 引き出し線の色</span></span>
<span id="cb433-20"><a href="ggplot2によるグラフ作成.html#cb433-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.size =</span> <span class="fl">0.5</span>, <span class="co"># 引き出し線の太さ</span></span>
<span id="cb433-21"><a href="ggplot2によるグラフ作成.html#cb433-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">min.segment.length =</span> <span class="cn">Inf</span>, <span class="co"># 引き出し線の最低長</span></span>
<span id="cb433-22"><a href="ggplot2によるグラフ作成.html#cb433-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="st">&quot;YUGO&quot;</span>, <span class="co"># テキストのフォント</span></span>
<span id="cb433-23"><a href="ggplot2によるグラフ作成.html#cb433-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fontface =</span> <span class="st">&quot;plain&quot;</span>, <span class="co"># テキストの書体 (plain / bold / italic / bold.italic)</span></span>
<span id="cb433-24"><a href="ggplot2によるグラフ作成.html#cb433-24" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">3.0</span>) <span class="sc">+</span> <span class="co"># テキストのサイズ</span></span>
<span id="cb433-25"><a href="ggplot2によるグラフ作成.html#cb433-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">&quot;1 month&quot;</span>,　<span class="co"># 日付目盛の周期</span></span>
<span id="cb433-26"><a href="ggplot2によるグラフ作成.html#cb433-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_labels =</span> <span class="st">&quot;%y/%b&quot;</span>, <span class="co"># %Y：4桁年、%y：2桁年、%m：2桁月、%b：1桁月、%d：日</span></span>
<span id="cb433-27"><a href="ggplot2によるグラフ作成.html#cb433-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2022/01/01&quot;</span>), <span class="cn">NA</span>), <span class="co"># 始期・終期（指定しない場合はNA）</span></span>
<span id="cb433-28"><a href="ggplot2によるグラフ作成.html#cb433-28" aria-hidden="true" tabindex="-1"></a>               <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.2</span>), <span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span> <span class="co"># 始期・終期からの余白（multは余白率、addは余白幅）</span></span>
<span id="cb433-29"><a href="ggplot2によるグラフ作成.html#cb433-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-191-1.png" width="672" /></p>
</div>
</div>
<div id="ステップグラフ" class="section level2 hasAnchor" number="5.16">
<h2><span class="header-section-number">5.16</span> ステップグラフ<a href="ggplot2によるグラフ作成.html#ステップグラフ" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：日付型変数</li>
<li>Y軸：連続型変数</li>
</ul>
<p>ステップグラフは折れ線グラフの特殊形です。政策金利のように、段階的に値が変化するデータに適しています。ステップグラフは<code>geom_step()</code>関数で作成します。</p>
<p>まず、サンプルデータを作成します。ここでは、Our World in Dataの<code>data_owid</code>データセットに含まれるStringency Indexのステップグラフを作成します。Stringency Indexは、各国当局が実施する新型コロナウイルス感染対策の厳格度を示す指数であり、段階的に値が変化します。</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="ggplot2によるグラフ作成.html#cb434-1" aria-hidden="true" tabindex="-1"></a>data_owid_step <span class="ot">&lt;-</span> data_owid <span class="sc">%&gt;%</span> </span>
<span id="cb434-2"><a href="ggplot2によるグラフ作成.html#cb434-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(location, date, stringency_index) <span class="sc">%&gt;%</span> </span>
<span id="cb434-3"><a href="ggplot2によるグラフ作成.html#cb434-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Japan&quot;</span>, <span class="st">&quot;United Kingdom&quot;</span>, <span class="st">&quot;Germany&quot;</span>, <span class="st">&quot;France&quot;</span>, <span class="st">&quot;Italy&quot;</span>))</span>
<span id="cb434-4"><a href="ggplot2によるグラフ作成.html#cb434-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb434-5"><a href="ggplot2によるグラフ作成.html#cb434-5" aria-hidden="true" tabindex="-1"></a>data_owid_step</span></code></pre></div>
<pre><code>## # A tibble: 4,405 x 3
##    location date       stringency_index
##    &lt;chr&gt;    &lt;date&gt;                &lt;dbl&gt;
##  1 France   2020-01-24             5.56
##  2 France   2020-01-25             5.56
##  3 France   2020-01-26             5.56
##  4 France   2020-01-27             5.56
##  5 France   2020-01-28             5.56
##  6 France   2020-01-29             5.56
##  7 France   2020-01-30             5.56
##  8 France   2020-01-31             5.56
##  9 France   2020-02-01             5.56
## 10 France   2020-02-02             5.56
## # ... with 4,395 more rows</code></pre>
<div id="ステップグラフの基本形" class="section level3 unnumbered hasAnchor">
<h3>ステップグラフの基本形<a href="ggplot2によるグラフ作成.html#ステップグラフの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="ggplot2によるグラフ作成.html#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_owid_step,</span>
<span id="cb436-2"><a href="ggplot2によるグラフ作成.html#cb436-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> stringency_index, <span class="at">color =</span> location)) <span class="sc">+</span></span>
<span id="cb436-3"><a href="ggplot2によるグラフ作成.html#cb436-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 線の透明度</span></span>
<span id="cb436-4"><a href="ggplot2によるグラフ作成.html#cb436-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb436-5"><a href="ggplot2によるグラフ作成.html#cb436-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.0</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-193-1.png" width="672" /></p>
</div>
</div>
<div id="面グラフ" class="section level2 hasAnchor" number="5.17">
<h2><span class="header-section-number">5.17</span> 面グラフ<a href="ggplot2によるグラフ作成.html#面グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：日付型変数</li>
<li>Y軸：連続型変数</li>
</ul>
<p>面グラフは折れ線グラフの特殊形です。面グラフには2種類あり、折れ線グラフとX軸で挟まれた範囲を塗りつぶすグラフは<code>geom_area()</code>関数、2つの折れ線グラフで挟まれた範囲を塗りつぶすグラフは<code>geom_ribbon()</code>関数で作成します。後者は特にリボングラフと呼ばれ、信頼区間の可視化に用いることができます。</p>
<p>まず、プロット用のデータを作成します。</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="ggplot2によるグラフ作成.html#cb437-1" aria-hidden="true" tabindex="-1"></a>data_owid_line <span class="ot">&lt;-</span> data_owid <span class="sc">%&gt;%</span></span>
<span id="cb437-2"><a href="ggplot2によるグラフ作成.html#cb437-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(location, date, new_cases_smoothed) <span class="sc">%&gt;%</span> </span>
<span id="cb437-3"><a href="ggplot2によるグラフ作成.html#cb437-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(location <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Japan&quot;</span>, <span class="st">&quot;United Kingdom&quot;</span>, <span class="st">&quot;Germany&quot;</span>, <span class="st">&quot;France&quot;</span>, <span class="st">&quot;Italy&quot;</span>),</span>
<span id="cb437-4"><a href="ggplot2によるグラフ作成.html#cb437-4" aria-hidden="true" tabindex="-1"></a>                date <span class="sc">&gt;=</span> <span class="st">&quot;2022-01-01&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb437-5"><a href="ggplot2によるグラフ作成.html#cb437-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">drop_na</span>(<span class="fu">everything</span>())</span>
<span id="cb437-6"><a href="ggplot2によるグラフ作成.html#cb437-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-7"><a href="ggplot2によるグラフ作成.html#cb437-7" aria-hidden="true" tabindex="-1"></a>data_owid_line</span></code></pre></div>
<pre><code>## # A tibble: 873 x 3
##    location date       new_cases_smoothed
##    &lt;chr&gt;    &lt;date&gt;                  &lt;dbl&gt;
##  1 France   2022-01-01            157705.
##  2 France   2022-01-02            162095.
##  3 France   2022-01-03            167381.
##  4 France   2022-01-04            180515.
##  5 France   2022-01-05            198252.
##  6 France   2022-01-06            206286.
##  7 France   2022-01-07            220003.
##  8 France   2022-01-08            232080.
##  9 France   2022-01-09            266032.
## 10 France   2022-01-10            269809.
## # ... with 863 more rows</code></pre>
<div id="面グラフの基本形" class="section level3 unnumbered hasAnchor">
<h3>面グラフの基本形<a href="ggplot2によるグラフ作成.html#面グラフの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="ggplot2によるグラフ作成.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> economics,</span>
<span id="cb439-2"><a href="ggplot2によるグラフ作成.html#cb439-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> unemploy)) <span class="sc">+</span></span>
<span id="cb439-3"><a href="ggplot2によるグラフ作成.html#cb439-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 線の透明度</span></span>
<span id="cb439-4"><a href="ggplot2によるグラフ作成.html#cb439-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb439-5"><a href="ggplot2によるグラフ作成.html#cb439-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb439-6"><a href="ggplot2によるグラフ作成.html#cb439-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb439-7"><a href="ggplot2によるグラフ作成.html#cb439-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.0</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-195-1.png" width="672" /></p>
</div>
<div id="積み上げ面グラフ" class="section level3 unnumbered hasAnchor">
<h3>積み上げ面グラフ<a href="ggplot2によるグラフ作成.html#積み上げ面グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>複数の面グラフを積み上げ形式で作成するには、<code>position</code>引数に<code>position_stack()</code>関数を指定します。</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="ggplot2によるグラフ作成.html#cb440-1" aria-hidden="true" tabindex="-1"></a>data_owid_line <span class="sc">%&gt;%</span> </span>
<span id="cb440-2"><a href="ggplot2によるグラフ作成.html#cb440-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">location =</span> <span class="fu">factor</span>(location,</span>
<span id="cb440-3"><a href="ggplot2によるグラフ作成.html#cb440-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Japan&quot;</span>, <span class="st">&quot;United Kingdom&quot;</span>, <span class="st">&quot;Germany&quot;</span>, <span class="st">&quot;France&quot;</span>, <span class="st">&quot;Italy&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">rev</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb440-4"><a href="ggplot2によるグラフ作成.html#cb440-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> new_cases_smoothed, <span class="at">fill =</span> location)) <span class="sc">+</span></span>
<span id="cb440-5"><a href="ggplot2によるグラフ作成.html#cb440-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">position =</span> <span class="fu">position_stack</span>(),</span>
<span id="cb440-6"><a href="ggplot2によるグラフ作成.html#cb440-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 線の透明度</span></span>
<span id="cb440-7"><a href="ggplot2によるグラフ作成.html#cb440-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb440-8"><a href="ggplot2によるグラフ作成.html#cb440-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.0</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-196-1.png" width="672" /></p>
</div>
<div id="リボングラフの基本形" class="section level3 unnumbered hasAnchor">
<h3>リボングラフの基本形<a href="ggplot2によるグラフ作成.html#リボングラフの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>リボングラフでは、<code>aes()</code>関数の中で塗りつぶし範囲の下端を<code>ymin</code>引数、上端を<code>ymax</code>引数に指定します。</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="ggplot2によるグラフ作成.html#cb441-1" aria-hidden="true" tabindex="-1"></a>data_owid_line <span class="sc">%&gt;%</span> </span>
<span id="cb441-2"><a href="ggplot2によるグラフ作成.html#cb441-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span> </span>
<span id="cb441-3"><a href="ggplot2によるグラフ作成.html#cb441-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">new_cases_max =</span> <span class="fu">max</span>(new_cases_smoothed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb441-4"><a href="ggplot2によるグラフ作成.html#cb441-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">new_cases_min =</span> <span class="fu">min</span>(new_cases_smoothed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb441-5"><a href="ggplot2によるグラフ作成.html#cb441-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">ymin =</span> new_cases_min, <span class="at">ymax =</span> new_cases_max)) <span class="sc">+</span></span>
<span id="cb441-6"><a href="ggplot2によるグラフ作成.html#cb441-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 線の透明度</span></span>
<span id="cb441-7"><a href="ggplot2によるグラフ作成.html#cb441-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb441-8"><a href="ggplot2によるグラフ作成.html#cb441-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb441-9"><a href="ggplot2によるグラフ作成.html#cb441-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb441-10"><a href="ggplot2によるグラフ作成.html#cb441-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.5</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-197-1.png" width="672" /></p>
</div>
<div id="リボングラフに折れ線グラフを追加" class="section level3 unnumbered hasAnchor">
<h3>リボングラフに折れ線グラフを追加<a href="ggplot2によるグラフ作成.html#リボングラフに折れ線グラフを追加" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>リボングラフに折れ線グラフを追加する際は、まず<code>geom_ribbon()</code>関数でリボングラフを作成し、そのあとに<code>+</code>演算子で<code>geom_line()</code>関数をつなげて折れ線グラフを追加します。</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="ggplot2によるグラフ作成.html#cb442-1" aria-hidden="true" tabindex="-1"></a>data_owid_line <span class="sc">%&gt;%</span> </span>
<span id="cb442-2"><a href="ggplot2によるグラフ作成.html#cb442-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span> </span>
<span id="cb442-3"><a href="ggplot2によるグラフ作成.html#cb442-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">new_cases_max =</span> <span class="fu">max</span>(new_cases_smoothed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb442-4"><a href="ggplot2によるグラフ作成.html#cb442-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">new_cases_median =</span> <span class="fu">median</span>(new_cases_smoothed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb442-5"><a href="ggplot2によるグラフ作成.html#cb442-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">new_cases_min =</span> <span class="fu">min</span>(new_cases_smoothed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb442-6"><a href="ggplot2によるグラフ作成.html#cb442-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">ymin =</span> new_cases_min, <span class="at">ymax =</span> new_cases_max, <span class="at">y =</span> new_cases_median)) <span class="sc">+</span></span>
<span id="cb442-7"><a href="ggplot2によるグラフ作成.html#cb442-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 線の透明度</span></span>
<span id="cb442-8"><a href="ggplot2によるグラフ作成.html#cb442-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb442-9"><a href="ggplot2によるグラフ作成.html#cb442-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 塗りつぶしの色</span></span>
<span id="cb442-10"><a href="ggplot2によるグラフ作成.html#cb442-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb442-11"><a href="ggplot2によるグラフ作成.html#cb442-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 線の太さ</span></span>
<span id="cb442-12"><a href="ggplot2によるグラフ作成.html#cb442-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># 線の透明度</span></span>
<span id="cb442-13"><a href="ggplot2によるグラフ作成.html#cb442-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="co"># 線の色</span></span>
<span id="cb442-14"><a href="ggplot2によるグラフ作成.html#cb442-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="co"># 線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb442-15"><a href="ggplot2によるグラフ作成.html#cb442-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">1.0</span>) <span class="co"># 線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-198-1.png" width="672" /></p>
</div>
</div>
<div id="箱ひげ図ヴァイオリングラフ" class="section level2 hasAnchor" number="5.18">
<h2><span class="header-section-number">5.18</span> 箱ひげ図・ヴァイオリングラフ<a href="ggplot2によるグラフ作成.html#箱ひげ図ヴァイオリングラフ" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：離散型変数</li>
<li>Y軸：連続型変数</li>
</ul>
<p>データの分布範囲を可視化するには箱ひげ図やヴァイオリングラフを用います。箱ひげ図は<code>geom_boxplot()</code>関数、ヴァイオリングラフは<code>geom_violin()</code>関数で作成します。</p>
<p>また、<code>geom_jitter()</code>関数で作成するジッターグラフを併用し、箱ひげ図やヴァイオリングラフに個別データの位置をプロットすると、データの分布がより具体的に分かりやすくなります。</p>
<div id="箱ひげ図の基本形" class="section level3 unnumbered hasAnchor">
<h3>箱ひげ図の基本形<a href="ggplot2によるグラフ作成.html#箱ひげ図の基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>箱ひげ図は一般的に、ひげの下端が最小値、箱の下端が第1四分位数、箱内部の横線が中央値、箱の上端が第3四分位数、ひげの上端が最大値を表します。</p>
<p>しかし、<code>ggplot2</code>パッケージの<code>geom_boxplot()</code>で作成すると、ひげの下端・上端は箱の下端・上端から1.5×IQRの範囲内にある最小・最大のサンプルの位置を表すことに注意が必要です。その範囲外にあるサンプルは外れ値として扱われます。なお、IQRは四分位範囲（第3四分位数-第1四分位数）を意味します。</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="ggplot2によるグラフ作成.html#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb443-2"><a href="ggplot2によるグラフ作成.html#cb443-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb443-3"><a href="ggplot2によるグラフ作成.html#cb443-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.alpha =</span> <span class="fl">1.0</span>, <span class="co"># 外れ値マーカーの塗りつぶしの透明度</span></span>
<span id="cb443-4"><a href="ggplot2によるグラフ作成.html#cb443-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 外れ値マーカーの線の色</span></span>
<span id="cb443-5"><a href="ggplot2によるグラフ作成.html#cb443-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 外れ値マーカーの塗りつぶしの色</span></span>
<span id="cb443-6"><a href="ggplot2によるグラフ作成.html#cb443-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.shape =</span> <span class="dv">21</span>, <span class="co"># 外れ値マーカーの種類（外れ値を表示しない場合はNA）</span></span>
<span id="cb443-7"><a href="ggplot2によるグラフ作成.html#cb443-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.size =</span> <span class="fl">2.0</span>, <span class="co"># 外れ値マーカーの大きさ</span></span>
<span id="cb443-8"><a href="ggplot2によるグラフ作成.html#cb443-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.stroke =</span> <span class="fl">0.5</span>, <span class="co"># 外れ値マーカーの線の太さ</span></span>
<span id="cb443-9"><a href="ggplot2によるグラフ作成.html#cb443-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="co"># 箱の塗りつぶしの透明度</span></span>
<span id="cb443-10"><a href="ggplot2によるグラフ作成.html#cb443-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 箱ひげの線の色</span></span>
<span id="cb443-11"><a href="ggplot2によるグラフ作成.html#cb443-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 箱の塗りつぶしの色</span></span>
<span id="cb443-12"><a href="ggplot2によるグラフ作成.html#cb443-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>) <span class="co"># 箱ひげの線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-199-1.png" width="672" /></p>
</div>
<div id="箱ひげ図に個別サンプルを追加" class="section level3 unnumbered hasAnchor">
<h3>箱ひげ図に個別サンプルを追加<a href="ggplot2によるグラフ作成.html#箱ひげ図に個別サンプルを追加" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>箱ひげ図にジッターグラフで個別サンプルを追加する場合は、データの重複表示を避けるため、<code>geom_boxplot()</code>関数の<code>outlier.shape</code>引数に<code>NA</code>を指定して、箱ひげ図による外れ値のマーカーを非表示にします。</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="ggplot2によるグラフ作成.html#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb444-2"><a href="ggplot2によるグラフ作成.html#cb444-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb444-3"><a href="ggplot2によるグラフ作成.html#cb444-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="co"># 外れ値マーカーの種類（外れ値を表示しない場合はNA）</span></span>
<span id="cb444-4"><a href="ggplot2によるグラフ作成.html#cb444-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="co"># 箱の塗りつぶしの透明度</span></span>
<span id="cb444-5"><a href="ggplot2によるグラフ作成.html#cb444-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># 箱ひげの線の色</span></span>
<span id="cb444-6"><a href="ggplot2によるグラフ作成.html#cb444-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># 箱の塗りつぶしの色</span></span>
<span id="cb444-7"><a href="ggplot2によるグラフ作成.html#cb444-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 箱ひげの線の太さ</span></span>
<span id="cb444-8"><a href="ggplot2によるグラフ作成.html#cb444-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.3</span>, <span class="co"># マーカーの縦方向の分布範囲</span></span>
<span id="cb444-9"><a href="ggplot2によるグラフ作成.html#cb444-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.3</span>, <span class="co"># マーカーの横方向の分布範囲</span></span>
<span id="cb444-10"><a href="ggplot2によるグラフ作成.html#cb444-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># マーカーの塗りつぶしの透明度</span></span>
<span id="cb444-11"><a href="ggplot2によるグラフ作成.html#cb444-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># マーカーの線の色</span></span>
<span id="cb444-12"><a href="ggplot2によるグラフ作成.html#cb444-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># マーカーの塗りつぶしの色</span></span>
<span id="cb444-13"><a href="ggplot2によるグラフ作成.html#cb444-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">shape =</span> <span class="dv">21</span>, <span class="co"># マーカーの種類</span></span>
<span id="cb444-14"><a href="ggplot2によるグラフ作成.html#cb444-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.0</span>, <span class="co"># マーカーの大きさ</span></span>
<span id="cb444-15"><a href="ggplot2によるグラフ作成.html#cb444-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">stroke =</span> <span class="fl">0.5</span>) <span class="co"># マーカーの線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-200-1.png" width="672" /></p>
</div>
<div id="ヴァイオリングラフの基本形" class="section level3 unnumbered hasAnchor">
<h3>ヴァイオリングラフの基本形<a href="ggplot2によるグラフ作成.html#ヴァイオリングラフの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="ggplot2によるグラフ作成.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb445-2"><a href="ggplot2によるグラフ作成.html#cb445-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb445-3"><a href="ggplot2によるグラフ作成.html#cb445-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">scale =</span> <span class="st">&quot;area&quot;</span>, <span class="co"># ヴァイオリンの大きさ（area：すべての面積が同じ、count：サンプル個数に比例、width：すべての幅が同じ）</span></span>
<span id="cb445-4"><a href="ggplot2によるグラフ作成.html#cb445-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="co"># ヴァイオリンの塗りつぶしの透明度</span></span>
<span id="cb445-5"><a href="ggplot2によるグラフ作成.html#cb445-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># ヴァイオリンの線の色</span></span>
<span id="cb445-6"><a href="ggplot2によるグラフ作成.html#cb445-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># ヴァイオリンの塗りつぶしの色</span></span>
<span id="cb445-7"><a href="ggplot2によるグラフ作成.html#cb445-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># ヴァイオリンの線の種類</span></span>
<span id="cb445-8"><a href="ggplot2によるグラフ作成.html#cb445-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.5</span>) <span class="co"># ヴァイオリンの線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-201-1.png" width="672" /></p>
</div>
<div id="ヴァイオリングラフに個別サンプルを追加" class="section level3 unnumbered hasAnchor">
<h3>ヴァイオリングラフに個別サンプルを追加<a href="ggplot2によるグラフ作成.html#ヴァイオリングラフに個別サンプルを追加" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="ggplot2によるグラフ作成.html#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb446-2"><a href="ggplot2によるグラフ作成.html#cb446-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb446-3"><a href="ggplot2によるグラフ作成.html#cb446-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">scale =</span> <span class="st">&quot;area&quot;</span>, <span class="co"># ヴァイオリンの大きさ（area：すべての面積が同じ、count：サンプル個数に比例、width：すべての幅が同じ）</span></span>
<span id="cb446-4"><a href="ggplot2によるグラフ作成.html#cb446-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="co"># ヴァイオリンの塗りつぶしの透明度</span></span>
<span id="cb446-5"><a href="ggplot2によるグラフ作成.html#cb446-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># ヴァイオリンの線の色</span></span>
<span id="cb446-6"><a href="ggplot2によるグラフ作成.html#cb446-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># ヴァイオリンの塗りつぶしの色</span></span>
<span id="cb446-7"><a href="ggplot2によるグラフ作成.html#cb446-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="co"># ヴァイオリンの線の種類</span></span>
<span id="cb446-8"><a href="ggplot2によるグラフ作成.html#cb446-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># ヴァイオリンの線の太さ</span></span>
<span id="cb446-9"><a href="ggplot2によるグラフ作成.html#cb446-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.4</span>, <span class="co"># マーカーの縦方向の分布範囲</span></span>
<span id="cb446-10"><a href="ggplot2によるグラフ作成.html#cb446-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">width =</span> <span class="fl">0.4</span>, <span class="co"># マーカーの横方向の分布範囲</span></span>
<span id="cb446-11"><a href="ggplot2によるグラフ作成.html#cb446-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># マーカーの塗りつぶしの透明度</span></span>
<span id="cb446-12"><a href="ggplot2によるグラフ作成.html#cb446-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># マーカーの線の色</span></span>
<span id="cb446-13"><a href="ggplot2によるグラフ作成.html#cb446-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># マーカーの塗りつぶしの色</span></span>
<span id="cb446-14"><a href="ggplot2によるグラフ作成.html#cb446-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">shape =</span> <span class="dv">21</span>, <span class="co"># マーカーの種類</span></span>
<span id="cb446-15"><a href="ggplot2によるグラフ作成.html#cb446-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.0</span>, <span class="co"># マーカーの大きさ</span></span>
<span id="cb446-16"><a href="ggplot2によるグラフ作成.html#cb446-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">stroke =</span> <span class="fl">0.5</span>) <span class="co"># マーカーの線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-202-1.png" width="672" /></p>
</div>
</div>
<div id="ドットプロット" class="section level2 hasAnchor" number="5.19">
<h2><span class="header-section-number">5.19</span> ドットプロット<a href="ggplot2によるグラフ作成.html#ドットプロット" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>X軸：離散型変数</li>
<li>Y軸：離散型変数</li>
</ul>
<p>ドットプロットは<code>geom_dotplot()</code>関数で作成します。実務では、FOMCで示される参加者の政策金利予想を可視化する際に使用されます。</p>
<div id="ドットプロットの基本形" class="section level3 unnumbered hasAnchor">
<h3>ドットプロットの基本形<a href="ggplot2によるグラフ作成.html#ドットプロットの基本形" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="ggplot2によるグラフ作成.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb447-2"><a href="ggplot2によるグラフ作成.html#cb447-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> class, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb447-3"><a href="ggplot2によるグラフ作成.html#cb447-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binaxis =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb447-4"><a href="ggplot2によるグラフ作成.html#cb447-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">binwidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb447-5"><a href="ggplot2によるグラフ作成.html#cb447-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">stackdir =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb447-6"><a href="ggplot2によるグラフ作成.html#cb447-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">1.0</span>, <span class="co"># マーカーの塗りつぶしの透明度</span></span>
<span id="cb447-7"><a href="ggplot2によるグラフ作成.html#cb447-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="co"># マーカーの線の色</span></span>
<span id="cb447-8"><a href="ggplot2によるグラフ作成.html#cb447-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="co"># マーカーの塗りつぶしの色</span></span>
<span id="cb447-9"><a href="ggplot2によるグラフ作成.html#cb447-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">stroke =</span> <span class="fl">0.5</span>) <span class="co"># マーカーの線の太さ</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-203-1.png" width="672" /></p>
</div>
</div>
<div id="色の設定" class="section level2 hasAnchor" number="5.20">
<h2><span class="header-section-number">5.20</span> 色の設定<a href="ggplot2によるグラフ作成.html#色の設定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>変数の値や属性に応じて色を自動で変化させるには、<code>geom</code>関数ファミリーでグラフを作成したあとに、<code>+</code>演算子で<code>scale_color</code>関数ファミリー（線の色）や<code>scale_fill</code>関数ファミリー（塗りつぶしの色）をつなぎます。色の変化に対応する変数が離散型か連続型かによって、どの<code>scale_color/fill</code>関数を用いるかが変わります。</p>
<p>まず、プロット用のデータを作成します。</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="ggplot2によるグラフ作成.html#cb448-1" aria-hidden="true" tabindex="-1"></a>data_mpg_color <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span> </span>
<span id="cb448-2"><a href="ggplot2によるグラフ作成.html#cb448-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(class) <span class="sc">%&gt;%</span> </span>
<span id="cb448-3"><a href="ggplot2によるグラフ作成.html#cb448-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(cty, hwy), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb448-4"><a href="ggplot2によるグラフ作成.html#cb448-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb448-5"><a href="ggplot2によるグラフ作成.html#cb448-5" aria-hidden="true" tabindex="-1"></a>data_mpg_color</span></code></pre></div>
<pre><code>## # A tibble: 7 x 3
##   class        cty   hwy
##   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
## 1 2seater     15.4  24.8
## 2 compact     20.1  28.3
## 3 midsize     18.8  27.3
## 4 minivan     15.8  22.4
## 5 pickup      13    16.9
## 6 subcompact  20.4  28.1
## 7 suv         13.5  18.1</code></pre>
<div id="色の手動指定離散型変数" class="section level3 unnumbered hasAnchor">
<h3>色の手動指定（離散型変数）<a href="ggplot2によるグラフ作成.html#色の手動指定離散型変数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>自分で色の割り当てを決める方法です。Rで使用できる色の種類については、<a href="http://www.okadajp.org/RWiki/?%E8%89%B2%E8%A6%8B%E6%9C%AC">こちら</a>を参照してください。</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="ggplot2によるグラフ作成.html#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb450-2"><a href="ggplot2によるグラフ作成.html#cb450-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fl, <span class="at">color =</span> fl, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb450-3"><a href="ggplot2によるグラフ作成.html#cb450-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb450-4"><a href="ggplot2によるグラフ作成.html#cb450-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Red&quot;</span>, <span class="st">&quot;Salmon&quot;</span>, <span class="st">&quot;Gold&quot;</span>, <span class="st">&quot;Forestgreen&quot;</span>, <span class="st">&quot;Darkblue&quot;</span>)) <span class="sc">+</span> <span class="co"># colorで指定した変数の離散値と同数の色を指定</span></span>
<span id="cb450-5"><a href="ggplot2によるグラフ作成.html#cb450-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Red&quot;</span>, <span class="st">&quot;Salmon&quot;</span>, <span class="st">&quot;Gold&quot;</span>, <span class="st">&quot;Forestgreen&quot;</span>, <span class="st">&quot;Darkblue&quot;</span>)) <span class="co"># fillで指定した変数の離散値と同数の色を指定</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-205-1.png" width="672" /></p>
</div>
<div id="brewerカラーパレット離散型変数" class="section level3 unnumbered hasAnchor">
<h3>Brewerカラーパレット（離散型変数）<a href="ggplot2によるグラフ作成.html#brewerカラーパレット離散型変数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>RColorBrewer</code>パッケージでは、様々な種類の美麗なプリセットカラーパレットが利用できます。</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="ggplot2によるグラフ作成.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># カラーパレットの確認</span></span>
<span id="cb451-2"><a href="ggplot2によるグラフ作成.html#cb451-2" aria-hidden="true" tabindex="-1"></a>RColorBrewer<span class="sc">::</span><span class="fu">display.brewer.all</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-206-1.png" width="672" /></p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="ggplot2によるグラフ作成.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb452-2"><a href="ggplot2によるグラフ作成.html#cb452-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fl, <span class="at">color =</span> fl, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb452-3"><a href="ggplot2によるグラフ作成.html#cb452-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb452-4"><a href="ggplot2によるグラフ作成.html#cb452-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Paired&quot;</span>, <span class="co"># カラーパレット名</span></span>
<span id="cb452-5"><a href="ggplot2によるグラフ作成.html#cb452-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># 色の順序（-1で逆順）</span></span>
<span id="cb452-6"><a href="ggplot2によるグラフ作成.html#cb452-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Paired&quot;</span>, <span class="co"># カラーパレット名</span></span>
<span id="cb452-7"><a href="ggplot2によるグラフ作成.html#cb452-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">direction =</span> <span class="dv">1</span>) <span class="co"># 色の順序（-1で逆順）</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-207-1.png" width="672" /></p>
</div>
<div id="viridisカラーパレット離散型変数" class="section level3 unnumbered hasAnchor">
<h3>Viridisカラーパレット（離散型変数）<a href="ggplot2によるグラフ作成.html#viridisカラーパレット離散型変数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>色覚障害に対応したカラーパレットです。パレットの種類などの詳細は<a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">こちら</a>を参照してください。</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="ggplot2によるグラフ作成.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb453-2"><a href="ggplot2によるグラフ作成.html#cb453-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fl, <span class="at">color =</span> fl, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb453-3"><a href="ggplot2によるグラフ作成.html#cb453-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb453-4"><a href="ggplot2によるグラフ作成.html#cb453-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;viridis&quot;</span>, <span class="co"># パレットの種類（magma / inferno / plasma / viridis / cividis）</span></span>
<span id="cb453-5"><a href="ggplot2によるグラフ作成.html#cb453-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># 色の順序（-1で逆順）</span></span>
<span id="cb453-6"><a href="ggplot2によるグラフ作成.html#cb453-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;viridis&quot;</span>, <span class="co"># パレットの種類（magma / inferno / plasma / viridis / cividis）</span></span>
<span id="cb453-7"><a href="ggplot2によるグラフ作成.html#cb453-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="dv">1</span>) <span class="co"># 色の順序（-1で逆順）</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-208-1.png" width="672" /></p>
</div>
<div id="ggsciカラーパレット離散型変数" class="section level3 unnumbered hasAnchor">
<h3>ggsciカラーパレット（離散型変数）<a href="ggplot2によるグラフ作成.html#ggsciカラーパレット離散型変数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>様々な科学ジャーナルで使用されるカラーパレットです。パレットの種類などの詳細は<a href="https://cran.r-project.org/web/packages/ggsci/vignettes/ggsci.html">こちら</a>をご覧ください。</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="ggplot2によるグラフ作成.html#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb454-2"><a href="ggplot2によるグラフ作成.html#cb454-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> fl, <span class="at">color =</span> fl, <span class="at">fill =</span> fl)) <span class="sc">+</span></span>
<span id="cb454-3"><a href="ggplot2によるグラフ作成.html#cb454-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb454-4"><a href="ggplot2によるグラフ作成.html#cb454-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_npg</span>() <span class="sc">+</span> </span>
<span id="cb454-5"><a href="ggplot2によるグラフ作成.html#cb454-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_npg</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-209-1.png" width="672" /></p>
</div>
<div id="distillerカラーパレット連続型変数" class="section level3 unnumbered hasAnchor">
<h3>distillerカラーパレット（連続型変数）<a href="ggplot2によるグラフ作成.html#distillerカラーパレット連続型変数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>こちらは、<code>RColorBrewer</code>パッケージの連続型変数用の関数です。様々な種類の美麗なプリセットカラーパレットが利用できます。</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="ggplot2によるグラフ作成.html#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="co"># カラーパレットの確認</span></span>
<span id="cb455-2"><a href="ggplot2によるグラフ作成.html#cb455-2" aria-hidden="true" tabindex="-1"></a>RColorBrewer<span class="sc">::</span><span class="fu">display.brewer.all</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-210-1.png" width="672" /></p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="ggplot2によるグラフ作成.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb456-2"><a href="ggplot2によるグラフ作成.html#cb456-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb456-3"><a href="ggplot2によるグラフ作成.html#cb456-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>() <span class="sc">+</span></span>
<span id="cb456-4"><a href="ggplot2によるグラフ作成.html#cb456-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">&quot;Blues&quot;</span>, <span class="co"># カラーパレット名</span></span>
<span id="cb456-5"><a href="ggplot2によるグラフ作成.html#cb456-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="dv">1</span>) <span class="co"># 色の順序（-1で逆順）</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
</div>
<div id="viridisカラーパレット連続型変数" class="section level3 unnumbered hasAnchor">
<h3>Viridisカラーパレット（連続型変数）<a href="ggplot2によるグラフ作成.html#viridisカラーパレット連続型変数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>色覚障害に対応したカラーパレットです。パレットの種類などの詳細は<a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">こちら</a>を参照してください。</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="ggplot2によるグラフ作成.html#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb457-2"><a href="ggplot2によるグラフ作成.html#cb457-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb457-3"><a href="ggplot2によるグラフ作成.html#cb457-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>() <span class="sc">+</span></span>
<span id="cb457-4"><a href="ggplot2によるグラフ作成.html#cb457-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;viridis&quot;</span>, <span class="co"># パレットの種類（magma / inferno / plasma / viridis / cividis）</span></span>
<span id="cb457-5"><a href="ggplot2によるグラフ作成.html#cb457-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="dv">1</span>) <span class="co"># 色の順序（-1で逆順）</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-212-1.png" width="672" /></p>
</div>
<div id="gradientカラーパレット連続型変数" class="section level3 unnumbered hasAnchor">
<h3>gradientカラーパレット（連続型変数）<a href="ggplot2によるグラフ作成.html#gradientカラーパレット連続型変数" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>自分で色を指定してグラデーションを作成するカラーパレットです。2色グラデーション、3色グラデーション、n色グラデーションの3種類の関数があります。n色グラデーションでは、事前にベースとなるカラーパレットを<code>RColorBrewer::display.brewer.all()</code>関数などで確認して使用します。</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="ggplot2によるグラフ作成.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2色グラデーション</span></span>
<span id="cb458-2"><a href="ggplot2によるグラフ作成.html#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb458-3"><a href="ggplot2によるグラフ作成.html#cb458-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb458-4"><a href="ggplot2によるグラフ作成.html#cb458-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>() <span class="sc">+</span></span>
<span id="cb458-5"><a href="ggplot2によるグラフ作成.html#cb458-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;Red&quot;</span>, <span class="co"># 最小値の色</span></span>
<span id="cb458-6"><a href="ggplot2によるグラフ作成.html#cb458-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">high =</span> <span class="st">&quot;Forestgreen&quot;</span>) <span class="co"># 最大値の色</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-213-1.png" width="672" /></p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="ggplot2によるグラフ作成.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3色グラデーション</span></span>
<span id="cb459-2"><a href="ggplot2によるグラフ作成.html#cb459-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb459-3"><a href="ggplot2によるグラフ作成.html#cb459-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb459-4"><a href="ggplot2によるグラフ作成.html#cb459-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>() <span class="sc">+</span></span>
<span id="cb459-5"><a href="ggplot2によるグラフ作成.html#cb459-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">&quot;Red&quot;</span>, <span class="co"># 最小値の色</span></span>
<span id="cb459-6"><a href="ggplot2によるグラフ作成.html#cb459-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">mid =</span> <span class="st">&quot;Gold&quot;</span>, <span class="co"># 中間値の色</span></span>
<span id="cb459-7"><a href="ggplot2によるグラフ作成.html#cb459-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">high =</span> <span class="st">&quot;Forestgreen&quot;</span>, <span class="co"># 最大値の色</span></span>
<span id="cb459-8"><a href="ggplot2によるグラフ作成.html#cb459-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">30</span>) <span class="co"># 中間値</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-214-1.png" width="672" /></p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="ggplot2によるグラフ作成.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="co"># パレットを指定したn色グラデーション</span></span>
<span id="cb460-2"><a href="ggplot2によるグラフ作成.html#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb460-3"><a href="ggplot2によるグラフ作成.html#cb460-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> hwy, <span class="at">fill =</span> ..x..)) <span class="sc">+</span></span>
<span id="cb460-4"><a href="ggplot2によるグラフ作成.html#cb460-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>() <span class="sc">+</span></span>
<span id="cb460-5"><a href="ggplot2によるグラフ作成.html#cb460-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> <span class="fu">brewer.pal</span>(<span class="at">name =</span> <span class="st">&quot;RdYlGn&quot;</span>,</span>
<span id="cb460-6"><a href="ggplot2によるグラフ作成.html#cb460-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">n =</span> <span class="dv">9</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-215-1.png" width="672" /></p>
</div>
</div>
<div id="軸の設定" class="section level2 hasAnchor" number="5.21">
<h2><span class="header-section-number">5.21</span> 軸の設定<a href="ggplot2によるグラフ作成.html#軸の設定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>X軸、Y軸の設定を行うには、<code>scale_x/y</code>関数ファミリーを使用します。X軸、Y軸に指定する変数の型によって、使用する関数が異なります。</p>
<p>まず、プロット用のデータを作成します。</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="ggplot2によるグラフ作成.html#cb461-1" aria-hidden="true" tabindex="-1"></a>data_owid_scale <span class="ot">&lt;-</span> data_owid <span class="sc">%&gt;%</span> </span>
<span id="cb461-2"><a href="ggplot2によるグラフ作成.html#cb461-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span> </span>
<span id="cb461-3"><a href="ggplot2によるグラフ作成.html#cb461-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(new_cases, new_deaths), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb461-4"><a href="ggplot2によるグラフ作成.html#cb461-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb461-5"><a href="ggplot2によるグラフ作成.html#cb461-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_owid_scale)</span></code></pre></div>
<pre><code>##    location           new_cases          new_deaths      
##  Length:244         Min.   :     0.0   Min.   :   0.007  
##  Class :character   1st Qu.:    40.8   1st Qu.:   0.436  
##  Mode  :character   Median :   309.1   Median :   4.178  
##                     Mean   : 11493.8   Mean   : 135.163  
##                     3rd Qu.:  2024.3   3rd Qu.:  23.676  
##                     Max.   :611975.5   Max.   :7095.236  
##                     NA&#39;s   :15         NA&#39;s   :21</code></pre>
<div id="x軸連続型y軸連続型" class="section level3 unnumbered hasAnchor">
<h3>X軸：連続型、Y軸：連続型<a href="ggplot2によるグラフ作成.html#x軸連続型y軸連続型" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="ggplot2によるグラフ作成.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_owid_scale,</span>
<span id="cb463-2"><a href="ggplot2によるグラフ作成.html#cb463-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> new_cases, <span class="at">y =</span> new_deaths)) <span class="sc">+</span></span>
<span id="cb463-3"><a href="ggplot2によるグラフ作成.html#cb463-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb463-4"><a href="ggplot2によるグラフ作成.html#cb463-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb463-5"><a href="ggplot2によるグラフ作成.html#cb463-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> breaks_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">1e+06</span>, <span class="dv">100000</span>), <span class="co"># 目盛</span></span>
<span id="cb463-6"><a href="ggplot2によるグラフ作成.html#cb463-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> breaks_x, <span class="co"># 目盛ラベル</span></span>
<span id="cb463-7"><a href="ggplot2によるグラフ作成.html#cb463-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">7e+05</span>), <span class="co"># 下限・上限値（指定しない場合はNA）</span></span>
<span id="cb463-8"><a href="ggplot2によるグラフ作成.html#cb463-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>), <span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span> <span class="co"># 下限・上限値からの余白（multは余白率、addは余白幅）</span></span>
<span id="cb463-9"><a href="ggplot2によるグラフ作成.html#cb463-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> breaks_y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10000</span>, <span class="dv">1000</span>), <span class="co"># 目盛</span></span>
<span id="cb463-10"><a href="ggplot2によるグラフ作成.html#cb463-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> breaks_y, <span class="co"># 目盛ラベル</span></span>
<span id="cb463-11"><a href="ggplot2によるグラフ作成.html#cb463-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8000</span>), <span class="co"># 下限・上限値（指定しない場合はNA）</span></span>
<span id="cb463-12"><a href="ggplot2によるグラフ作成.html#cb463-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>), <span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span> <span class="co"># 下限・上限値からの余白（multは余白率、addは余白幅）</span></span>
<span id="cb463-13"><a href="ggplot2によるグラフ作成.html#cb463-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;新規感染者数（1日当たり平均、人）&quot;</span>, <span class="co"># X軸のタイトル</span></span>
<span id="cb463-14"><a href="ggplot2によるグラフ作成.html#cb463-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;新規死亡者数（1日当たり平均、人）&quot;</span>) <span class="sc">+</span> <span class="co"># Y軸のタイトル</span></span>
<span id="cb463-15"><a href="ggplot2によるグラフ作成.html#cb463-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), <span class="co"># 軸タイトルの文字サイズ</span></span>
<span id="cb463-16"><a href="ggplot2によるグラフ作成.html#cb463-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="co"># X軸ラベルの角度</span></span>
<span id="cb463-17"><a href="ggplot2によるグラフ作成.html#cb463-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># X軸ラベルの横整列位置（0-1）</span></span>
<span id="cb463-18"><a href="ggplot2によるグラフ作成.html#cb463-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="co"># X軸ラベルの縦整列位置（0-1）</span></span>
<span id="cb463-19"><a href="ggplot2によるグラフ作成.html#cb463-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="co"># Y軸ラベルの角度</span></span>
<span id="cb463-20"><a href="ggplot2によるグラフ作成.html#cb463-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># Y軸ラベルの横整列位置（0-1）</span></span>
<span id="cb463-21"><a href="ggplot2によるグラフ作成.html#cb463-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="co"># Y軸ラベルの縦整列位置（0-1）</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-217-1.png" width="672" /></p>
</div>
<div id="対数目盛" class="section level3 unnumbered hasAnchor">
<h3>対数目盛<a href="ggplot2によるグラフ作成.html#対数目盛" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="ggplot2によるグラフ作成.html#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_owid_scale,</span>
<span id="cb465-2"><a href="ggplot2によるグラフ作成.html#cb465-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> new_cases, <span class="at">y =</span> new_deaths)) <span class="sc">+</span></span>
<span id="cb465-3"><a href="ggplot2によるグラフ作成.html#cb465-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb465-4"><a href="ggplot2によるグラフ作成.html#cb465-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb465-5"><a href="ggplot2によるグラフ作成.html#cb465-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> breaks_x <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">**</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">1</span>), <span class="co"># 目盛</span></span>
<span id="cb465-6"><a href="ggplot2によるグラフ作成.html#cb465-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(breaks_x[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="st">&quot;1万&quot;</span>, <span class="st">&quot;10万&quot;</span>, <span class="st">&quot;100万&quot;</span>), <span class="co"># 目盛ラベル</span></span>
<span id="cb465-7"><a href="ggplot2によるグラフ作成.html#cb465-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">7e+05</span>), <span class="co"># 下限・上限値（指定しない場合はNA）</span></span>
<span id="cb465-8"><a href="ggplot2によるグラフ作成.html#cb465-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>), <span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span> <span class="co"># 下限・上限値からの余白（multは余白率、addは余白幅）</span></span>
<span id="cb465-9"><a href="ggplot2によるグラフ作成.html#cb465-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">breaks =</span> breaks_y <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="sc">**</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">1</span>), <span class="co"># 目盛</span></span>
<span id="cb465-10"><a href="ggplot2によるグラフ作成.html#cb465-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(breaks_y[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="st">&quot;1万&quot;</span>), <span class="co"># 目盛ラベル</span></span>
<span id="cb465-11"><a href="ggplot2によるグラフ作成.html#cb465-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8000</span>), <span class="co"># 下限・上限値（指定しない場合はNA）</span></span>
<span id="cb465-12"><a href="ggplot2によるグラフ作成.html#cb465-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>), <span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span> <span class="co"># 下限・上限値からの余白（multは余白率、addは余白幅）</span></span>
<span id="cb465-13"><a href="ggplot2によるグラフ作成.html#cb465-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;新規感染者数（1日当たり平均、人）&quot;</span>, <span class="co"># X軸のタイトル</span></span>
<span id="cb465-14"><a href="ggplot2によるグラフ作成.html#cb465-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;新規死亡者数（1日当たり平均、人）&quot;</span>) <span class="sc">+</span> <span class="co"># Y軸のタイトル</span></span>
<span id="cb465-15"><a href="ggplot2によるグラフ作成.html#cb465-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), <span class="co"># 軸タイトルの文字サイズ</span></span>
<span id="cb465-16"><a href="ggplot2によるグラフ作成.html#cb465-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="co"># X軸ラベルの角度</span></span>
<span id="cb465-17"><a href="ggplot2によるグラフ作成.html#cb465-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># X軸ラベルの横整列位置（0-1）</span></span>
<span id="cb465-18"><a href="ggplot2によるグラフ作成.html#cb465-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="co"># X軸ラベルの縦整列位置（0-1）</span></span>
<span id="cb465-19"><a href="ggplot2によるグラフ作成.html#cb465-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="co"># Y軸ラベルの角度</span></span>
<span id="cb465-20"><a href="ggplot2によるグラフ作成.html#cb465-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># Y軸ラベルの横整列位置（0-1）</span></span>
<span id="cb465-21"><a href="ggplot2によるグラフ作成.html#cb465-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="co"># Y軸ラベルの縦整列位置（0-1）</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-218-1.png" width="672" /></p>
</div>
<div id="x軸日付型y軸連続型" class="section level3 unnumbered hasAnchor">
<h3>X軸：日付型、Y軸：連続型<a href="ggplot2によるグラフ作成.html#x軸日付型y軸連続型" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="ggplot2によるグラフ作成.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="co"># date_breaks引数を使用する場合</span></span>
<span id="cb467-2"><a href="ggplot2によるグラフ作成.html#cb467-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> economics,</span>
<span id="cb467-3"><a href="ggplot2によるグラフ作成.html#cb467-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> unemploy)) <span class="sc">+</span> </span>
<span id="cb467-4"><a href="ggplot2によるグラフ作成.html#cb467-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb467-5"><a href="ggplot2によるグラフ作成.html#cb467-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">&quot;3 month&quot;</span>,　<span class="co"># 日付目盛の周期</span></span>
<span id="cb467-6"><a href="ggplot2によるグラフ作成.html#cb467-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_labels =</span> <span class="st">&quot;%y/%b&quot;</span>, <span class="co"># 日付フォーマット（%Y：4桁年、%y：2桁年、%m：2桁月、%b：1桁月、%d：日）</span></span>
<span id="cb467-7"><a href="ggplot2によるグラフ作成.html#cb467-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2000/01/01&quot;</span>), <span class="fu">as.Date</span>(<span class="st">&quot;2002/12/31&quot;</span>)), <span class="co"># 始期・終期（指定しない場合はNA）</span></span>
<span id="cb467-8"><a href="ggplot2によるグラフ作成.html#cb467-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.00</span>), <span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span> <span class="co"># 始期・終期からの余白（multは余白率、addは余白幅）</span></span>
<span id="cb467-9"><a href="ggplot2によるグラフ作成.html#cb467-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> breaks_y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50000</span>, <span class="dv">1000</span>), <span class="co"># 目盛</span></span>
<span id="cb467-10"><a href="ggplot2によるグラフ作成.html#cb467-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> breaks_y, <span class="co"># 目盛ラベル</span></span>
<span id="cb467-11"><a href="ggplot2によるグラフ作成.html#cb467-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">10000</span>), <span class="co"># 下限・上限値（指定しない場合はNA）</span></span>
<span id="cb467-12"><a href="ggplot2によるグラフ作成.html#cb467-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>), <span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span> <span class="co"># 下限・上限値からの余白（multは余白率、addは余白幅）</span></span>
<span id="cb467-13"><a href="ggplot2によるグラフ作成.html#cb467-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;日付（年/月）&quot;</span>, <span class="co"># X軸のタイトル</span></span>
<span id="cb467-14"><a href="ggplot2によるグラフ作成.html#cb467-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;失業者数（千人）&quot;</span>) <span class="sc">+</span> <span class="co"># Y軸のタイトル</span></span>
<span id="cb467-15"><a href="ggplot2によるグラフ作成.html#cb467-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), <span class="co"># 軸タイトルの文字サイズ</span></span>
<span id="cb467-16"><a href="ggplot2によるグラフ作成.html#cb467-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="co"># X軸ラベルの角度</span></span>
<span id="cb467-17"><a href="ggplot2によるグラフ作成.html#cb467-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># X軸ラベルの横整列位置（0-1）</span></span>
<span id="cb467-18"><a href="ggplot2によるグラフ作成.html#cb467-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="co"># X軸ラベルの縦整列位置（0-1）</span></span>
<span id="cb467-19"><a href="ggplot2によるグラフ作成.html#cb467-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="co"># Y軸ラベルの角度</span></span>
<span id="cb467-20"><a href="ggplot2によるグラフ作成.html#cb467-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># Y軸ラベルの横整列位置（0-1）</span></span>
<span id="cb467-21"><a href="ggplot2によるグラフ作成.html#cb467-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="co"># Y軸ラベルの縦整列位置（0-1）</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-219-1.png" width="672" /></p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="ggplot2によるグラフ作成.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># date_breaks引数を使用しない場合（結果は同じ）</span></span>
<span id="cb468-2"><a href="ggplot2によるグラフ作成.html#cb468-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> economics,</span>
<span id="cb468-3"><a href="ggplot2によるグラフ作成.html#cb468-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> unemploy)) <span class="sc">+</span> </span>
<span id="cb468-4"><a href="ggplot2によるグラフ作成.html#cb468-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb468-5"><a href="ggplot2によるグラフ作成.html#cb468-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">breaks =</span> breaks_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">&quot;1967-01-01&quot;</span>), <span class="fu">max</span>(economics<span class="sc">$</span>date), <span class="at">by =</span> <span class="st">&quot;3 months&quot;</span>), <span class="co"># 日付目盛ベクトル</span></span>
<span id="cb468-6"><a href="ggplot2によるグラフ作成.html#cb468-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">date_labels =</span> <span class="fu">str_c</span>(<span class="fu">str_sub</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(breaks_x), <span class="dv">3</span>, <span class="dv">4</span>), <span class="st">&quot;/&quot;</span>, lubridate<span class="sc">::</span><span class="fu">month</span>(breaks_x)), <span class="co"># 日付目盛ベクトルをラベル用に加工</span></span>
<span id="cb468-7"><a href="ggplot2によるグラフ作成.html#cb468-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">limits =</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2000/01/01&quot;</span>), <span class="fu">as.Date</span>(<span class="st">&quot;2002/12/31&quot;</span>)), <span class="co"># 始期・終期（指定しない場合はNA）</span></span>
<span id="cb468-8"><a href="ggplot2によるグラフ作成.html#cb468-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.00</span>), <span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span> <span class="co"># 始期・終期からの余白（multは余白率、addは余白幅）</span></span>
<span id="cb468-9"><a href="ggplot2によるグラフ作成.html#cb468-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> breaks_y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50000</span>, <span class="dv">1000</span>), <span class="co"># 目盛</span></span>
<span id="cb468-10"><a href="ggplot2によるグラフ作成.html#cb468-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> breaks_y, <span class="co"># 目盛ラベル</span></span>
<span id="cb468-11"><a href="ggplot2によるグラフ作成.html#cb468-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">10000</span>), <span class="co"># 下限・上限値（指定しない場合はNA）</span></span>
<span id="cb468-12"><a href="ggplot2によるグラフ作成.html#cb468-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>), <span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span> <span class="co"># 下限・上限値からの余白（multは余白率、addは余白幅）</span></span>
<span id="cb468-13"><a href="ggplot2によるグラフ作成.html#cb468-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;日付（年/月）&quot;</span>, <span class="co"># X軸のタイトル</span></span>
<span id="cb468-14"><a href="ggplot2によるグラフ作成.html#cb468-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;失業者数（千人）&quot;</span>) <span class="sc">+</span> <span class="co"># Y軸のタイトル</span></span>
<span id="cb468-15"><a href="ggplot2によるグラフ作成.html#cb468-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>), <span class="co"># 軸タイトルの文字サイズ</span></span>
<span id="cb468-16"><a href="ggplot2によるグラフ作成.html#cb468-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="co"># X軸ラベルの角度</span></span>
<span id="cb468-17"><a href="ggplot2によるグラフ作成.html#cb468-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># X軸ラベルの横整列位置（0-1）</span></span>
<span id="cb468-18"><a href="ggplot2によるグラフ作成.html#cb468-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="co"># X軸ラベルの縦整列位置（0-1）</span></span>
<span id="cb468-19"><a href="ggplot2によるグラフ作成.html#cb468-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="co"># Y軸ラベルの角度</span></span>
<span id="cb468-20"><a href="ggplot2によるグラフ作成.html#cb468-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># Y軸ラベルの横整列位置（0-1）</span></span>
<span id="cb468-21"><a href="ggplot2によるグラフ作成.html#cb468-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="co"># Y軸ラベルの縦整列位置（0-1）</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-220-1.png" width="672" /></p>
</div>
</div>
<div id="複合グラフファセット" class="section level2 hasAnchor" number="5.22">
<h2><span class="header-section-number">5.22</span> 複合グラフ（ファセット）<a href="ggplot2によるグラフ作成.html#複合グラフファセット" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>複数のグラフをまとめたファセットを作成するには、<code>facet</code>関数ファミリーを使用します。どのようなファセットにするかで使用する関数が異なります。</p>
<div id="行方向の複合グラフ" class="section level3 unnumbered hasAnchor">
<h3>行方向の複合グラフ<a href="ggplot2によるグラフ作成.html#行方向の複合グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>行方向に複合グラフを並べる場合は、<code>facet_rep_grid()</code>関数の<code>rows</code>引数に<code>vars(離散型変数)</code>の形でグラフを分けて作成したい変数名を指定します。</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="ggplot2によるグラフ作成.html#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb469-2"><a href="ggplot2によるグラフ作成.html#cb469-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb469-3"><a href="ggplot2によるグラフ作成.html#cb469-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb469-4"><a href="ggplot2によるグラフ作成.html#cb469-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_rep_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(class), <span class="co"># 変数class別にグラフを作成</span></span>
<span id="cb469-5"><a href="ggplot2によるグラフ作成.html#cb469-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scales =</span> <span class="st">&quot;fixed&quot;</span>, <span class="co"># 目盛設定（fixed：全グラフ共通、free：全グラフ独立、free_x：X軸のみ独立、free_y：Y軸のみ独立）</span></span>
<span id="cb469-6"><a href="ggplot2によるグラフ作成.html#cb469-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repeat.tick.labels =</span> <span class="cn">FALSE</span>) <span class="co"># 目盛表示（TRUE：すべてのグラフに表示、FALSE：端のグラフのみ表示</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-221-1.png" width="672" /></p>
</div>
<div id="列方向の複合グラフ" class="section level3 unnumbered hasAnchor">
<h3>列方向の複合グラフ<a href="ggplot2によるグラフ作成.html#列方向の複合グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>列方向に複合グラフを並べる場合は、<code>facet_rep_grid()</code>関数の<code>cols</code>引数に<code>vars(離散型変数)</code>の形でグラフを分けて作成したい変数名を指定します。</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="ggplot2によるグラフ作成.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb470-2"><a href="ggplot2によるグラフ作成.html#cb470-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb470-3"><a href="ggplot2によるグラフ作成.html#cb470-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb470-4"><a href="ggplot2によるグラフ作成.html#cb470-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_rep_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(class), <span class="co"># 変数class別にグラフを作成</span></span>
<span id="cb470-5"><a href="ggplot2によるグラフ作成.html#cb470-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scales =</span> <span class="st">&quot;fixed&quot;</span>, <span class="co"># 目盛設定（fixed：全グラフ共通、free：全グラフ独立、free_x：X軸のみ独立、free_y：Y軸のみ独立）</span></span>
<span id="cb470-6"><a href="ggplot2によるグラフ作成.html#cb470-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repeat.tick.labels =</span> <span class="cn">FALSE</span>) <span class="co"># 目盛表示（TRUE：すべてのグラフに表示、FALSE：端のグラフのみ表示</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-222-1.png" width="672" /></p>
</div>
<div id="行列方向の複合グラフ" class="section level3 unnumbered hasAnchor">
<h3>行・列方向の複合グラフ<a href="ggplot2によるグラフ作成.html#行列方向の複合グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>行・列方向に複合グラフを並べる場合は、<code>facet_rep_grid()</code>関数の<code>rows</code>引数と<code>cols</code>引数にそれぞれ<code>vars(離散型変数)</code>の形でグラフを分けて作成したい変数名を指定します。</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="ggplot2によるグラフ作成.html#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb471-2"><a href="ggplot2によるグラフ作成.html#cb471-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb471-3"><a href="ggplot2によるグラフ作成.html#cb471-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb471-4"><a href="ggplot2によるグラフ作成.html#cb471-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_rep_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(year), <span class="co"># 変数year別に行方向のグラフを作成</span></span>
<span id="cb471-5"><a href="ggplot2によるグラフ作成.html#cb471-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cols =</span> <span class="fu">vars</span>(class), <span class="co"># 変数class別に列方向のグラフを作成</span></span>
<span id="cb471-6"><a href="ggplot2によるグラフ作成.html#cb471-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scales =</span> <span class="st">&quot;fixed&quot;</span>, <span class="co"># 目盛設定（fixed：全グラフ共通、free：全グラフ独立、free_x：X軸のみ独立、free_y：Y軸のみ独立）</span></span>
<span id="cb471-7"><a href="ggplot2によるグラフ作成.html#cb471-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repeat.tick.labels =</span> <span class="cn">TRUE</span>) <span class="co"># 目盛表示（TRUE：すべてのグラフに表示、FALSE：端のグラフのみ表示</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-223-1.png" width="672" /></p>
</div>
<div id="行数列数を指定した複合グラフ" class="section level3 unnumbered hasAnchor">
<h3>行数・列数を指定した複合グラフ<a href="ggplot2によるグラフ作成.html#行数列数を指定した複合グラフ" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>行数と列数を指定してグラフを順番に並べるには、<code>facet_rep_wrap()</code>関数の<code>facets</code>引数に「<code>~ 離散型変数」</code>の形でグラフを分けて作成したい変数名を指定し、<code>nrow</code>引数と<code>ncol</code>引数に行数・列数を指定します。</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="ggplot2によるグラフ作成.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb472-2"><a href="ggplot2によるグラフ作成.html#cb472-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb472-3"><a href="ggplot2によるグラフ作成.html#cb472-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb472-4"><a href="ggplot2によるグラフ作成.html#cb472-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_rep_wrap</span>(<span class="at">facets =</span> <span class="sc">~</span> manufacturer, <span class="co"># 変数manufacturer別にグラフを作成</span></span>
<span id="cb472-5"><a href="ggplot2によるグラフ作成.html#cb472-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">nrow =</span> <span class="dv">3</span>, <span class="co"># 行方向のグラフ数</span></span>
<span id="cb472-6"><a href="ggplot2によるグラフ作成.html#cb472-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ncol =</span> <span class="dv">5</span>, <span class="co"># 列方向のグラフ数</span></span>
<span id="cb472-7"><a href="ggplot2によるグラフ作成.html#cb472-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">scales =</span> <span class="st">&quot;fixed&quot;</span>, <span class="co"># 目盛設定（fixed：全グラフ共通、free：全グラフ独立、free_x：X軸のみ独立、free_y：Y軸のみ独立）</span></span>
<span id="cb472-8"><a href="ggplot2によるグラフ作成.html#cb472-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">repeat.tick.labels =</span> <span class="cn">TRUE</span>) <span class="co"># 目盛表示（TRUE：すべてのグラフに表示、FALSE：端のグラフのみ表示</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-224-1.png" width="672" /></p>
</div>
<div id="複合グラフの設定" class="section level3 unnumbered hasAnchor">
<h3>複合グラフの設定<a href="ggplot2によるグラフ作成.html#複合グラフの設定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ファセットの各種設定を行うには、<code>theme()</code>関数内に必要事項を記入します。</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="ggplot2によるグラフ作成.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 行数・列数を指定した複合グラフの例</span></span>
<span id="cb473-2"><a href="ggplot2によるグラフ作成.html#cb473-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb473-3"><a href="ggplot2によるグラフ作成.html#cb473-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb473-4"><a href="ggplot2によるグラフ作成.html#cb473-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb473-5"><a href="ggplot2によるグラフ作成.html#cb473-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_rep_wrap</span>(<span class="at">facets =</span> <span class="sc">~</span> manufacturer) <span class="sc">+</span> <span class="co"># 変数manufacturer別にグラフを作成</span></span>
<span id="cb473-6"><a href="ggplot2によるグラフ作成.html#cb473-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="cn">NA</span>, <span class="co"># ファセットタイトル領域の枠の色</span></span>
<span id="cb473-7"><a href="ggplot2によるグラフ作成.html#cb473-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">fill =</span> <span class="st">&quot;White&quot;</span>), <span class="co"># ファセットタイトル領域の塗りつぶしの色（NAで無色）</span></span>
<span id="cb473-8"><a href="ggplot2によるグラフ作成.html#cb473-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;Black&quot;</span>, <span class="co"># ファセットタイトルの色</span></span>
<span id="cb473-9"><a href="ggplot2によるグラフ作成.html#cb473-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="co"># ファセットタイトルの書体</span></span>
<span id="cb473-10"><a href="ggplot2によるグラフ作成.html#cb473-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">8</span>, <span class="co"># ファセットタイトルのフォントサイズ</span></span>
<span id="cb473-11"><a href="ggplot2によるグラフ作成.html#cb473-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># ファセットタイトルの横方向の整列位置</span></span>
<span id="cb473-12"><a href="ggplot2によるグラフ作成.html#cb473-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="co"># ファセットタイトルの縦方向の整列位置</span></span>
<span id="cb473-13"><a href="ggplot2によるグラフ作成.html#cb473-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="co"># ファセットのグラフ間の横方向のスペース</span></span>
<span id="cb473-14"><a href="ggplot2によるグラフ作成.html#cb473-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>)) <span class="co"># ファセットのグラフ間の縦方向のスペース</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-225-1.png" width="672" /></p>
</div>
</div>
<div id="地図ファセット" class="section level2 hasAnchor" number="5.23">
<h2><span class="header-section-number">5.23</span> 地図ファセット<a href="ggplot2によるグラフ作成.html#地図ファセット" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>国別・州別・都道府県別のデータを、地図を模した複合グラフに表示するには、<code>geofacet</code>パッケージの<code>facet_geo()</code>関数を使用します。</p>
<p>ここでは、日本の県内総生産データを使用します。</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="ggplot2によるグラフ作成.html#cb474-1" aria-hidden="true" tabindex="-1"></a>data_gdp_pref</span></code></pre></div>
<pre><code>## # A tibble: 611 x 5
##    pref_code pref_name  year gdp_nominal gdp_nominal_pchg
##        &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;       &lt;dbl&gt;            &lt;dbl&gt;
##  1         1 北海道     2006    19316568           NA    
##  2         1 北海道     2007    19137599           -0.927
##  3         1 北海道     2008    18457858           -3.55 
##  4         1 北海道     2009    18219113           -1.29 
##  5         1 北海道     2010    18122675           -0.529
##  6         1 北海道     2011    18071493           -0.282
##  7         1 北海道     2012    17923502           -0.819
##  8         1 北海道     2013    18242119            1.78 
##  9         1 北海道     2014    18579766            1.85 
## 10         1 北海道     2015    19128504            2.95 
## # ... with 601 more rows</code></pre>
<p><code>geofacet</code>パッケージでは、都道府県名と地図上の位置を結びつける<code>jp_prefs_grid2</code>データが用意されています。ただし都道府県名が英語表記でしか格納されていないため、日本語表記を名寄せして追加します。</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="ggplot2によるグラフ作成.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="co"># geofacetのjp_prefs_grid2に都道府県名の日本語表記を追加</span></span>
<span id="cb476-2"><a href="ggplot2によるグラフ作成.html#cb476-2" aria-hidden="true" tabindex="-1"></a>data_prefs <span class="ot">&lt;-</span> data_gdp_pref <span class="sc">%&gt;%</span> </span>
<span id="cb476-3"><a href="ggplot2によるグラフ作成.html#cb476-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(pref_code, pref_name) <span class="sc">%&gt;%</span> </span>
<span id="cb476-4"><a href="ggplot2によるグラフ作成.html#cb476-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb476-5"><a href="ggplot2によるグラフ作成.html#cb476-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">code =</span> pref_code)</span>
<span id="cb476-6"><a href="ggplot2によるグラフ作成.html#cb476-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb476-7"><a href="ggplot2によるグラフ作成.html#cb476-7" aria-hidden="true" tabindex="-1"></a>jp_prefs_grid2 <span class="sc">%&lt;&gt;%</span></span>
<span id="cb476-8"><a href="ggplot2によるグラフ作成.html#cb476-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(data_prefs, <span class="at">by =</span> <span class="st">&quot;code&quot;</span>)</span></code></pre></div>
<p>そのうえで、ファセット部分に<code>facet_geo()</code>関数を用いると、都道府県別のデータを日本地図を模した形でグラフ化することができます。</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="ggplot2によるグラフ作成.html#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_gdp_pref,</span>
<span id="cb477-2"><a href="ggplot2によるグラフ作成.html#cb477-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> gdp_nominal_pchg)) <span class="sc">+</span></span>
<span id="cb477-3"><a href="ggplot2によるグラフ作成.html#cb477-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb477-4"><a href="ggplot2によるグラフ作成.html#cb477-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb477-5"><a href="ggplot2によるグラフ作成.html#cb477-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_geo</span>(<span class="at">facets =</span> <span class="sc">~</span> pref_name, <span class="co"># 変数pref_name別にグラフを作成</span></span>
<span id="cb477-6"><a href="ggplot2によるグラフ作成.html#cb477-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">grid =</span> <span class="st">&quot;jp_prefs_grid2&quot;</span>, <span class="co"># 使用する地図グリッド</span></span>
<span id="cb477-7"><a href="ggplot2によるグラフ作成.html#cb477-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">scales =</span> <span class="st">&quot;fixed&quot;</span>) <span class="sc">+</span> <span class="co"># 目盛設定（fixed：全グラフ共通、free：全グラフ独立、free_x：X軸のみ独立、free_y：Y軸のみ独立）</span></span>
<span id="cb477-8"><a href="ggplot2によるグラフ作成.html#cb477-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="cn">NA</span>, <span class="co"># ファセットタイトル領域の枠の色</span></span>
<span id="cb477-9"><a href="ggplot2によるグラフ作成.html#cb477-9" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">fill =</span> <span class="cn">NA</span>), <span class="co"># ファセットタイトル領域の塗りつぶしの色（NAで無色）</span></span>
<span id="cb477-10"><a href="ggplot2によるグラフ作成.html#cb477-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;Black&quot;</span>, <span class="co"># ファセットタイトルの色</span></span>
<span id="cb477-11"><a href="ggplot2によるグラフ作成.html#cb477-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="co"># ファセットタイトルの書体</span></span>
<span id="cb477-12"><a href="ggplot2によるグラフ作成.html#cb477-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">size =</span> <span class="dv">8</span>, <span class="co"># ファセットタイトルのフォントサイズ</span></span>
<span id="cb477-13"><a href="ggplot2によるグラフ作成.html#cb477-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="co"># ファセットタイトルの横方向の整列位置</span></span>
<span id="cb477-14"><a href="ggplot2によるグラフ作成.html#cb477-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="co"># ファセットタイトルの縦方向の整列位置</span></span>
<span id="cb477-15"><a href="ggplot2によるグラフ作成.html#cb477-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="co"># ファセットのグラフ間の横方向のスペース</span></span>
<span id="cb477-16"><a href="ggplot2によるグラフ作成.html#cb477-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.y =</span> <span class="fu">unit</span>(<span class="at">x =</span> <span class="fl">0.5</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>)) <span class="co"># ファセットのグラフ間の縦方向のスペース</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
</div>
<div id="その他設定保存" class="section level2 hasAnchor" number="5.24">
<h2><span class="header-section-number">5.24</span> その他設定・保存<a href="ggplot2によるグラフ作成.html#その他設定保存" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>タイトル、目盛線、凡例、図表全体のフォント、マージンなどの各種設定を行います。</p>
<div id="タイトルキャプション" class="section level3 unnumbered hasAnchor">
<h3>タイトル・キャプション<a href="ggplot2によるグラフ作成.html#タイトルキャプション" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="ggplot2によるグラフ作成.html#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb478-2"><a href="ggplot2によるグラフ作成.html#cb478-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy, <span class="at">fill =</span> class)) <span class="sc">+</span></span>
<span id="cb478-3"><a href="ggplot2によるグラフ作成.html#cb478-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb478-4"><a href="ggplot2によるグラフ作成.html#cb478-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.0</span>) <span class="sc">+</span></span>
<span id="cb478-5"><a href="ggplot2によるグラフ作成.html#cb478-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;車体クラス別の一般道燃費と高速道燃費&quot;</span>, <span class="co"># 図表タイトル</span></span>
<span id="cb478-6"><a href="ggplot2によるグラフ作成.html#cb478-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;（出所）EPA.gov&quot;</span>, <span class="co"># キャプション</span></span>
<span id="cb478-7"><a href="ggplot2によるグラフ作成.html#cb478-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;車体クラス&quot;</span>)　<span class="sc">+</span> <span class="co"># 凡例に使用するscaleのタイトル</span></span>
<span id="cb478-8"><a href="ggplot2によるグラフ作成.html#cb478-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="co"># 図表タイトルの文字サイズ</span></span>
<span id="cb478-9"><a href="ggplot2によるグラフ作成.html#cb478-9" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="co"># 図表タイトルの書体</span></span>
<span id="cb478-10"><a href="ggplot2によるグラフ作成.html#cb478-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># 図表タイトルの横整列位置</span></span>
<span id="cb478-11"><a href="ggplot2によるグラフ作成.html#cb478-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="co"># キャプションの文字サイズ</span></span>
<span id="cb478-12"><a href="ggplot2によるグラフ作成.html#cb478-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face =</span> <span class="st">&quot;plain&quot;</span>, <span class="co"># キャプションの書体</span></span>
<span id="cb478-13"><a href="ggplot2によるグラフ作成.html#cb478-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">hjust =</span> <span class="fl">0.0</span>)) <span class="co"># キャプションの横整列位置</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-229-1.png" width="672" /></p>
</div>
<div id="パネル目盛線" class="section level3 unnumbered hasAnchor">
<h3>パネル目盛線<a href="ggplot2によるグラフ作成.html#パネル目盛線" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="ggplot2によるグラフ作成.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb479-2"><a href="ggplot2によるグラフ作成.html#cb479-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy, <span class="at">fill =</span> class)) <span class="sc">+</span></span>
<span id="cb479-3"><a href="ggplot2によるグラフ作成.html#cb479-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb479-4"><a href="ggplot2によるグラフ作成.html#cb479-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.0</span>) <span class="sc">+</span></span>
<span id="cb479-5"><a href="ggplot2によるグラフ作成.html#cb479-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;grey&quot;</span>, <span class="co"># 主目盛線の色</span></span>
<span id="cb479-6"><a href="ggplot2によるグラフ作成.html#cb479-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="co"># 主目盛線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb479-7"><a href="ggplot2によるグラフ作成.html#cb479-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">size =</span> <span class="fl">0.2</span>), <span class="co"># 主目盛線の太さ</span></span>
<span id="cb479-8"><a href="ggplot2によるグラフ作成.html#cb479-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="co"># 補助目盛り線は表示しない</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
</div>
<div id="凡例" class="section level3 unnumbered hasAnchor">
<h3>凡例<a href="ggplot2によるグラフ作成.html#凡例" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="ggplot2によるグラフ作成.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb480-2"><a href="ggplot2によるグラフ作成.html#cb480-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy, <span class="at">fill =</span> class)) <span class="sc">+</span></span>
<span id="cb480-3"><a href="ggplot2によるグラフ作成.html#cb480-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb480-4"><a href="ggplot2によるグラフ作成.html#cb480-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.0</span>) <span class="sc">+</span></span>
<span id="cb480-5"><a href="ggplot2によるグラフ作成.html#cb480-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="co"># 凡例タイトルの文字サイズ</span></span>
<span id="cb480-6"><a href="ggplot2によるグラフ作成.html#cb480-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="co"># 凡例タイトルの書体</span></span>
<span id="cb480-7"><a href="ggplot2によるグラフ作成.html#cb480-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">hjust =</span> <span class="fl">0.0</span>), <span class="co"># 凡例タイトルの横整列位置</span></span>
<span id="cb480-8"><a href="ggplot2によるグラフ作成.html#cb480-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>), <span class="co"># 凡例ラベルの文字サイズ</span></span>
<span id="cb480-9"><a href="ggplot2によるグラフ作成.html#cb480-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.box.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;grey&quot;</span>, <span class="co"># 凡例の枠線の色</span></span>
<span id="cb480-10"><a href="ggplot2によるグラフ作成.html#cb480-10" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">size =</span> <span class="fl">0.5</span>), <span class="co"># 凡例の枠線の太さ</span></span>
<span id="cb480-11"><a href="ggplot2によるグラフ作成.html#cb480-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="co"># 凡例の上マージン</span></span>
<span id="cb480-12"><a href="ggplot2によるグラフ作成.html#cb480-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">b =</span> <span class="dv">1</span>, <span class="co"># 凡例の下マージン</span></span>
<span id="cb480-13"><a href="ggplot2によるグラフ作成.html#cb480-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">r =</span> <span class="dv">1</span>, <span class="co"># 凡例の右マージン</span></span>
<span id="cb480-14"><a href="ggplot2によるグラフ作成.html#cb480-14" aria-hidden="true" tabindex="-1"></a>                               <span class="at">l =</span> <span class="dv">1</span>, <span class="co"># 凡例の左マージン</span></span>
<span id="cb480-15"><a href="ggplot2によるグラフ作成.html#cb480-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">unit =</span> <span class="st">&quot;mm&quot;</span>), <span class="co"># 凡例マージンの単位</span></span>
<span id="cb480-16"><a href="ggplot2によるグラフ作成.html#cb480-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">0.0</span>), <span class="co"># 凡例の横整列位置・縦整列位置</span></span>
<span id="cb480-17"><a href="ggplot2によるグラフ作成.html#cb480-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.05</span>)) <span class="sc">+</span> <span class="co"># 凡例の横位置・縦位置</span></span>
<span id="cb480-18"><a href="ggplot2によるグラフ作成.html#cb480-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">keywidth =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="co"># 凡例キーの幅</span></span>
<span id="cb480-19"><a href="ggplot2によるグラフ作成.html#cb480-19" aria-hidden="true" tabindex="-1"></a>                             <span class="at">keyheight =</span> <span class="fu">unit</span>(<span class="dv">3</span>, <span class="at">units =</span> <span class="st">&quot;mm&quot;</span>), <span class="co"># 凡例キーの高さ</span></span>
<span id="cb480-20"><a href="ggplot2によるグラフ作成.html#cb480-20" aria-hidden="true" tabindex="-1"></a>                             <span class="at">direction =</span> <span class="st">&quot;vertical&quot;</span>, <span class="co"># 凡例の整列方向（horizontal / vertical）</span></span>
<span id="cb480-21"><a href="ggplot2によるグラフ作成.html#cb480-21" aria-hidden="true" tabindex="-1"></a>                             <span class="at">nrow =</span> <span class="dv">3</span>, <span class="co"># 凡例の行数</span></span>
<span id="cb480-22"><a href="ggplot2によるグラフ作成.html#cb480-22" aria-hidden="true" tabindex="-1"></a>                             <span class="at">ncol =</span> <span class="dv">3</span>, <span class="co"># 凡例の列数</span></span>
<span id="cb480-23"><a href="ggplot2によるグラフ作成.html#cb480-23" aria-hidden="true" tabindex="-1"></a>                             <span class="at">reverse =</span> <span class="cn">FALSE</span>)) <span class="co"># 凡例順序の逆転</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-231-1.png" width="672" /></p>
</div>
<div id="フォントマージン設定" class="section level3 unnumbered hasAnchor">
<h3>フォント・マージン設定<a href="ggplot2によるグラフ作成.html#フォントマージン設定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="ggplot2によるグラフ作成.html#cb481-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg,</span>
<span id="cb481-2"><a href="ggplot2によるグラフ作成.html#cb481-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy, <span class="at">fill =</span> class)) <span class="sc">+</span></span>
<span id="cb481-3"><a href="ggplot2によるグラフ作成.html#cb481-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb481-4"><a href="ggplot2によるグラフ作成.html#cb481-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">2.0</span>) <span class="sc">+</span></span>
<span id="cb481-5"><a href="ggplot2によるグラフ作成.html#cb481-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;YUGO&quot;</span>, <span class="co"># 図表全体のフォント</span></span>
<span id="cb481-6"><a href="ggplot2によるグラフ作成.html#cb481-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">size =</span> <span class="dv">8</span>), <span class="co"># 図表全体の無事サイズ</span></span>
<span id="cb481-7"><a href="ggplot2によるグラフ作成.html#cb481-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="co"># 図表の上マージン</span></span>
<span id="cb481-8"><a href="ggplot2によるグラフ作成.html#cb481-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">b =</span> <span class="dv">1</span>, <span class="co"># 図表の下マージン</span></span>
<span id="cb481-9"><a href="ggplot2によるグラフ作成.html#cb481-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">r =</span> <span class="dv">1</span>, <span class="co"># 図表の右マージン</span></span>
<span id="cb481-10"><a href="ggplot2によるグラフ作成.html#cb481-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">l =</span> <span class="dv">1</span>, <span class="co"># 図表の左マージン</span></span>
<span id="cb481-11"><a href="ggplot2によるグラフ作成.html#cb481-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">unit =</span> <span class="st">&quot;mm&quot;</span>)) <span class="co"># 図表マージンの単位</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-232-1.png" width="672" /></p>
</div>
<div id="保存" class="section level3 unnumbered hasAnchor">
<h3>保存<a href="ggplot2によるグラフ作成.html#保存" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ggplot2</code>パッケージで作成した図表を画像形式で保存するには、<code>ggsave()</code>関数を使用します。</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="ggplot2によるグラフ作成.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">&quot;directory/filename.png&quot;</span>, <span class="co"># 図表のファイル名</span></span>
<span id="cb482-2"><a href="ggplot2によるグラフ作成.html#cb482-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="fl">12.00</span>, <span class="co"># 図表の横サイズ</span></span>
<span id="cb482-3"><a href="ggplot2によるグラフ作成.html#cb482-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="fl">9.00</span>, <span class="co"># 図表の縦サイズ</span></span>
<span id="cb482-4"><a href="ggplot2によるグラフ作成.html#cb482-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="co"># 図表のサイズ単位</span></span>
<span id="cb482-5"><a href="ggplot2によるグラフ作成.html#cb482-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">300</span>) <span class="co"># 図表の解像度</span></span></code></pre></div>
</div>
</div>
<div id="実例" class="section level2 hasAnchor" number="5.25">
<h2><span class="header-section-number">5.25</span> 実例<a href="ggplot2によるグラフ作成.html#実例" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="実例1世界の新型コロナ死亡率の箱ひげ図" class="section level3 unnumbered hasAnchor">
<h3>実例1：世界の新型コロナ死亡率の箱ひげ図<a href="ggplot2によるグラフ作成.html#実例1世界の新型コロナ死亡率の箱ひげ図" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="ggplot2によるグラフ作成.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co"># プロット用のデータの作成</span></span>
<span id="cb483-2"><a href="ggplot2によるグラフ作成.html#cb483-2" aria-hidden="true" tabindex="-1"></a>data_plot <span class="ot">&lt;-</span> data_owid <span class="sc">%&gt;%</span> </span>
<span id="cb483-3"><a href="ggplot2によるグラフ作成.html#cb483-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(location, date, new_cases, new_deaths) <span class="sc">%&gt;%</span> </span>
<span id="cb483-4"><a href="ggplot2によるグラフ作成.html#cb483-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(date <span class="sc">&lt;=</span> <span class="fu">max</span>(date) <span class="sc">-</span> <span class="dv">28</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb483-5"><a href="ggplot2によるグラフ作成.html#cb483-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date)) <span class="sc">%&gt;%</span> </span>
<span id="cb483-6"><a href="ggplot2によるグラフ作成.html#cb483-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(location, year) <span class="sc">%&gt;%</span> </span>
<span id="cb483-7"><a href="ggplot2によるグラフ作成.html#cb483-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(new_cases, new_deaths), mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb483-8"><a href="ggplot2によるグラフ作成.html#cb483-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">mort_rate =</span> <span class="dv">100</span> <span class="sc">*</span> new_deaths <span class="sc">/</span> new_cases,</span>
<span id="cb483-9"><a href="ggplot2によるグラフ作成.html#cb483-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">year =</span> <span class="fu">str_c</span>(year, <span class="st">&quot;年&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="ggplot2によるグラフ作成.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co"># プロット</span></span>
<span id="cb484-2"><a href="ggplot2によるグラフ作成.html#cb484-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_plot,</span>
<span id="cb484-3"><a href="ggplot2によるグラフ作成.html#cb484-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> mort_rate, <span class="at">color =</span> year, <span class="at">fill =</span> year)) <span class="sc">+</span></span>
<span id="cb484-4"><a href="ggplot2によるグラフ作成.html#cb484-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="co"># 水平線の縦軸との交点</span></span>
<span id="cb484-5"><a href="ggplot2によるグラフ作成.html#cb484-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;gray&quot;</span>, <span class="co"># 水平線の色</span></span>
<span id="cb484-6"><a href="ggplot2によるグラフ作成.html#cb484-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="co"># 水平線の太さ</span></span>
<span id="cb484-7"><a href="ggplot2によるグラフ作成.html#cb484-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb484-8"><a href="ggplot2によるグラフ作成.html#cb484-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="fl">1.0</span>, <span class="at">shape =</span> <span class="dv">21</span>) <span class="sc">+</span></span>
<span id="cb484-9"><a href="ggplot2によるグラフ作成.html#cb484-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> breaks_y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="fl">0.5</span>), <span class="co"># 目盛</span></span>
<span id="cb484-10"><a href="ggplot2によるグラフ作成.html#cb484-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> breaks_y <span class="sc">%&gt;%</span> <span class="fu">sprintf</span>(<span class="at">fmt =</span> <span class="st">&quot;%0.1f&quot;</span>), <span class="co"># 目盛ラベル</span></span>
<span id="cb484-11"><a href="ggplot2によるグラフ作成.html#cb484-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="co"># 下限・上限値（指定しない場合はNA）</span></span>
<span id="cb484-12"><a href="ggplot2によるグラフ作成.html#cb484-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>), <span class="at">add =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))) <span class="sc">+</span> <span class="co"># 下限・上限値からの余白（multは余白率、addは余白幅）</span></span>
<span id="cb484-13"><a href="ggplot2によるグラフ作成.html#cb484-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">element_blank</span>(), <span class="co"># X軸のタイトル</span></span>
<span id="cb484-14"><a href="ggplot2によるグラフ作成.html#cb484-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;新型コロナ感染者の致死率（％）&quot;</span>) <span class="sc">+</span> <span class="co"># Y軸のタイトル</span></span>
<span id="cb484-15"><a href="ggplot2によるグラフ作成.html#cb484-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)) <span class="sc">+</span> <span class="co"># 軸タイトルの文字サイズ</span></span>
<span id="cb484-16"><a href="ggplot2によるグラフ作成.html#cb484-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;世界各国の新型コロナ感染者の致死率（年別）&quot;</span>, <span class="co"># 図表タイトル</span></span>
<span id="cb484-17"><a href="ggplot2によるグラフ作成.html#cb484-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;（注）箱の中の横線は中央値を示す。2022年は直近4週間のサンプルを除外。</span><span class="sc">\n</span><span class="st">（出所）Our World in Data、@naohat23&quot;</span>) <span class="sc">+</span> <span class="co"># キャプション</span></span>
<span id="cb484-18"><a href="ggplot2によるグラフ作成.html#cb484-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="co"># 図表タイトルの文字サイズ</span></span>
<span id="cb484-19"><a href="ggplot2によるグラフ作成.html#cb484-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="co"># 図表タイトルの書体</span></span>
<span id="cb484-20"><a href="ggplot2によるグラフ作成.html#cb484-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">hjust =</span> <span class="fl">0.5</span>), <span class="co"># 図表タイトルの横整列位置</span></span>
<span id="cb484-21"><a href="ggplot2によるグラフ作成.html#cb484-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="co"># キャプションの文字サイズ</span></span>
<span id="cb484-22"><a href="ggplot2によるグラフ作成.html#cb484-22" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">face =</span> <span class="st">&quot;plain&quot;</span>, <span class="co"># キャプションの書体</span></span>
<span id="cb484-23"><a href="ggplot2によるグラフ作成.html#cb484-23" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">hjust =</span> <span class="fl">0.0</span>)) <span class="sc">+</span> <span class="co"># キャプションの横整列位置</span></span>
<span id="cb484-24"><a href="ggplot2によるグラフ作成.html#cb484-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">&quot;grey&quot;</span>, <span class="co"># 主目盛線の色</span></span>
<span id="cb484-25"><a href="ggplot2によるグラフ作成.html#cb484-25" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="co"># 主目盛線の種類（solid / dashed / dotted / dotdash / twodash / longdash）</span></span>
<span id="cb484-26"><a href="ggplot2によるグラフ作成.html#cb484-26" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">size =</span> <span class="fl">0.2</span>), <span class="co"># 主目盛線の太さ</span></span>
<span id="cb484-27"><a href="ggplot2によるグラフ作成.html#cb484-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="co"># 補助目盛り線は表示しない</span></span>
<span id="cb484-28"><a href="ggplot2によるグラフ作成.html#cb484-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="co"># 凡例の横位置・縦位置</span></span>
<span id="cb484-29"><a href="ggplot2によるグラフ作成.html#cb484-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;YUGO&quot;</span>, <span class="co"># 図表全体のフォント</span></span>
<span id="cb484-30"><a href="ggplot2によるグラフ作成.html#cb484-30" aria-hidden="true" tabindex="-1"></a>                            <span class="at">size =</span> <span class="dv">8</span>), <span class="co"># 図表全体の無事サイズ</span></span>
<span id="cb484-31"><a href="ggplot2によるグラフ作成.html#cb484-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">1</span>, <span class="co"># 図表の上マージン</span></span>
<span id="cb484-32"><a href="ggplot2によるグラフ作成.html#cb484-32" aria-hidden="true" tabindex="-1"></a>                             <span class="at">b =</span> <span class="dv">1</span>, <span class="co"># 図表の下マージン</span></span>
<span id="cb484-33"><a href="ggplot2によるグラフ作成.html#cb484-33" aria-hidden="true" tabindex="-1"></a>                             <span class="at">r =</span> <span class="dv">1</span>, <span class="co"># 図表の右マージン</span></span>
<span id="cb484-34"><a href="ggplot2によるグラフ作成.html#cb484-34" aria-hidden="true" tabindex="-1"></a>                             <span class="at">l =</span> <span class="dv">1</span>, <span class="co"># 図表の左マージン</span></span>
<span id="cb484-35"><a href="ggplot2によるグラフ作成.html#cb484-35" aria-hidden="true" tabindex="-1"></a>                             <span class="at">unit =</span> <span class="st">&quot;mm&quot;</span>)) <span class="co"># 図表マージンの単位</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="ggplot2によるグラフ作成.html#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 保存</span></span>
<span id="cb485-2"><a href="ggplot2によるグラフ作成.html#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">&quot;directory/filename.png&quot;</span>, <span class="co"># 図表のファイル名</span></span>
<span id="cb485-3"><a href="ggplot2によるグラフ作成.html#cb485-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">width =</span> <span class="fl">12.00</span>, <span class="co"># 図表の横サイズ</span></span>
<span id="cb485-4"><a href="ggplot2によるグラフ作成.html#cb485-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">height =</span> <span class="fl">9.00</span>, <span class="co"># 図表の縦サイズ</span></span>
<span id="cb485-5"><a href="ggplot2によるグラフ作成.html#cb485-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">units =</span> <span class="st">&quot;cm&quot;</span>, <span class="co"># 図表のサイズ単位</span></span>
<span id="cb485-6"><a href="ggplot2によるグラフ作成.html#cb485-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">dpi =</span> <span class="dv">600</span>) <span class="co"># 図表の解像度</span></span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="時系列データ操作.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="探索的データ分析.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlights": true
},
"toolbar": {
"position": "fixed"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
